{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "13 - MITRE ATT&CK™ - Credential Access",
      "description": "Playbooks designed to hunt Credential Dumping Techniques identified in the MITRE ATT&CK Framework",
      "visible": true,
      "image": null,
      "uuid": "13bd7fa6-aadc-4122-85b5-40f335a26d9c",
      "id": 23,
      "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "createDate": 1629214962,
      "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "modifyDate": 1629214962,
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "HUNTS - OS Credential Dumping (T1003)",
          "aliasName": null,
          "tag": "ATT&CK, Credential_Dumping, Credential_Access",
          "description": "Hunts for non-Windows processes accessing the lsass.exe process, which can be indicative of credential dumping",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/13bd7fa6-aadc-4122-85b5-40f335a26d9c",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/848c6864-18ff-47b7-82bd-59926fcfaa4e",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get query results",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Splunk_Query.data.sid}}\"}",
                  "additional_args": "{\"a\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "120",
              "left": "1160",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "92c3bf7f-79a6-4e76-b8f3-4b3a686b3602",
              "id": 449
            },
            {
              "@type": "WorkflowStep",
              "name": "Send data to enrichment playbook",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_query_results.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "hostname": "{{vars.item.host}}",
                  "siemUsed": "{{vars.siem}}",
                  "epochTime": "{{arrow.get(vars.item.UtcTime).timestamp}}",
                  "processID": "{{vars.item.SourceProcessId}}",
                  "splunkEnd": "{{vars.splunkHuntEnd}}",
                  "accessTime": "{{vars.item.UtcTime}}",
                  "processPath": "{{vars.item.SourceImage | replace( \"\\\\\", \"\\\\\\\\\" )}}",
                  "splunkStart": "{{vars.splunkHuntStart}}",
                  "sourceProcess": "{{vars.item.SourceImage | replace( \"\\\\\", \"\\\\\\\\\" )}}",
                  "targetProcess": "{{vars.item.TargetImage | replace( \"\\\\\", \"\\\\\\\\\" )}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/8255c796-e6ac-4b25-b505-8269f122d534"
              },
              "status": null,
              "top": "120",
              "left": "1440",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "40d7a200-18d2-4452-b6df-c6f43bfb9970",
              "id": 450
            },
            {
              "@type": "WorkflowStep",
              "name": "Splunk Query",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=\"sysmon\" EventCode=10  {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} TargetImage=\"C:\\\\Windows\\\\system32\\\\lsass.exe\" SourceImage!=\"C:\\\\Program Files (x86)\\\\McAfee\\\\Endpoint Security\\\\Web Control\\\\mfewc.exe\" SourceImage!=\"C:\\\\Program Files\\\\Endgame\\\\esensor.exe\" SourceImage!=\"C:\\\\Program Files\\\\McAfee\\\\Endpoint Security\\\\Endpoint Security Platform\\\\mfeesp.exe\" SourceImage!=\"C:\\\\Program Files\\\\McAfee\\\\Endpoint Security\\\\Threat Prevention\\\\mfetp.exe\" | dedup UtcTime, SourceProcessGUID| table host SourceImage TargetImage _time action SourceProcessGUID SourceProcessId vendor_product epoch_time process_exec UtcTime",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "120",
              "left": "880",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "9823b99f-b70d-4bd2-aeeb-43be26c4158f",
              "id": 451
            },
            {
              "@type": "WorkflowStep",
              "name": "Select SIEM",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "step_iri": "/api/3/workflow_steps/f795dbdb-5bf2-43f2-b2e3-9b2329ec9cc1",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Elastic\" }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/0fa5a48c-4124-4640-b4a1-bbaa49d43c0c",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Splunk\" }}"
                  }
                ]
              },
              "status": null,
              "top": "168",
              "left": "309",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "5bc19998-b5b0-4b23-bedd-841b8e338635",
              "id": 452
            },
            {
              "@type": "WorkflowStep",
              "name": "Send Elastic data to enrichment playbook",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.LSASS_Access_Query.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "hostname": "{{vars.item._source.computer_name}}",
                  "siemUsed": "{{vars.siem}}",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "processID": "{{ vars.item._source.event_data.SourceProcessId }}",
                  "splunkEnd": "",
                  "accessTime": "{{ vars.item._source.event_data.UtcTime}}",
                  "processPath": "{{ vars.item._source.event_data.SourceImage | replace( \"\\\\\", \"\\\\\\\\\" )}}",
                  "splunkStart": "",
                  "sourceProcess": "{{ vars.item._source.event_data.SourceImage | replace( \"\\\\\", \"\\\\\\\\\" )}}",
                  "targetProcess": "{{ vars.item._source.event_data.TargetImage | replace( \"\\\\\", \"\\\\\\\\\" )}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/8255c796-e6ac-4b25-b505-8269f122d534"
              },
              "status": null,
              "top": "214",
              "left": "1440",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "4ea5cb79-61d2-4a4e-81d0-930e27926806",
              "id": 453
            },
            {
              "@type": "WorkflowStep",
              "name": "LSASS Access Query",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "@timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND event_type:\"sysmon\" AND event_id:\"10\" AND event_data.TargetImage:\"C:\\\\Windows\\\\system32\\\\lsass.exe\"",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "214",
              "left": "880",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "0292d67d-88cc-4c5c-a60a-a5dfe30b693e",
              "id": 454
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Splunk hunt times",
              "description": null,
              "arguments": {
                "siem": "Splunk",
                "splunkHuntEnd": "{% if vars.input.records[0].huntEnd %}latest={{vars.input.records[0].huntEnd}}{% endif %}",
                "splunkHuntStart": "{% if vars.input.records[0].huntStart %}earliest={{vars.input.records[0].huntStart}}{% endif %}"
              },
              "status": null,
              "top": "120",
              "left": "600",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "0fa5a48c-4124-4640-b4a1-bbaa49d43c0c",
              "id": 455
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Elastic hunt times",
              "description": null,
              "arguments": {
                "siem": "Elastic",
                "elasticHuntEnd": "{% if vars.input.records[0].huntEnd %} {{ arrow.get(vars.input.records[0].huntEnd).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }} {% else %} now {% endif %}",
                "elasticHuntStart": "{{ arrow.get(vars.input.records[0].huntStart).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }}"
              },
              "status": null,
              "top": "214",
              "left": "600",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "f795dbdb-5bf2-43f2-b2e3-9b2329ec9cc1",
              "id": 456
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "8d3e323c-a282-46b7-bdae-1dc4db1902b1",
                "title": "T1003 - Hunt for OS Credential Dumping",
                "resources": [
                  "hunt"
                ],
                "inputVariables": [
                  {
                    "name": "siem",
                    "type": "picklists",
                    "label": "SIEM",
                    "title": "Picklist",
                    "usable": true,
                    "_ignore": false,
                    "tooltip": "Choose your SIEM",
                    "dataType": "picklist",
                    "formType": "picklist",
                    "required": true,
                    "_expanded": true,
                    "collection": false,
                    "dataSource": {
                      "model": "picklists",
                      "query": {
                        "sort": [
                          {
                            "field": "orderIndex",
                            "direction": "ASC"
                          }
                        ],
                        "logic": "AND",
                        "filters": [
                          {
                            "field": "listName__name",
                            "value": "SIEMs",
                            "operator": "eq"
                          }
                        ]
                      },
                      "displayConditions": {
                        "876c1483-416b-4d2f-8138-15769ae16d5c": {
                          "conditions": null,
                          "visibility": "visible"
                        },
                        "bcebcab1-3f93-468a-9f3f-91e5c511a0b5": {
                          "conditions": null,
                          "visibility": "visible"
                        }
                      }
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "_nameTouched": true,
                    "defaultValue": {
                      "id": 280,
                      "@id": "/api/3/picklists/876c1483-416b-4d2f-8138-15769ae16d5c",
                      "icon": null,
                      "@type": "Picklist",
                      "color": null,
                      "display": "Elastic",
                      "listName": "/api/3/picklist_names/98830189-afff-40e6-bed1-94012551dc67",
                      "itemValue": "Elastic",
                      "orderIndex": 1
                    },
                    "useModuleField": false,
                    "displayTemplate": "{{ itemValue }}",
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "siem": "{{vars.request.data[\"siem\"]}}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "hunt": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "168",
              "left": "27",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "848c6864-18ff-47b7-82bd-59926fcfaa4e",
              "id": 457
            },
            {
              "@type": "WorkflowStep",
              "name": "Deduplicate Comments",
              "description": null,
              "arguments": {
                "arguments": {
                  "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
              },
              "status": null,
              "top": "180",
              "left": "1734",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "c63f886c-71b6-4095-8af5-5285d3fdb2a2",
              "id": 458
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "LSASS Access Query -> Send Elastic data to enrichment playbook",
              "targetStep": "/api/3/workflow_steps/4ea5cb79-61d2-4a4e-81d0-930e27926806",
              "sourceStep": "/api/3/workflow_steps/0292d67d-88cc-4c5c-a60a-a5dfe30b693e",
              "label": null,
              "isExecuted": false,
              "uuid": "e85256c2-a53b-460a-8a7a-53ad09f0ca2f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Select SIEM -> Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/0fa5a48c-4124-4640-b4a1-bbaa49d43c0c",
              "sourceStep": "/api/3/workflow_steps/5bc19998-b5b0-4b23-bedd-841b8e338635",
              "label": "",
              "isExecuted": false,
              "uuid": "d8067a9e-a767-4f6d-aa7c-81494e754388"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Send data to enrichment playbook -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/c63f886c-71b6-4095-8af5-5285d3fdb2a2",
              "sourceStep": "/api/3/workflow_steps/40d7a200-18d2-4452-b6df-c6f43bfb9970",
              "label": null,
              "isExecuted": false,
              "uuid": "fef821cb-166a-4925-8d93-62cf7f87369f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Splunk Query",
              "targetStep": "/api/3/workflow_steps/9823b99f-b70d-4bd2-aeeb-43be26c4158f",
              "sourceStep": "/api/3/workflow_steps/0fa5a48c-4124-4640-b4a1-bbaa49d43c0c",
              "label": null,
              "isExecuted": false,
              "uuid": "5d0e064b-77d9-4aea-a7c8-784e2f278028"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get query results -> Send data to enrichment playbook",
              "targetStep": "/api/3/workflow_steps/40d7a200-18d2-4452-b6df-c6f43bfb9970",
              "sourceStep": "/api/3/workflow_steps/92c3bf7f-79a6-4e76-b8f3-4b3a686b3602",
              "label": null,
              "isExecuted": false,
              "uuid": "950fb092-fdad-4dd0-ad75-e61b48cf7b4a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Send data to enrichment playbook -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/c63f886c-71b6-4095-8af5-5285d3fdb2a2",
              "sourceStep": "/api/3/workflow_steps/4ea5cb79-61d2-4a4e-81d0-930e27926806",
              "label": null,
              "isExecuted": false,
              "uuid": "97302925-d040-4701-b971-a09393176009"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Select SIEM",
              "targetStep": "/api/3/workflow_steps/5bc19998-b5b0-4b23-bedd-841b8e338635",
              "sourceStep": "/api/3/workflow_steps/848c6864-18ff-47b7-82bd-59926fcfaa4e",
              "label": null,
              "isExecuted": false,
              "uuid": "e29e9999-2a5b-4d9f-b3e3-1d91c75ab895"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> LSASS Access Query",
              "targetStep": "/api/3/workflow_steps/0292d67d-88cc-4c5c-a60a-a5dfe30b693e",
              "sourceStep": "/api/3/workflow_steps/f795dbdb-5bf2-43f2-b2e3-9b2329ec9cc1",
              "label": null,
              "isExecuted": false,
              "uuid": "01fce2ba-9bf1-4048-ac2d-258b2d15448e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Splunk Query -> Get query results",
              "targetStep": "/api/3/workflow_steps/92c3bf7f-79a6-4e76-b8f3-4b3a686b3602",
              "sourceStep": "/api/3/workflow_steps/9823b99f-b70d-4bd2-aeeb-43be26c4158f",
              "label": null,
              "isExecuted": false,
              "uuid": "8a95226d-bc34-466b-90a4-8d40760334f2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Select SIEM -> Copy  of Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/f795dbdb-5bf2-43f2-b2e3-9b2329ec9cc1",
              "sourceStep": "/api/3/workflow_steps/5bc19998-b5b0-4b23-bedd-841b8e338635",
              "label": "",
              "isExecuted": false,
              "uuid": "4ea407bb-5773-4a85-a04f-6eaf380305c0"
            }
          ],
          "priority": null,
          "uuid": "7f4b3f20-02ae-4741-9807-af8d2307b95e",
          "recordTags": [],
          "id": 101,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214962,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215015,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "HUNTS - OS Credential Dumping (T1003) Part2",
          "aliasName": null,
          "tag": "ATT&CK, Credential_Dumping, Credential_Access",
          "description": "Enriches LSASS.exe access information.",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "processPath",
            "processID",
            "hostname",
            "huntIRI",
            "sourceProcess",
            "targetProcess",
            "accessTime",
            "epochTime",
            "siemUsed"
          ],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/13bd7fa6-aadc-4122-85b5-40f335a26d9c",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/840439c5-a4b5-4857-bdc9-28d384cf054c",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Wait 10 seconds for query to complete",
              "description": null,
              "arguments": {
                "delay": {
                  "days": 0,
                  "hours": 0,
                  "weeks": 0,
                  "minutes": 0,
                  "seconds": 10
                }
              },
              "status": null,
              "top": "100",
              "left": "854",
              "stepType": "/api/3/workflow_step_types/6832e556-b9c7-497a-babe-feda3bd27dbf",
              "uuid": "d3bc61dd-ba09-4abb-869c-9d6a90f579c9",
              "id": 459
            },
            {
              "@type": "WorkflowStep",
              "name": "Query Results for Accessor Info",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Query_for_Accessor_Info.data.sid}}\"}",
                  "additional_args": "{\"A\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "100",
              "left": "1140",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "7ba7b260-1b32-4a4d-901d-3cadc6c1db91",
              "id": 460
            },
            {
              "@type": "WorkflowStep",
              "name": "Which SIEM",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "step_iri": "/api/3/workflow_steps/48cf488d-9b9d-4676-b1ec-0787536a0556",
                    "condition": "{{ vars.input.params.siemUsed == \"Splunk\" }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/41bc4338-81da-4415-be0b-667d33749425",
                    "condition": "{{ vars.input.params.siemUsed == \"Elastic\" }}"
                  }
                ]
              },
              "status": null,
              "top": "160",
              "left": "280",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "1a2edafc-ca48-4b8c-aada-c09ef461bd65",
              "id": 461
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Alerts from Splunk",
              "description": null,
              "arguments": {
                "arguments": {
                  "MD5": "{{vars.steps.Query_Results_for_Accessor_Info.data.results[0].MD5}}",
                  "url": "",
                  "source": "{{vars.steps.Query_Results_for_Accessor_Info.data.results[0].EventChannel}}",
                  "comment": "SIEM query identified process {{vars.steps.Query_Results_for_Accessor_Info.data.results[0].process_exec}} attempting to access LSASS on host {{vars.steps.Query_Results_for_Accessor_Info.data.results[0].host}} at {{vars.input.params.accessTime}}.",
                  "huntIRI": "{{vars.input.params.huntIRI}}",
                  "service": "",
                  "filePath": "{{vars.input.params.processPath}}",
                  "hostName": "{{vars.steps.Query_Results_for_Accessor_Info.data.results[0].Computer}}",
                  "sourceIP": "",
                  "userName": "{{vars.steps.Query_Results_for_Accessor_Info.data.results[0].User}}",
                  "alertName": "ATT&CK-Credential Access-LSASS accessed by {{vars.steps.Query_Results_for_Accessor_Info.data.results[0].process_exec}}",
                  "epochTime": "{{vars.input.params.epochTime}}",
                  "eventName": "",
                  "eventTime": "{{vars.input.params.accessTime}}",
                  "processID": "{{vars.input.params.processID}}",
                  "technique": "LSASS Access",
                  "sourceData": "{{vars.steps.Query_Results_for_Accessor_Info.data.results[0]}}",
                  "sourceTool": "{{vars.steps.Query_Results_for_Accessor_Info.data.results[0].EventChannel}}",
                  "commandline": "{{vars.steps.Query_Results_for_Accessor_Info.data.results[0].cmdline}}",
                  "description": "An attempt to access lsass.exe by a non-standard process was observed. LSASS.exe stores Windows login credentials. Access of lsass.exe by non-standard processes may indicate that a process is attempting to dump or access credentials stored by the lsass process.",
                  "processGUID": "{{vars.steps.Query_Results_for_Accessor_Info.data.results[0].ProcessGuid}}",
                  "processName": "{{vars.steps.Query_Results_for_Accessor_Info.data.results[0].process_exec}}",
                  "registryKey": "",
                  "sourceImage": "{{vars.input.params.sourceProcess}}",
                  "targetImage": "{{vars.input.params.targetProcess}}",
                  "computerName": "{{vars.steps.Query_Results_for_Accessor_Info.data.results[0].Computer}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1003",
                  "parentProcess": "",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "100",
              "left": "1413",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "4d8dba5a-faea-46f1-8f6c-98feb54f3e8f",
              "id": 462
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Alerts from Elastic",
              "description": null,
              "arguments": {
                "arguments": {
                  "MD5": "{{ (vars.steps.Elastic_Query_for_Accessor_Info.data.hits.hits[0]._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0])}}",
                  "url": "",
                  "source": "{{vars.steps.Elastic_Query_for_Accessor_Info.data.hits.hits[0]._source.source_name}}",
                  "comment": "SIEM query identified process {{vars.steps.Elastic_Query_for_Accessor_Info.data.hits.hits[0]._source.image_path.split(\"\\\\\")[-1] }} attempting to access LSASS on host {{vars.steps.Elastic_Query_for_Accessor_Info.data.hits.hits[0]._source.beat.hostname}} at {{vars.input.params.accessTime}}.",
                  "huntIRI": "{{vars.input.params.huntIRI}}",
                  "service": "",
                  "filePath": "{{vars.steps.Elastic_Query_for_Accessor_Info.data.hits.hits[0]._source.image_path}}",
                  "hostName": "{{vars.steps.Elastic_Query_for_Accessor_Info.data.hits.hits[0]._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.steps.Elastic_Query_for_Accessor_Info.data.hits.hits[0]._source.username}}",
                  "alertName": "ATT&CK-Credential Access-LSASS accessed by {{vars.steps.Elastic_Query_for_Accessor_Info.data.hits.hits[0]._source.image_path.split(\"\\\\\")[-1] }}",
                  "epochTime": "{{vars.input.params.epochTime}}",
                  "eventName": "",
                  "eventTime": "{{vars.input.params.accessTime}}",
                  "processID": "{{vars.steps.Elastic_Query_for_Accessor_Info.data.hits.hits[0]._source.event_data.ProcessId}}",
                  "technique": "LSASS Access",
                  "sourceData": "{{vars.steps.Elastic_Query_for_Accessor_Info.data.hits.hits[0]}}",
                  "sourceTool": "{{vars.steps.Elastic_Query_for_Accessor_Info.data.hits.hits[0]._source.source_name}}",
                  "commandline": "{{vars.steps.Elastic_Query_for_Accessor_Info.data.hits.hits[0]._source.event_data.CommandLine}}",
                  "description": "An attempt to access lsass.exe by a non-standard process was observed. LSASS.exe stores Windows login credentials. Access of lsass.exe by non-standard processes may indicate that a process is attempting to dump or access credentials stored by the lsass process.",
                  "processGUID": "{{vars.steps.Elastic_Query_for_Accessor_Info.data.hits.hits[0]._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.steps.Elastic_Query_for_Accessor_Info.data.hits.hits[0]._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "{{vars.input.params.sourceProcess}}",
                  "targetImage": "{{vars.input.params.targetProcess}}",
                  "computerName": "{{vars.steps.Elastic_Query_for_Accessor_Info.data.hits.hits[0]._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1003",
                  "parentProcess": "",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "220",
              "left": "1409",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "0030c386-f29c-4519-bfbb-809474b886e3",
              "id": 463
            },
            {
              "@type": "WorkflowStep",
              "name": "Query for Accessor Info",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=sysmon EventCode=1 (Image=\"{{vars.input.params.processPath}}\" AND ProcessId={{vars.input.params.processID}}) OR (ParentImage=\"{{vars.input.params.processPath}}\" AND ParentProcessId={{vars.input.params.processID}})  host=\"{{vars.input.params.hostname}}\" | head 1| table host Image MD5 User  process_exec vendor_product TimeCreated ProcessId cmdline UtcTime EventChannel ProcessGuid Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"A\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "100",
              "left": "574",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "48cf488d-9b9d-4676-b1ec-0787536a0556",
              "id": 464
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": {
                      "huntIRI": "{{ vars.huntIRI }}",
                      "hostname": "{{ vars.hostname }}",
                      "siemUsed": "{{ vars.siemUsed }}",
                      "epochTime": "{{ vars.epochTime }}",
                      "processID": "{{ vars.processID }}",
                      "splunkEnd": "{{ vars.splunkEnd }}",
                      "accessTime": "{{ vars.accessTime }}",
                      "processPath": "{{ vars.processPath }}",
                      "splunkStart": "{{ vars.splunkStart }}",
                      "sourceProcess": "{{ vars.sourceProcess }}",
                      "targetProcess": "{{ vars.targetProcess }}",
                      "elasticHuntEnd": "{{ vars.elasticHuntEnd }}",
                      "elasticHuntStart": "{{ vars.elasticHuntStart }}"
                    }
                  }
                }
              },
              "status": null,
              "top": "160",
              "left": "9",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "840439c5-a4b5-4857-bdc9-28d384cf054c",
              "id": 465
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic Query for Accessor Info",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:\"1\" AND ((image_path:\"{{vars.input.params.processPath}}\" AND event_data.ProcessId:\"{{vars.input.params.processID}}\") OR (parent_image_path:\"{{vars.input.params.processPath}}\" AND event_data.ParentProcessId:\"{{vars.input.params.processID}}\")) AND  computer_name:\"{{vars.input.params.hostname}}\"",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "220",
              "left": "571",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "41bc4338-81da-4415-be0b-667d33749425",
              "id": 466
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Elastic Query for Accessor Info",
              "targetStep": "/api/3/workflow_steps/41bc4338-81da-4415-be0b-667d33749425",
              "sourceStep": "/api/3/workflow_steps/1a2edafc-ca48-4b8c-aada-c09ef461bd65",
              "label": "",
              "isExecuted": false,
              "uuid": "d9a00865-e2bf-4e33-8131-6ffae27425b6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Query Results for Accessor Info -> Create Alerts from Splunk",
              "targetStep": "/api/3/workflow_steps/4d8dba5a-faea-46f1-8f6c-98feb54f3e8f",
              "sourceStep": "/api/3/workflow_steps/7ba7b260-1b32-4a4d-901d-3cadc6c1db91",
              "label": null,
              "isExecuted": false,
              "uuid": "5b9c497c-5fe5-4755-9f39-c6e9f8f27e03"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Query for Accessor Info",
              "targetStep": "/api/3/workflow_steps/48cf488d-9b9d-4676-b1ec-0787536a0556",
              "sourceStep": "/api/3/workflow_steps/1a2edafc-ca48-4b8c-aada-c09ef461bd65",
              "label": "",
              "isExecuted": false,
              "uuid": "e58a1c28-4832-4578-aab6-7102f352fa64"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Wait 10 seconds for query to complete -> Query Results for Accessor Info",
              "targetStep": "/api/3/workflow_steps/7ba7b260-1b32-4a4d-901d-3cadc6c1db91",
              "sourceStep": "/api/3/workflow_steps/d3bc61dd-ba09-4abb-869c-9d6a90f579c9",
              "label": null,
              "isExecuted": false,
              "uuid": "4ba8548a-47d7-43a4-9743-1db10265ee07"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Which SIEM",
              "targetStep": "/api/3/workflow_steps/1a2edafc-ca48-4b8c-aada-c09ef461bd65",
              "sourceStep": "/api/3/workflow_steps/840439c5-a4b5-4857-bdc9-28d384cf054c",
              "label": null,
              "isExecuted": false,
              "uuid": "8bb5f28d-4dc3-4a08-b926-58c4526cb524"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Query for Accessor Info -> Wait 10 seconds for query to complete",
              "targetStep": "/api/3/workflow_steps/d3bc61dd-ba09-4abb-869c-9d6a90f579c9",
              "sourceStep": "/api/3/workflow_steps/48cf488d-9b9d-4676-b1ec-0787536a0556",
              "label": null,
              "isExecuted": false,
              "uuid": "78eaa87a-6fb6-452f-823b-3af9f4bba580"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic Query for Accessor Info -> Create Alerts from Elastic",
              "targetStep": "/api/3/workflow_steps/0030c386-f29c-4519-bfbb-809474b886e3",
              "sourceStep": "/api/3/workflow_steps/41bc4338-81da-4415-be0b-667d33749425",
              "label": null,
              "isExecuted": false,
              "uuid": "6ed299e5-d328-4b62-bb8f-c645cb10120f"
            }
          ],
          "priority": null,
          "uuid": "8255c796-e6ac-4b25-b505-8269f122d534",
          "recordTags": [],
          "id": 102,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214962,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215015,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": ">> Create and Link Alerts from Hunt (Host-based)",
          "aliasName": null,
          "tag": "MITRE, ALERT, ELASTIC",
          "description": "Creates and Links the Alert with Hunt.",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "commandline",
            "userName",
            "technique",
            "processName",
            "MD5",
            "hostName",
            "sourceIP",
            "destinationIP",
            "sourceTool",
            "parentProcess",
            "eventTime",
            "parentProcessID",
            "processID",
            "parentCommandLine",
            "filePath",
            "eventName",
            "description",
            "huntIRI",
            "epochTime",
            "comment",
            "sourceImage",
            "targetImage",
            "source"
          ],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/13bd7fa6-aadc-4122-85b5-40f335a26d9c",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/af733325-f8f8-459a-b54c-965fc5abb344",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": {
                      "MD5": "{{ vars.MD5 }}",
                      "source": "{{ vars.source }}",
                      "comment": "{{ vars.comment }}",
                      "huntIRI": "{{ vars.huntIRI }}",
                      "filePath": "{{ vars.filePath }}",
                      "hostName": "{{ vars.hostName }}",
                      "sourceIP": "{{ vars.sourceIP }}",
                      "userName": "{{ vars.userName }}",
                      "epochTime": "{{ vars.epochTime }}",
                      "eventName": "{{ vars.eventName }}",
                      "eventTime": "{{ vars.eventTime }}",
                      "processID": "{{ vars.processID }}",
                      "technique": "{{ vars.technique }}",
                      "sourceTool": "{{ vars.sourceTool }}",
                      "commandline": "{{ vars.commandline }}",
                      "description": "{{ vars.description }}",
                      "processName": "{{ vars.processName }}",
                      "sourceImage": "{{ vars.sourceImage }}",
                      "targetImage": "{{ vars.targetImage }}",
                      "destinationIP": "{{ vars.destinationIP }}",
                      "parentProcess": "{{ vars.parentProcess }}",
                      "parentProcessID": "{{ vars.parentProcessID }}",
                      "parentCommandLine": "{{ vars.parentCommandLine }}"
                    }
                  }
                }
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "af733325-f8f8-459a-b54c-965fc5abb344",
              "id": 467
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Comment to Hunt",
              "description": null,
              "arguments": {
                "resource": {
                  "hunts": "['{{vars.input.params.huntIRI}}']",
                  "scans": null,
                  "tasks": null,
                  "alerts": "['{{vars.steps.Create_and_Link_Alert['@id']}}']",
                  "assets": null,
                  "emails": null,
                  "events": null,
                  "owners": null,
                  "people": null,
                  "content": "<p>{{vars.input.params.comment}}</p>",
                  "schedule": null,
                  "approvals": null,
                  "companies": null,
                  "incidents": null,
                  "indicators": null,
                  "attachments": null,
                  "vulnerabilities": null
                },
                "_showJson": false,
                "collection": "/api/3/comments",
                "step_variables": []
              },
              "status": null,
              "top": "520",
              "left": "354",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "b43096bf-4f3d-4219-b269-35becc1f020d",
              "id": 468
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Comments to Hunt",
              "description": null,
              "arguments": {
                "resource": {
                  "hunts": "['{{vars.input.params.huntIRI}}']",
                  "scans": null,
                  "tasks": null,
                  "alerts": null,
                  "assets": null,
                  "emails": null,
                  "events": null,
                  "owners": null,
                  "people": null,
                  "content": "<p>{{vars.input.params.comment}} Additionally, pre-existing related Alerts with Status \"Open\" or \"Re-Opened\" were observed within CyOps. Those Alerts have now been linked to this Hunt.</p>",
                  "schedule": null,
                  "approvals": null,
                  "companies": null,
                  "incidents": null,
                  "indicators": null,
                  "attachments": null,
                  "vulnerabilities": null
                },
                "_showJson": false,
                "collection": "/api/3/comments",
                "step_variables": []
              },
              "status": null,
              "top": "651",
              "left": "920",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "ea23ab6c-505f-4fc9-b530-1a7746194056",
              "id": 469
            },
            {
              "@type": "WorkflowStep",
              "name": "No New Alerts Needed",
              "description": null,
              "arguments": {
                "params": [],
                "version": "2.1.3",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "340",
              "left": "1260",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "f92264f4-4996-4240-be34-c5ccef0151b3",
              "id": 470
            },
            {
              "@type": "WorkflowStep",
              "name": "Do Alerts Already Exist",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes",
                    "step_iri": "/api/3/workflow_steps/7bddabbd-aa38-4ea3-bd77-4f32cad1a661",
                    "condition": "{{ vars.resultRecordscount != 0 }}"
                  },
                  {
                    "option": "No",
                    "step_iri": "/api/3/workflow_steps/68656cd5-4210-4855-8af2-c5b887222840",
                    "condition": "{{ vars.resultRecordscount == 0 }}"
                  }
                ]
              },
              "status": null,
              "top": "200",
              "left": "354",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "5dad5727-cddc-466c-80c5-cc75b2d657b2",
              "id": 471
            },
            {
              "@type": "WorkflowStep",
              "name": "Retrieve Existing Open Alerts",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "epochTime",
                      "value": "{{vars.input.params.epochTime}}",
                      "operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "mitreTechnique",
                      "value": "{{vars.input.params.technique}}",
                      "operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "processid",
                      "value": "{{vars.input.params.processID}}",
                      "operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "computerName",
                      "value": "{{vars.input.params.hostName}}",
                      "operator": "eq"
                    },
                    {
                      "logic": "OR",
                      "filters": [
                        {
                          "type": "object",
                          "field": "status",
                          "value": "/api/3/picklists/7de816ff-7140-4ee5-bd05-93ce22002146",
                          "_value": {
                            "itemValue": "Open"
                          },
                          "operator": "eq"
                        },
                        {
                          "type": "object",
                          "field": "status",
                          "value": "/api/3/picklists/891fb9d5-556c-44c6-9f7d-94a27dec732e",
                          "_value": {
                            "itemValue": "Re-Opened"
                          },
                          "operator": "eq"
                        }
                      ]
                    }
                  ]
                },
                "module": "alerts?$limit=30",
                "step_variables": {
                  "resultRecordscount2": "{{vars.result | length}}"
                }
              },
              "status": null,
              "top": "200",
              "left": "700",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "7bddabbd-aa38-4ea3-bd77-4f32cad1a661",
              "id": 472
            },
            {
              "@type": "WorkflowStep",
              "name": "Retrieve Existing Alerts",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "epochTime",
                      "value": "{{vars.input.params.epochTime}}",
                      "operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "mitreTechnique",
                      "value": "{{vars.input.params.technique}}",
                      "operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "processid",
                      "value": "{{vars.input.params.processID}}",
                      "operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "computerName",
                      "value": "{{vars.input.params.hostName}}",
                      "operator": "eq"
                    }
                  ]
                },
                "module": "alerts?$limit=300",
                "step_variables": {
                  "resultRecordscount": "{{vars.result | length}}"
                }
              },
              "status": null,
              "top": "200",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "757acccf-b3f1-4465-b024-b2d04fd91594",
              "id": 473
            },
            {
              "@type": "WorkflowStep",
              "name": "Are Any Alerts Still Open",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes",
                    "step_iri": "/api/3/workflow_steps/6957579e-e81a-4e99-9b5d-acacfc4f7ba0",
                    "condition": "{{ vars.resultRecordscount2 != 0 }}"
                  },
                  {
                    "option": "No",
                    "step_iri": "/api/3/workflow_steps/f92264f4-4996-4240-be34-c5ccef0151b3",
                    "condition": "{{ vars.resultRecordscount2 == 0 }}"
                  }
                ]
              },
              "status": null,
              "top": "340",
              "left": "920",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "a338834c-35bb-4082-babc-cfe5f3f053fd",
              "id": 474
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert",
              "description": null,
              "arguments": {
                "resource": {
                  "name": "MITRE-{{vars.input.params.technique}} Execution of {{vars.input.params.processName}}",
                  "type": {
                    "id": 547,
                    "@id": "/api/3/picklists/6bdeedd7-fb20-4b20-9717-f06520f0f788",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "MITRE ATT&CK",
                    "listName": "/api/3/picklist_names/a7087b9c-5660-495f-a8ac-c3b198ddb8c2",
                    "itemValue": "MITRE ATT&CK",
                    "orderIndex": 8
                  },
                  "hunts": "['{{vars.input.params.huntIRI}}']",
                  "state": {
                    "id": 220,
                    "@id": "/api/3/picklists/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "New",
                    "listName": "/api/3/picklist_names/2f9ed741-25fe-475a-9f12-64336288eebf",
                    "itemValue": "New",
                    "orderIndex": 0
                  },
                  "source": "{{vars.input.params.source}}",
                  "status": {
                    "id": 45,
                    "@id": "/api/3/picklists/7de816ff-7140-4ee5-bd05-93ce22002146",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Open",
                    "listName": "/api/3/picklist_names/33e964a9-d607-49f2-813c-7ce46141815a",
                    "itemValue": "Open",
                    "orderIndex": 1
                  },
                  "filePath": "{{vars.input.params.filePath}}",
                  "severity": {
                    "id": 82,
                    "@id": "/api/3/picklists/7efa2220-39bb-44e4-961f-ac368776e3b0",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#e31b1d",
                    "display": "Critical",
                    "listName": "/api/3/picklist_names/4e80cba3-032f-48b4-ac03-17e3ec247aac",
                    "itemValue": "Critical",
                    "orderIndex": 4
                  },
                  "userName": "{{vars.input.params.userName}}",
                  "__replace": "true",
                  "epochTime": "{{vars.input.params.epochTime}}",
                  "fileNames": "{{vars.input.params.processName}}",
                  "sourceTool": "{{vars.input.params.sourceTool}}",
                  "description": "<p>{{vars.input.params.description}}</p>",
                  "processName": "{{vars.input.params.processName}}",
                  "targetAsset": "{{vars.input.params.hostName}}",
                  "ackSlaStatus": {
                    "id": 289,
                    "@id": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "Awaiting Action",
                    "listName": "/api/3/picklist_names/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                    "itemValue": "Awaiting Action",
                    "orderIndex": 2
                  },
                  "computerName": "{{vars.input.params.hostName}}",
                  "respSlaStatus": {
                    "id": 289,
                    "@id": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "Awaiting Action",
                    "listName": "/api/3/picklist_names/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                    "itemValue": "Awaiting Action",
                    "orderIndex": 2
                  },
                  "sourceProcess": "{{vars.input.params.sourceImage}}",
                  "targetProcess": "{{vars.input.params.targetImage}}",
                  "mitreTechnique": "{{vars.input.params.technique}}",
                  "parentProcessName": "{{vars.input.params.parentProcess}}",
                  "escalatedtoincident": {
                    "id": 32,
                    "@id": "/api/3/picklists/2128a09c-153d-4db3-985d-de6be33deae5",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "No",
                    "listName": "/api/3/picklist_names/e131cc54-9ae4-43c9-b830-af6e331fe024",
                    "itemValue": "No",
                    "orderIndex": 1
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/alerts",
                "tagsOperation": "OverwriteTags",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "366",
              "left": "353",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "68656cd5-4210-4855-8af2-c5b887222840",
              "id": 475
            },
            {
              "@type": "WorkflowStep",
              "name": "Link Open Alerts to Hunt",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Retrieve_Existing_Open_Alerts}}",
                  "condition": ""
                },
                "resource": {
                  "__link": {
                    "hunts": "['{{vars.input.params.huntIRI}}']"
                  }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.item['@id']}}",
                "collectionType": "/api/3/alerts",
                "step_variables": []
              },
              "status": null,
              "top": "500",
              "left": "920",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "6957579e-e81a-4e99-9b5d-acacfc4f7ba0",
              "id": 476
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Are Any Alerts Still Open -> Link Open Alerts to Hunt",
              "targetStep": "/api/3/workflow_steps/6957579e-e81a-4e99-9b5d-acacfc4f7ba0",
              "sourceStep": "/api/3/workflow_steps/a338834c-35bb-4082-babc-cfe5f3f053fd",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "961f6cc4-5db1-4d1e-8e02-cc4ef7a00de0"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert -> Create and Link Comment to Hunt",
              "targetStep": "/api/3/workflow_steps/b43096bf-4f3d-4219-b269-35becc1f020d",
              "sourceStep": "/api/3/workflow_steps/68656cd5-4210-4855-8af2-c5b887222840",
              "label": null,
              "isExecuted": false,
              "uuid": "2b1fb3c9-e3d0-4d6a-b586-0818aeec2f1f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Retrieve Existing Open Alerts -> Are Any Alerts Still Open",
              "targetStep": "/api/3/workflow_steps/a338834c-35bb-4082-babc-cfe5f3f053fd",
              "sourceStep": "/api/3/workflow_steps/7bddabbd-aa38-4ea3-bd77-4f32cad1a661",
              "label": null,
              "isExecuted": false,
              "uuid": "a3e0464e-ba73-4e56-bd64-075a8d38bbd7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Retrieve Existing Alerts -> Do Alerts Already Exist",
              "targetStep": "/api/3/workflow_steps/5dad5727-cddc-466c-80c5-cc75b2d657b2",
              "sourceStep": "/api/3/workflow_steps/757acccf-b3f1-4465-b024-b2d04fd91594",
              "label": null,
              "isExecuted": false,
              "uuid": "cd41e974-eb2a-4361-bca8-24c9b04cced4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Retrieve Existing Alerts",
              "targetStep": "/api/3/workflow_steps/757acccf-b3f1-4465-b024-b2d04fd91594",
              "sourceStep": "/api/3/workflow_steps/af733325-f8f8-459a-b54c-965fc5abb344",
              "label": null,
              "isExecuted": false,
              "uuid": "8a2988ac-a1d6-4234-9bf7-8c4e3abfd569"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Are Any Alerts Still Open -> No New Alerts Needed",
              "targetStep": "/api/3/workflow_steps/f92264f4-4996-4240-be34-c5ccef0151b3",
              "sourceStep": "/api/3/workflow_steps/a338834c-35bb-4082-babc-cfe5f3f053fd",
              "label": "No",
              "isExecuted": false,
              "uuid": "062cdfc6-1a96-4a40-b868-1474c556d243"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Do Alerts Already Exist -> Create and Link Alert",
              "targetStep": "/api/3/workflow_steps/68656cd5-4210-4855-8af2-c5b887222840",
              "sourceStep": "/api/3/workflow_steps/5dad5727-cddc-466c-80c5-cc75b2d657b2",
              "label": "No",
              "isExecuted": false,
              "uuid": "7b43817c-aff3-4d9c-959b-a05d7c0d9329"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Do Alerts Already Exist -> Retrieve Existing Open Alerts",
              "targetStep": "/api/3/workflow_steps/7bddabbd-aa38-4ea3-bd77-4f32cad1a661",
              "sourceStep": "/api/3/workflow_steps/5dad5727-cddc-466c-80c5-cc75b2d657b2",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "ae4f6769-742f-40fc-bb5a-e068f8f1574a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Link Open Alerts to Hunt -> Create and Link Comments to Hunt",
              "targetStep": "/api/3/workflow_steps/ea23ab6c-505f-4fc9-b530-1a7746194056",
              "sourceStep": "/api/3/workflow_steps/6957579e-e81a-4e99-9b5d-acacfc4f7ba0",
              "label": null,
              "isExecuted": false,
              "uuid": "327fdc21-730e-4dda-972b-daf18dfd56bd"
            }
          ],
          "priority": null,
          "uuid": "b2eb92ae-1f03-4985-8aca-c50e66b060b8",
          "recordTags": [],
          "id": 103,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214962,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215015,
          "owners": [],
          "isPrivate": false
        }
      ]
    },
    {
      "@type": "WorkflowCollection",
      "name": "13 - MITRE ATT&CK™ - Defense Evasion",
      "description": "Playbooks designed to hunt Defense Evasion Techniques identified in the MITRE ATT&CK Framework",
      "visible": true,
      "image": null,
      "uuid": "432fc8f2-d88c-40b5-8664-e167e8f8fd19",
      "id": 30,
      "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "createDate": 1629214964,
      "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "modifyDate": 1629214964,
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "HUNTS - Rogue Domain Controller (T1207)",
          "aliasName": null,
          "tag": "ATT&CK, Defense_Evasion, DCShadow",
          "description": "Hunts for execution of or network traffic generated by Mimikatz module DCShadow. The network-based portion of this playbook requires network detection signatures.",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/432fc8f2-d88c-40b5-8664-e167e8f8fd19",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/685a84ab-0707-4f0a-a1e5-24250ddc417e",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Set SecurityOnion Elastic hunt times",
              "description": null,
              "arguments": {
                "SecOnionHuntEnd": "{% if vars.input.records[0].huntEnd  %}{{arrow.get(vars.input.records[0].huntEnd).format('YYYY-MM-DDTHH:mm:ss.SSSZ')}}{% else %}now{% endif %}",
                "SecOnionHuntStart": "{{ arrow.get(vars.input.records[0].huntStart).format('YYYY-MM-DDTHH:mm:ss.SSSZ') }}"
              },
              "status": null,
              "top": "260",
              "left": "640",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "28c2e7d0-31f7-4e1d-8241-05019d7d114d",
              "id": 710
            },
            {
              "@type": "WorkflowStep",
              "name": "Which SIEM",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Splunk",
                    "step_iri": "/api/3/workflow_steps/03fece55-a20e-4b60-b290-f40bb3fc4578",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Splunk\" }}"
                  },
                  {
                    "option": "Elasticsearch",
                    "step_iri": "/api/3/workflow_steps/b9febe62-72d1-4a95-b02a-017cbe1a713f",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Elastic\" }}"
                  }
                ]
              },
              "status": null,
              "top": "52",
              "left": "311",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "ac17686b-2a6a-43eb-b292-fd5144a2a278",
              "id": 711
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Splunk Results",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Query_Splunk.data.sid}}\"}",
                  "additional_args": "{\"a\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "8",
              "left": "1300",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "c6f40a9f-9339-4144-a9ab-9a02b0d36089",
              "id": 712
            },
            {
              "@type": "WorkflowStep",
              "name": "Query Security Onion Elastic",
              "description": "Queries the ELK stack within Security Onion for network events indicative of a potential DCshadow attack.",
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "*logstash-ids*",
                  "query": "{   \"size\": 0,   \"query\": {     \"bool\": {       \"must\": [         {           \"match\": {             \"alert\": \"*DCshadow*\"           }         }       ],       \"filter\": {         \"range\": {           \"@timestamp\": {             \"gte\": \"{{vars.SecOnionHuntStart}}\",             \"lte\": \"{{vars.SecOnionHuntEnd}}\"           }         }       }     }   },   \"aggregations\": {     \"IP_Combinations\": {       \"composite\": {         \"sources\": [           {             \"sourceIP\": {               \"terms\": {                 \"field\": \"source_ip.keyword\"               }             }           },           {             \"destIP\": {               \"terms\": {                 \"field\": \"destination_ip.keyword\"               }             }           }         ]       },       \"aggregations\": {         \"top_hit\": {           \"top_hits\": {             \"size\": 1           }         }       }     }   } }",
                  "routing": "",
                  "doc_type": "",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_query",
                "operationTitle": "Execute Query",
                "step_variables": []
              },
              "status": null,
              "top": "260",
              "left": "1000",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "e98ebb31-3c99-4c2e-b7be-ce6a2864a497",
              "id": 713
            },
            {
              "@type": "WorkflowStep",
              "name": "No Security Onion Query",
              "description": null,
              "arguments": {
                "params": [],
                "version": "2.4.0",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "380",
              "left": "320",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "3825aacd-c233-4a83-bb9a-3b0fba1a9a85",
              "id": 714
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Splunk hunt times",
              "description": null,
              "arguments": {
                "splunkHuntEnd": "{% if vars.input.records[0].huntEnd %}latest={{vars.input.records[0].huntEnd}}{% endif %}",
                "splunkHuntStart": "earliest={{vars.input.records[0].huntStart}}"
              },
              "status": null,
              "top": "8",
              "left": "640",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "03fece55-a20e-4b60-b290-f40bb3fc4578",
              "id": 715
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Elastic hunt times",
              "description": null,
              "arguments": {
                "elasticHuntEnd": "{% if vars.input.records[0].huntEnd %} {{ arrow.get(vars.input.records[0].huntEnd).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }} {% else %} now {% endif %}",
                "elasticHuntStart": "{{ arrow.get(vars.input.records[0].huntStart).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }}"
              },
              "status": null,
              "top": "168",
              "left": "640",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "b9febe62-72d1-4a95-b02a-017cbe1a713f",
              "id": 716
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "d832bdaa-7888-4834-8445-1cfdca9b8e84",
                "title": "T1207 - Hunt for Rogue Domain Controller",
                "resources": [
                  "hunt"
                ],
                "inputVariables": [
                  {
                    "name": "siem",
                    "type": "picklists",
                    "label": "SIEM",
                    "title": "Picklist",
                    "usable": true,
                    "tooltip": "Choose your SIEM",
                    "dataType": "picklist",
                    "formType": "picklist",
                    "required": true,
                    "_expanded": true,
                    "collection": false,
                    "dataSource": {
                      "model": "picklists",
                      "query": {
                        "sort": [
                          {
                            "field": "orderIndex",
                            "direction": "ASC"
                          }
                        ],
                        "logic": "AND",
                        "filters": [
                          {
                            "field": "listName__name",
                            "value": "SIEMs",
                            "operator": "eq"
                          }
                        ]
                      },
                      "displayConditions": {
                        "876c1483-416b-4d2f-8138-15769ae16d5c": {
                          "conditions": null,
                          "visibility": "visible"
                        },
                        "bcebcab1-3f93-468a-9f3f-91e5c511a0b5": {
                          "conditions": null,
                          "visibility": "visible"
                        }
                      }
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "_nameTouched": true,
                    "defaultValue": {
                      "id": 280,
                      "@id": "/api/3/picklists/876c1483-416b-4d2f-8138-15769ae16d5c",
                      "icon": null,
                      "@type": "Picklist",
                      "color": null,
                      "display": "Elastic",
                      "listName": "/api/3/picklist_names/98830189-afff-40e6-bed1-94012551dc67",
                      "itemValue": "Elastic",
                      "orderIndex": 1
                    },
                    "displayTemplate": "{{ itemValue }}",
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  },
                  {
                    "name": "seconion",
                    "type": "boolean",
                    "label": "Query Security Onion?",
                    "title": "Checkbox",
                    "usable": true,
                    "tooltip": "Query Security Onion for IDS Alerts",
                    "dataType": "checkbox",
                    "formType": "checkbox",
                    "required": false,
                    "_expanded": true,
                    "collection": false,
                    "searchable": true,
                    "templateUrl": "app/components/form/fields/checkbox.html",
                    "_nameTouched": true,
                    "defaultValue": null,
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "siem": "{{vars.request.data[\"siem\"]}}",
                      "seconion": "{{vars.request.data[\"seconion\"]}}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "hunt": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "100",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "685a84ab-0707-4f0a-a1e5-24250ddc417e",
              "id": 717
            },
            {
              "@type": "WorkflowStep",
              "name": "Query Splunk",
              "description": "Queries Splunk for Sysmon events for Mimikatz with lsadump::dcshadow as a command line parameter",
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=\"sysmon\" {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} EventCode=1 CommandLine=\"*lsadump::dcshadow*\" | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "8",
              "left": "1000",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "18b593c8-4370-4c71-82ec-8f3a7dadbced",
              "id": 718
            },
            {
              "@type": "WorkflowStep",
              "name": "Security Onion Query",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "No",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/3825aacd-c233-4a83-bb9a-3b0fba1a9a85"
                  },
                  {
                    "option": "SecOnion",
                    "step_iri": "/api/3/workflow_steps/28c2e7d0-31f7-4e1d-8241-05019d7d114d",
                    "condition": "{{ vars.input.params.seconion == True }}"
                  }
                ]
              },
              "status": null,
              "top": "260",
              "left": "320",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "f576ebf0-82a8-4cc2-a22f-9e53624f2a56",
              "id": 719
            },
            {
              "@type": "WorkflowStep",
              "name": "Deduplicate Comments",
              "description": null,
              "arguments": {
                "arguments": {
                  "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
              },
              "status": null,
              "top": "168",
              "left": "1994",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "a173fd2e-1985-4844-a436-eac7c20c75f4",
              "id": 720
            },
            {
              "@type": "WorkflowStep",
              "name": "Query Elastic for Sysmon logs",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_id:1 AND event_type:sysmon AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND event_data.CommandLine:\"*lsadump\\:\\:dcshadow*\"",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "168",
              "left": "1000",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "f674d2f0-23f0-4099-89d5-9af742c12349",
              "id": 721
            },
            {
              "@type": "WorkflowStep",
              "name": "Copy  of Create and Link Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Query_Elastic_for_Sysmon_logs.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query identified Mimikatz module DCShadow execution from {{vars.item._source.image_path.split(\"\\\\\")[-1]}} on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-DCShadow-{{vars.item._source.image_path.split(\"\\\\\")[-1]}} executed with DCShadow commandline arguments",
                  "epochTime": "{{arrow.get(vars.item._source.event_data.UtcTime).timestamp}}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "DCShadow",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "A command line argument was passed containing \"lsadump::dcshadow\". This is indicative of attempted execution of Mimikatz module DCShadow, which is used to cause a host to masquerade as a Domain Controller. This host should be investigated for further signs of compromise.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1]}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1207",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "168",
              "left": "1631",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "4d0209cb-7384-42a4-b71d-8be18ed75201",
              "id": 722
            },
            {
              "@type": "WorkflowStep",
              "name": "Copy  of Copy  of Create and Link Network Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Query_Security_Onion_Elastic.data.aggregations.IP_Combinations.buckets}}",
                  "condition": ""
                },
                "arguments": {
                  "comment": "SIEM query identified a non-Domain Controller host at {{vars.item.top_hit.hits.hits[0]._source.source_ips}} attempting to push changes to Active Directory using the DRSUAPI, which is potentially indicative of Mimikatz's DCShadow module being used, at {{vars.item.top_hit.hits.hits[0]._source[\"@timestamp\"]}}",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "hostName": "",
                  "sourceIP": "{{vars.item.top_hit.hits.hits[0]._source.source_ip}}",
                  "userName": "",
                  "alertName": "ATT&CK-DCShadow-{{vars.item.top_hit.hits.hits[0]._source.destination_ip}} targeted by potential DCShadow attack",
                  "epochTime": "{{arrow.get(vars.item.top_hit.hits.hits[0]._source['@timestamp']).timestamp}}",
                  "eventName": "{{vars.item.top_hit.hits.hits[0]._source.alert}}",
                  "eventTime": "{{vars.item.top_hit.hits.hits[0]._source[\"@timestamp\"]}}",
                  "technique": "DCShadow",
                  "sourceData": "{{vars.item.top_hit.hits.hits[0]._source}}",
                  "sourcePort": "{{vars.item.top_hit.hits.hits[0]._source.source_port}}",
                  "sourceTool": "IDS",
                  "description": "A non-Domain Controller has been observed attempting to make changes to Active Directory using the DRSUAPI. This may be indicative of DCShadow usage. The initiating host should be investigated for further signs of compromise.",
                  "mitreTechId": "T1207",
                  "destinationIP": "{{vars.item.top_hit.hits.hits[0]._source.destination_ip}}",
                  "destinationPort": "{{vars.item.top_hit.hits.hits[0]._source.destination_port}}"
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/4c558395-6eba-4ef9-b416-6056749487f7"
              },
              "status": null,
              "top": "260",
              "left": "1626",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "d7734f27-ace3-4d69-8999-6327315965f7",
              "id": 723
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Splunk_Results.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query identified Mimikatz module DCShadow execution from {{vars.item.process_exec}} on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-DCShadow-{{vars.item.process_exec}} executed with DCShadow commandline arguments",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "DCShadow",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.vendor_product}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "A command line argument was passed containing \"lsadump::dcshadow\". This is indicative of attempted execution of Mimikatz module DCShadow, which is used to cause a host to masquerade as a Domain Controller. This host should be investigated for further signs of compromise.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1207",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "8",
              "left": "1632",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "8eb8863b-6ba6-4119-a97d-b5a4a0195fa2",
              "id": 724
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/03fece55-a20e-4b60-b290-f40bb3fc4578",
              "sourceStep": "/api/3/workflow_steps/ac17686b-2a6a-43eb-b292-fd5144a2a278",
              "label": "Splunk",
              "isExecuted": false,
              "uuid": "b82eec52-9cfb-4683-9cc2-afcad65d3454"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Security Onion Query -> Set SecurityOnion Elastic hunt times",
              "targetStep": "/api/3/workflow_steps/28c2e7d0-31f7-4e1d-8241-05019d7d114d",
              "sourceStep": "/api/3/workflow_steps/f576ebf0-82a8-4cc2-a22f-9e53624f2a56",
              "label": "SecOnion",
              "isExecuted": false,
              "uuid": "7f080f1b-67bd-41c7-85c4-6ef0417cedd5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create and Link Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/a173fd2e-1985-4844-a436-eac7c20c75f4",
              "sourceStep": "/api/3/workflow_steps/4d0209cb-7384-42a4-b71d-8be18ed75201",
              "label": null,
              "isExecuted": false,
              "uuid": "e4f2e725-0596-4ff1-97da-fc794d35ee96"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Copy  of Create and Link Network Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/a173fd2e-1985-4844-a436-eac7c20c75f4",
              "sourceStep": "/api/3/workflow_steps/d7734f27-ace3-4d69-8999-6327315965f7",
              "label": null,
              "isExecuted": false,
              "uuid": "8c838188-49a2-473a-9de4-d26a4bef61e9"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Query Elastic for Sysmon logs -> Copy  of Create and Link Alert",
              "targetStep": "/api/3/workflow_steps/4d0209cb-7384-42a4-b71d-8be18ed75201",
              "sourceStep": "/api/3/workflow_steps/f674d2f0-23f0-4099-89d5-9af742c12349",
              "label": null,
              "isExecuted": false,
              "uuid": "3454c24e-a570-4cc9-87d9-44744c4bbf7a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/a173fd2e-1985-4844-a436-eac7c20c75f4",
              "sourceStep": "/api/3/workflow_steps/8eb8863b-6ba6-4119-a97d-b5a4a0195fa2",
              "label": null,
              "isExecuted": false,
              "uuid": "69f54b5d-1295-4a78-9da2-79877f44ff98"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Security Onion Query",
              "targetStep": "/api/3/workflow_steps/f576ebf0-82a8-4cc2-a22f-9e53624f2a56",
              "sourceStep": "/api/3/workflow_steps/685a84ab-0707-4f0a-a1e5-24250ddc417e",
              "label": null,
              "isExecuted": false,
              "uuid": "7ed833be-a955-4065-80cb-026c54d8da17"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Splunk Results -> Create Host Alert",
              "targetStep": "/api/3/workflow_steps/8eb8863b-6ba6-4119-a97d-b5a4a0195fa2",
              "sourceStep": "/api/3/workflow_steps/c6f40a9f-9339-4144-a9ab-9a02b0d36089",
              "label": null,
              "isExecuted": false,
              "uuid": "54df7a4a-c7f2-470a-987d-f915eaf08766"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Query Splunk -> Get Splunk Results",
              "targetStep": "/api/3/workflow_steps/c6f40a9f-9339-4144-a9ab-9a02b0d36089",
              "sourceStep": "/api/3/workflow_steps/18b593c8-4370-4c71-82ec-8f3a7dadbced",
              "label": null,
              "isExecuted": false,
              "uuid": "e16f51a1-3897-467f-ba67-e1eef330edd2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Which SIEM",
              "targetStep": "/api/3/workflow_steps/ac17686b-2a6a-43eb-b292-fd5144a2a278",
              "sourceStep": "/api/3/workflow_steps/685a84ab-0707-4f0a-a1e5-24250ddc417e",
              "label": null,
              "isExecuted": false,
              "uuid": "b844f2a0-7a35-405a-a0a6-7056cb0f11c5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Set Elastic hunt times",
              "targetStep": "/api/3/workflow_steps/b9febe62-72d1-4a95-b02a-017cbe1a713f",
              "sourceStep": "/api/3/workflow_steps/ac17686b-2a6a-43eb-b292-fd5144a2a278",
              "label": "Elasticsearch",
              "isExecuted": false,
              "uuid": "2d4ec3a0-6383-41ba-b0dc-a615a87b808d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> Query Elastic for Sysmon logs",
              "targetStep": "/api/3/workflow_steps/f674d2f0-23f0-4099-89d5-9af742c12349",
              "sourceStep": "/api/3/workflow_steps/b9febe62-72d1-4a95-b02a-017cbe1a713f",
              "label": null,
              "isExecuted": false,
              "uuid": "cba24c12-b08a-4db1-92be-d61ccf7d8b04"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Query Security Onion Elastic -> Copy  of Copy  of Create and Link Network Alert",
              "targetStep": "/api/3/workflow_steps/d7734f27-ace3-4d69-8999-6327315965f7",
              "sourceStep": "/api/3/workflow_steps/e98ebb31-3c99-4c2e-b7be-ce6a2864a497",
              "label": null,
              "isExecuted": false,
              "uuid": "bb33be9e-f0c7-4bb2-a08a-6472d3e5b5b7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Security Onion Query -> No Security Onion Query",
              "targetStep": "/api/3/workflow_steps/3825aacd-c233-4a83-bb9a-3b0fba1a9a85",
              "sourceStep": "/api/3/workflow_steps/f576ebf0-82a8-4cc2-a22f-9e53624f2a56",
              "label": "No",
              "isExecuted": false,
              "uuid": "f5028b57-8935-4bcb-a1b6-2ef831809f59"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Query Splunk",
              "targetStep": "/api/3/workflow_steps/18b593c8-4370-4c71-82ec-8f3a7dadbced",
              "sourceStep": "/api/3/workflow_steps/03fece55-a20e-4b60-b290-f40bb3fc4578",
              "label": null,
              "isExecuted": false,
              "uuid": "43a36933-fd68-48e1-8085-1dcb6f329875"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set SecurityOnion Elastic hunt times -> Query Security Onion Elastic",
              "targetStep": "/api/3/workflow_steps/e98ebb31-3c99-4c2e-b7be-ce6a2864a497",
              "sourceStep": "/api/3/workflow_steps/28c2e7d0-31f7-4e1d-8241-05019d7d114d",
              "label": null,
              "isExecuted": false,
              "uuid": "3ad1b6eb-e73c-4c8c-9c9b-451c7870f205"
            }
          ],
          "priority": null,
          "uuid": "00e0fc49-d7c6-4a18-abcf-f9a7abaafce9",
          "recordTags": [],
          "id": 122,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214964,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215019,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "HUNTS - Deobfuscate/Decode Files or Information (T1140)",
          "aliasName": null,
          "tag": "ATT&CK, Defense_Evasion, Certutil, Copy, Deobfuscate_Decode_Files_or_Information",
          "description": "Identifies use of Certutil or copy /b to deobfuscate data/files",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/432fc8f2-d88c-40b5-8664-e167e8f8fd19",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/7152c501-2223-406c-aad2-52b315ed82d8",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "return certutil query",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Query_for_certutil.data.sid}}\"}",
                  "additional_args": "{\"A\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "420",
              "left": "1180",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "c76c9339-d493-4175-bee8-a7c87f20ad3e",
              "id": 725
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert2",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Return_copy_b_query.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query identified a potential attempt to use the command \"copy /b\" to deobfuscate/decode files or information through {{vars.item.process_exec}} on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-Deobfuscate/Decode-cmd executed with \"copy /b\" argument",
                  "epochTime": "{{vars.item.epoch_time}}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "Deobfuscate/Decode Files or Information- Copy /b",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.EventChannel}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "An attempt to utilize Copy /b to was observed. An attacker could use the command Copy /b to read data as binary and then interact with/utilize the data elsewhere. This attack has been observed being conducted by nation-state actors and other malicious entities to join together binary fragments to assemble and run executables.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1140",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "340",
              "left": "1460",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "18572af6-67db-4177-9cd7-d1cd7e191a1d",
              "id": 726
            },
            {
              "@type": "WorkflowStep",
              "name": "Query for certutil",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=sysmon EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} Image=\"C:\\\\Windows\\\\System32\\\\certutil.exe\" OR  Image=\"C:\\\\Windows\\\\SysWOW64\\\\certutil.exe\" |  table host Image MD5 ParentImage User CommandLine process_exec EventChannel UtcTime ParentProcessId ProcessId ParentCommandLine ProcessGuid Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"A\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "420",
              "left": "900",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "3ed0abdf-3c56-4e85-a279-46858ef2d5dd",
              "id": 727
            },
            {
              "@type": "WorkflowStep",
              "name": "Query for Copy B",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=sysmon EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} Image=\"C:\\\\Windows\\\\System32\\\\cmd.exe\" OR  Image=\"C:\\\\Windows\\\\SysWOW64\\\\cmd.exe\" CommandLine=\"*copy /b*\" | table host Image MD5 ParentImage User CommandLine process_exec EventChannel UtcTime ParentProcessId ProcessId ParentCommandLine ProcessGuid Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"A\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "340",
              "left": "900",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "4ca5e845-3ac4-4a90-9c4b-57e3cb482f2f",
              "id": 728
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "443ae372-0df6-432c-8ed6-62e0f55f50ac",
                "title": "T1140 - Hunt for Deobfuscate/Decode Files or Information",
                "resources": [
                  "hunt"
                ],
                "inputVariables": [
                  {
                    "name": "siem",
                    "type": "picklists",
                    "label": "SIEM",
                    "title": "Picklist",
                    "usable": true,
                    "_ignore": false,
                    "tooltip": "Choose your SIEM",
                    "dataType": "picklist",
                    "formType": "picklist",
                    "required": true,
                    "_expanded": true,
                    "collection": false,
                    "dataSource": {
                      "model": "picklists",
                      "query": {
                        "sort": [
                          {
                            "field": "orderIndex",
                            "direction": "ASC"
                          }
                        ],
                        "logic": "AND",
                        "filters": [
                          {
                            "field": "listName__name",
                            "value": "SIEMs",
                            "operator": "eq"
                          }
                        ]
                      },
                      "displayConditions": {
                        "876c1483-416b-4d2f-8138-15769ae16d5c": {
                          "conditions": null,
                          "visibility": "visible"
                        },
                        "bcebcab1-3f93-468a-9f3f-91e5c511a0b5": {
                          "conditions": null,
                          "visibility": "visible"
                        }
                      }
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "_nameTouched": true,
                    "defaultValue": {
                      "id": 280,
                      "@id": "/api/3/picklists/876c1483-416b-4d2f-8138-15769ae16d5c",
                      "icon": null,
                      "@type": "Picklist",
                      "color": null,
                      "display": "Elastic",
                      "listName": "/api/3/picklist_names/98830189-afff-40e6-bed1-94012551dc67",
                      "itemValue": "Elastic",
                      "orderIndex": 1
                    },
                    "useModuleField": false,
                    "displayTemplate": "{{ itemValue }}",
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "siem": "{{vars.request.data[\"siem\"]}}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "hunt": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "260",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "7152c501-2223-406c-aad2-52b315ed82d8",
              "id": 729
            },
            {
              "@type": "WorkflowStep",
              "name": "Select SIEM",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "step_iri": "/api/3/workflow_steps/bf7dc3a5-1958-4bd7-89a5-4a142d726669",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Elastic\" }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/7135d23b-cab7-492f-a28b-1a36b388386e",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Splunk\" }}"
                  }
                ]
              },
              "status": null,
              "top": "260",
              "left": "308",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "64d3ecd1-9454-4013-b477-3d759f53b9fe",
              "id": 730
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Elastic hunt times",
              "description": null,
              "arguments": {
                "elasticHuntEnd": "{% if vars.input.records[0].huntEnd %} {{ arrow.get(vars.input.records[0].huntEnd).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }} {% else %} now {% endif %}",
                "elasticHuntStart": "{{ arrow.get(vars.input.records[0].huntStart).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }}"
              },
              "status": null,
              "top": "140",
              "left": "600",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "bf7dc3a5-1958-4bd7-89a5-4a142d726669",
              "id": 731
            },
            {
              "@type": "WorkflowStep",
              "name": "Return copy b query",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Query_for_Copy_B.data.sid}}\"}",
                  "additional_args": "{\"A\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "340",
              "left": "1180",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "2d52980f-5a81-4aaf-b407-d5a60371a6a5",
              "id": 732
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Elastic Link Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_query_for_Certutil.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query identified a possible attempt to use {{vars.item._source.image_path.split(\"\\\\\")[-1]}} to Deobfuscate/Decode Files or Information on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-Deobfuscate/Decode-Certutil executed",
                  "epochTime": "{{arrow.get(vars.item._source.event_data.UtcTime).timestamp}}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "Deobfuscate/Decode Files or Information- Certutil",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "An attempt to utilize Certutil.exe to decode data was observed. An attacker could use Certutil to deobfuscate data and then interact with/utilize the data elsewhere.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1]}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1140",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "100",
              "left": "1454",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "90e694a0-94cd-446d-a952-069e1281f663",
              "id": 733
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Elastic Link Alert2",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_query_for_Copy_B.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query identified a potential attempt to use the command \"copy /b\" to deobfuscate/decode files or information through {{vars.item._source.image_path.split(\"\\\\\")[-1]}} to Deobfuscate/Decode Files or Information on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-Deobfuscate/Decode-cmd executed with \"copy /b\" argument",
                  "epochTime": "{{arrow.get(vars.item._source.event_data.UtcTime).timestamp}}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "Deobfuscate/Decode Files or Information- Copy /b",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "An attempt to utilize Copy /b to was observed. An attacker could use the command Copy /b to read data as binary and then interact with/utilize the data elsewhere. This attack has been observed being conducted by nation-state actors and other malicious entities to join together binary fragments to assemble and run executables.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1]}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1140",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "180",
              "left": "1452",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "11e1c307-af09-4028-bd62-b59b12957518",
              "id": 734
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.return_certutil_query.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query identified a possible attempt to use {{vars.item.process_exec}} to Deobfuscate/Decode Files or Information on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-Deobfuscate/Decode-Certutil executed",
                  "epochTime": "{{vars.item.epoch_time}}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "Deobfuscate/Decode Files or Information- Certutil",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.EventChannel}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "An attempt to utilize Certutil.exe to decode data was observed. An attacker could use Certutil to deobfuscate data and then interact with/utilize the data elsewhere.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1140",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "420",
              "left": "1460",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "4f766bfa-eca6-4b4c-b8f4-2e7a51b2a6a3",
              "id": 735
            },
            {
              "@type": "WorkflowStep",
              "name": "Deduplicate Comments",
              "description": null,
              "arguments": {
                "arguments": {
                  "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
              },
              "status": null,
              "top": "260",
              "left": "1772",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "078c0c07-540c-498b-b288-47868d4a6b30",
              "id": 736
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic query for Certutil",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND event_id:1 AND (image_path:\"C:\\\\Windows\\\\System32\\\\certutil.exe\" OR image_path:\"C:\\\\Windows\\\\SysWOW64\\\\certutil.exe\") AND event_data.CommandLine:\"*-decode*\"",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "100",
              "left": "900",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "34eccccb-c5e4-4dc3-95a6-80642b6f3c03",
              "id": 737
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Splunk hunt times",
              "description": null,
              "arguments": {
                "splunkHuntEnd": "{% if vars.input.records[0].huntEnd %}latest={{vars.input.records[0].huntEnd}}{% endif %}",
                "splunkHuntStart": "earliest={{vars.input.records[0].huntStart}}"
              },
              "status": null,
              "top": "366",
              "left": "600",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "7135d23b-cab7-492f-a28b-1a36b388386e",
              "id": 738
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic query for Copy B",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND event_id:1 AND (image_path:\"C:\\\\Windows\\\\System32\\\\cmd.exe\" OR  image_path:\"C:\\\\Windows\\\\SysWOW64\\\\cmd.exe\") AND event_data.CommandLine:\"*copy\\ \\/b*\"",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "180",
              "left": "900",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "b7c64b22-b101-4590-a3c2-733067c63569",
              "id": 739
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Query for Copy B -> Copy  of return certutil query",
              "targetStep": "/api/3/workflow_steps/2d52980f-5a81-4aaf-b407-d5a60371a6a5",
              "sourceStep": "/api/3/workflow_steps/4ca5e845-3ac4-4a90-9c4b-57e3cb482f2f",
              "label": null,
              "isExecuted": false,
              "uuid": "6e4d370b-4485-4a8c-b199-9cecffbff301"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> Copy  of Elastic query for Certutil",
              "targetStep": "/api/3/workflow_steps/b7c64b22-b101-4590-a3c2-733067c63569",
              "sourceStep": "/api/3/workflow_steps/bf7dc3a5-1958-4bd7-89a5-4a142d726669",
              "label": null,
              "isExecuted": false,
              "uuid": "486ea23b-a8e8-483a-a79b-5265ccf7275e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Elastic Link Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/078c0c07-540c-498b-b288-47868d4a6b30",
              "sourceStep": "/api/3/workflow_steps/90e694a0-94cd-446d-a952-069e1281f663",
              "label": null,
              "isExecuted": false,
              "uuid": "9328436e-0405-4a39-bd61-77ff1549e241"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Select SIEM -> Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/7135d23b-cab7-492f-a28b-1a36b388386e",
              "sourceStep": "/api/3/workflow_steps/64d3ecd1-9454-4013-b477-3d759f53b9fe",
              "label": null,
              "isExecuted": false,
              "uuid": "a166bc03-41f1-4f3f-9ee2-f38a80660baf"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> Elastic query for Certutil",
              "targetStep": "/api/3/workflow_steps/34eccccb-c5e4-4dc3-95a6-80642b6f3c03",
              "sourceStep": "/api/3/workflow_steps/bf7dc3a5-1958-4bd7-89a5-4a142d726669",
              "label": null,
              "isExecuted": false,
              "uuid": "6e25d755-1865-4067-b396-6e4b1b8ef46e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create Splunk Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/078c0c07-540c-498b-b288-47868d4a6b30",
              "sourceStep": "/api/3/workflow_steps/18572af6-67db-4177-9cd7-d1cd7e191a1d",
              "label": null,
              "isExecuted": false,
              "uuid": "2433c7cc-6860-4058-9e72-4bfa68f54e59"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Splunk Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/078c0c07-540c-498b-b288-47868d4a6b30",
              "sourceStep": "/api/3/workflow_steps/4f766bfa-eca6-4b4c-b8f4-2e7a51b2a6a3",
              "label": null,
              "isExecuted": false,
              "uuid": "7c7c83ae-ab9e-4089-ae6f-e99ba92d2f6c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic query for Certutil -> Copy  of Create and Link Alert",
              "targetStep": "/api/3/workflow_steps/90e694a0-94cd-446d-a952-069e1281f663",
              "sourceStep": "/api/3/workflow_steps/34eccccb-c5e4-4dc3-95a6-80642b6f3c03",
              "label": null,
              "isExecuted": false,
              "uuid": "aff1d748-dafc-4199-ad75-3da8bd6f54de"
            },
            {
              "@type": "WorkflowRoute",
              "name": "return certutil query -> Create Splunk Alert",
              "targetStep": "/api/3/workflow_steps/4f766bfa-eca6-4b4c-b8f4-2e7a51b2a6a3",
              "sourceStep": "/api/3/workflow_steps/c76c9339-d493-4175-bee8-a7c87f20ad3e",
              "label": null,
              "isExecuted": false,
              "uuid": "cb7ee4df-7e62-43e0-8b3b-2e5952c9c4b9"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Elastic query for Certutil -> Create and Elastic Link Alert2",
              "targetStep": "/api/3/workflow_steps/11e1c307-af09-4028-bd62-b59b12957518",
              "sourceStep": "/api/3/workflow_steps/b7c64b22-b101-4590-a3c2-733067c63569",
              "label": null,
              "isExecuted": false,
              "uuid": "821b8968-0705-4415-805f-b9ec13fb3e57"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Query for certutil",
              "targetStep": "/api/3/workflow_steps/3ed0abdf-3c56-4e85-a279-46858ef2d5dd",
              "sourceStep": "/api/3/workflow_steps/7135d23b-cab7-492f-a28b-1a36b388386e",
              "label": null,
              "isExecuted": false,
              "uuid": "ddc375eb-1989-483d-a523-5e610a677aad"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create and Elastic Link Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/078c0c07-540c-498b-b288-47868d4a6b30",
              "sourceStep": "/api/3/workflow_steps/11e1c307-af09-4028-bd62-b59b12957518",
              "label": null,
              "isExecuted": false,
              "uuid": "2388c9d9-18e7-4aae-94c9-9500335cadc6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Return copy b query -> Copy  of Create Splunk Alert",
              "targetStep": "/api/3/workflow_steps/18572af6-67db-4177-9cd7-d1cd7e191a1d",
              "sourceStep": "/api/3/workflow_steps/2d52980f-5a81-4aaf-b407-d5a60371a6a5",
              "label": null,
              "isExecuted": false,
              "uuid": "e13c347d-4da1-49b1-8cee-ea66dd2fc83b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Select SIEM",
              "targetStep": "/api/3/workflow_steps/64d3ecd1-9454-4013-b477-3d759f53b9fe",
              "sourceStep": "/api/3/workflow_steps/7152c501-2223-406c-aad2-52b315ed82d8",
              "label": null,
              "isExecuted": false,
              "uuid": "c87197cc-8d62-4e82-a475-11c9277f758b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Query for Copy B",
              "targetStep": "/api/3/workflow_steps/4ca5e845-3ac4-4a90-9c4b-57e3cb482f2f",
              "sourceStep": "/api/3/workflow_steps/7135d23b-cab7-492f-a28b-1a36b388386e",
              "label": null,
              "isExecuted": false,
              "uuid": "df6f6138-7a7f-4c37-b5de-efec6c7455f9"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Query for certutil -> return certutil query",
              "targetStep": "/api/3/workflow_steps/c76c9339-d493-4175-bee8-a7c87f20ad3e",
              "sourceStep": "/api/3/workflow_steps/3ed0abdf-3c56-4e85-a279-46858ef2d5dd",
              "label": null,
              "isExecuted": false,
              "uuid": "2b612002-e22c-45dc-902f-b6ab58ebb05f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Select SIEM -> Convert time for elastic",
              "targetStep": "/api/3/workflow_steps/bf7dc3a5-1958-4bd7-89a5-4a142d726669",
              "sourceStep": "/api/3/workflow_steps/64d3ecd1-9454-4013-b477-3d759f53b9fe",
              "label": null,
              "isExecuted": false,
              "uuid": "5e0fe3ce-e30d-4b2a-93e8-a82bdb077f16"
            }
          ],
          "priority": null,
          "uuid": "0a596dd7-d068-423a-ad43-163be40138f3",
          "recordTags": [],
          "id": 123,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214964,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215019,
          "owners": [],
          "isPrivate": false
        }
      ]
    },
    {
      "@type": "WorkflowCollection",
      "name": "13 - MITRE ATT&CK™ - Modulars",
      "description": "Modular Playbooks used by MITRE Hunt playbooks",
      "visible": true,
      "image": null,
      "uuid": "45837bce-3b50-4797-aa1d-642331b98f2b",
      "id": 24,
      "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "createDate": 1629214963,
      "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "modifyDate": 1629214963,
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Deduplicate Comments (Asset)",
          "aliasName": null,
          "tag": null,
          "description": "Deduplicates comments on Asset records.",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "assetIRI"
          ],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/45837bce-3b50-4797-aa1d-642331b98f2b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/245746b6-a72a-429c-af97-9b8a6940e6d3",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Duplicate Comments",
              "description": null,
              "arguments": {
                "append2": "{% for item in vars.comments %}{% if item['@id'][16:] not in vars.comment_dict.values() %}{{vars.comment_list.append(item['@id'][16:])}}{% endif %}{% endfor %}"
              },
              "status": null,
              "top": "180",
              "left": "560",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "c901e53b-ffa9-4f88-903a-cf33e0eb21ac",
              "id": 477
            },
            {
              "@type": "WorkflowStep",
              "name": "Delete Comments",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/3/delete/comments",
                  "body": "{\"ids\": {{vars.comment_list}}}",
                  "method": "DELETE"
                },
                "version": "2.1.3",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "top": "260",
              "left": "840",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "4217566e-80f0-48b4-b1a9-a8252e462a31",
              "id": 478
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": {
                      "id": "{{ vars.id }}",
                      "hunt": "{{ vars.hunt }}",
                      "comment": "{{ vars.comment }}",
                      "alert_id": "{{ vars.alert_id }}",
                      "assetIRI": "{{ vars.assetIRI }}",
                      "comments": "{{ vars.comments }}",
                      "hunt_iri": "{{ vars.hunt_iri }}",
                      "alert_iri": "{{ vars.alert_iri }}"
                    }
                  }
                }
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "245746b6-a72a-429c-af97-9b8a6940e6d3",
              "id": 479
            },
            {
              "@type": "WorkflowStep",
              "name": "Find Comments",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "{{vars.input.params.assetIRI}}?$relationships=true",
                  "body": "",
                  "method": "GET"
                },
                "version": "2.2.0",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "top": "100",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "5657ece1-381d-4f17-a751-a8da80b8166e",
              "id": 480
            },
            {
              "@type": "WorkflowStep",
              "name": "Clear Vars",
              "description": null,
              "arguments": {
                "append2": ""
              },
              "status": null,
              "top": "260",
              "left": "560",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "b934d85f-a4a4-472e-a8c2-1b6b4eb6f4e2",
              "id": 481
            },
            {
              "@type": "WorkflowStep",
              "name": "Append",
              "description": null,
              "arguments": {
                "append": "{% for item in vars.comments %}{% if item.content not in vars.comment_dict %}{% set x=vars.comment_dict.__setitem__(item.content, item['@id'][16:]) %}{% endif %}{% endfor %}"
              },
              "status": null,
              "top": "180",
              "left": "290",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "95ed31ad-d38a-4e82-9eab-bc09a0715c11",
              "id": 482
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Comments Vars",
              "description": null,
              "arguments": {
                "comments": "{{vars.steps.Find_Comments.data.comments}}",
                "comment_dict": "{}",
                "comment_list": "[]"
              },
              "status": null,
              "top": "100",
              "left": "290",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "881ec0fd-1bef-441b-8653-99846b1888ba",
              "id": 483
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Find Comments",
              "targetStep": "/api/3/workflow_steps/5657ece1-381d-4f17-a751-a8da80b8166e",
              "sourceStep": "/api/3/workflow_steps/245746b6-a72a-429c-af97-9b8a6940e6d3",
              "label": null,
              "isExecuted": false,
              "uuid": "45451a17-3a2b-4108-9213-e24f0323fd28"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Clear Vars -> Delete Comments",
              "targetStep": "/api/3/workflow_steps/4217566e-80f0-48b4-b1a9-a8252e462a31",
              "sourceStep": "/api/3/workflow_steps/b934d85f-a4a4-472e-a8c2-1b6b4eb6f4e2",
              "label": null,
              "isExecuted": false,
              "uuid": "4166e1c1-98bc-4916-ace4-897318072427"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Find Comments -> Set",
              "targetStep": "/api/3/workflow_steps/881ec0fd-1bef-441b-8653-99846b1888ba",
              "sourceStep": "/api/3/workflow_steps/5657ece1-381d-4f17-a751-a8da80b8166e",
              "label": null,
              "isExecuted": false,
              "uuid": "eb4c96ab-1381-41ee-9587-7dcf8720547a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Duplicate Comments -> Clear Vars",
              "targetStep": "/api/3/workflow_steps/b934d85f-a4a4-472e-a8c2-1b6b4eb6f4e2",
              "sourceStep": "/api/3/workflow_steps/c901e53b-ffa9-4f88-903a-cf33e0eb21ac",
              "label": null,
              "isExecuted": false,
              "uuid": "8c70f78f-87a2-4372-9358-577ac3fb8dcb"
            },
            {
              "@type": "WorkflowRoute",
              "name": "append -> jared",
              "targetStep": "/api/3/workflow_steps/c901e53b-ffa9-4f88-903a-cf33e0eb21ac",
              "sourceStep": "/api/3/workflow_steps/95ed31ad-d38a-4e82-9eab-bc09a0715c11",
              "label": null,
              "isExecuted": false,
              "uuid": "5c12ca3d-a02e-4d54-8106-110970307492"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set -> append",
              "targetStep": "/api/3/workflow_steps/95ed31ad-d38a-4e82-9eab-bc09a0715c11",
              "sourceStep": "/api/3/workflow_steps/881ec0fd-1bef-441b-8653-99846b1888ba",
              "label": null,
              "isExecuted": false,
              "uuid": "49ee7a46-2a3e-4afb-a93d-c098aa76e936"
            }
          ],
          "priority": null,
          "uuid": "2518a58d-0e73-4f09-8a64-43c19c000f86",
          "recordTags": [],
          "id": 104,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214963,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215028,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Deduplicate Comments (Hunt)",
          "aliasName": null,
          "tag": null,
          "description": "Deduplicates comments on Hunt records.",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "hunt_iri"
          ],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/45837bce-3b50-4797-aa1d-642331b98f2b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/c20a79d0-1aa5-41af-9ec6-e23c04eb3500",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Append",
              "description": null,
              "arguments": {
                "append": "{% for item in vars.comments %}{% if item.content not in vars.comment_dict %}{% set x=vars.comment_dict.__setitem__(item.content, item['@id'][16:]) %}{% endif %}{% endfor %}"
              },
              "status": null,
              "top": "180",
              "left": "289",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "910e9394-0561-42b2-bb53-464be573710b",
              "id": 484
            },
            {
              "@type": "WorkflowStep",
              "name": "Clear Vars",
              "description": null,
              "arguments": {
                "append2": ""
              },
              "status": null,
              "top": "260",
              "left": "560",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "962fffd8-0772-45de-ae97-acbda97795de",
              "id": 485
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Comments Vars",
              "description": null,
              "arguments": {
                "comments": "{{vars.steps.Find_Comments.data.comments}}",
                "comment_dict": "{}",
                "comment_list": "[]"
              },
              "status": null,
              "top": "100",
              "left": "289",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "381cc334-2edb-482c-99aa-c612e534f78c",
              "id": 486
            },
            {
              "@type": "WorkflowStep",
              "name": "Delete Comments",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/3/delete/comments",
                  "body": "{\"ids\": {{vars.comment_list}}}",
                  "method": "DELETE"
                },
                "version": "2.1.3",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "top": "260",
              "left": "830",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "d4d6f3a8-05cc-418e-bd8d-f75ad38f8fc9",
              "id": 487
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Duplicate Comments",
              "description": null,
              "arguments": {
                "append2": "{% for item in vars.comments %}{% if item['@id'][16:] not in vars.comment_dict.values() %}{{vars.comment_list.append(item['@id'][16:])}}{% endif %}{% endfor %}"
              },
              "status": null,
              "top": "180",
              "left": "560",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "5a0f162c-75ab-4e48-a528-3eefa4c09670",
              "id": 488
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": {
                      "id": "{{ vars.id }}",
                      "hunt": "{{ vars.hunt }}",
                      "comment": "{{ vars.comment }}",
                      "alert_id": "{{ vars.alert_id }}",
                      "comments": "{{ vars.comments }}",
                      "hunt_iri": "{{ vars.hunt_iri }}",
                      "alert_iri": "{{ vars.alert_iri }}"
                    }
                  }
                }
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "c20a79d0-1aa5-41af-9ec6-e23c04eb3500",
              "id": 489
            },
            {
              "@type": "WorkflowStep",
              "name": "Find Comments",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "{{vars.input.params.hunt_iri}}?$relationships=true",
                  "body": "",
                  "method": "GET"
                },
                "version": "2.1.3",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "top": "100",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "8af929ac-e0ea-4b2b-bde7-a842512ab6a5",
              "id": 490
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Get Duplicate Comments -> Clear Vars",
              "targetStep": "/api/3/workflow_steps/962fffd8-0772-45de-ae97-acbda97795de",
              "sourceStep": "/api/3/workflow_steps/5a0f162c-75ab-4e48-a528-3eefa4c09670",
              "label": null,
              "isExecuted": false,
              "uuid": "578db882-ece2-4bb6-bc33-480636def1c6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Find Comments",
              "targetStep": "/api/3/workflow_steps/8af929ac-e0ea-4b2b-bde7-a842512ab6a5",
              "sourceStep": "/api/3/workflow_steps/c20a79d0-1aa5-41af-9ec6-e23c04eb3500",
              "label": null,
              "isExecuted": false,
              "uuid": "95a28c9f-3a6c-457b-8168-19a6d13a8357"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Find Comments -> Set",
              "targetStep": "/api/3/workflow_steps/381cc334-2edb-482c-99aa-c612e534f78c",
              "sourceStep": "/api/3/workflow_steps/8af929ac-e0ea-4b2b-bde7-a842512ab6a5",
              "label": null,
              "isExecuted": false,
              "uuid": "52706d92-c2c3-46d6-9e26-536c0f160cb6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "append -> jared",
              "targetStep": "/api/3/workflow_steps/5a0f162c-75ab-4e48-a528-3eefa4c09670",
              "sourceStep": "/api/3/workflow_steps/910e9394-0561-42b2-bb53-464be573710b",
              "label": null,
              "isExecuted": false,
              "uuid": "097cc5bc-d685-450b-93ea-515471a31244"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Clear Vars -> Delete Comments",
              "targetStep": "/api/3/workflow_steps/d4d6f3a8-05cc-418e-bd8d-f75ad38f8fc9",
              "sourceStep": "/api/3/workflow_steps/962fffd8-0772-45de-ae97-acbda97795de",
              "label": null,
              "isExecuted": false,
              "uuid": "5b0fc989-6c45-497e-989f-6348f241a480"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set -> append",
              "targetStep": "/api/3/workflow_steps/910e9394-0561-42b2-bb53-464be573710b",
              "sourceStep": "/api/3/workflow_steps/381cc334-2edb-482c-99aa-c612e534f78c",
              "label": null,
              "isExecuted": false,
              "uuid": "b864744a-6e57-49b2-9cbe-120235a35989"
            }
          ],
          "priority": null,
          "uuid": "3fd311be-a1c6-41c7-99a3-8794b33d8f8a",
          "recordTags": [],
          "id": 105,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214963,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215028,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Create Asset from Alert",
          "aliasName": null,
          "tag": "Postcreate",
          "description": "Links an Asset to an Alert if a hostname is present",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/45837bce-3b50-4797-aa1d-642331b98f2b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/57ef6777-741c-4da7-8b87-23040f12dc15",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Check if Asset exists",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "hostname",
                      "value": "%{{vars.input.records[0].computerName}}%",
                      "operator": "like"
                    }
                  ]
                },
                "module": "assets?$limit=30",
                "step_variables": []
              },
              "status": null,
              "top": "270",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "4b619256-0e4a-4767-a5e4-8c9c957cbe2e",
              "id": 491
            },
            {
              "@type": "WorkflowStep",
              "name": "Field is empty",
              "description": null,
              "arguments": {
                "params": [],
                "version": "2.4.0",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "120",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "952968f6-b8ec-4a57-b3c1-822c3d81c572",
              "id": 492
            },
            {
              "@type": "WorkflowStep",
              "name": "Is computername field empty",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "step_iri": "/api/3/workflow_steps/952968f6-b8ec-4a57-b3c1-822c3d81c572",
                    "condition": "{{ vars.input.records[0].computerName | length == 0 }}"
                  },
                  {
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/4b619256-0e4a-4767-a5e4-8c9c957cbe2e"
                  }
                ]
              },
              "status": null,
              "top": "120",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "c42ed77e-2ac0-4d6e-b426-2e90e2133fcd",
              "id": 493
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "resource": "alerts",
                "resources": [
                  "alerts"
                ],
                "step_variables": {
                  "input": {
                    "records": [
                      "{{vars.input.records[0]}}"
                    ]
                  }
                },
                "fieldbasedtrigger": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "computerName",
                      "value": "false",
                      "operator": "isnull"
                    },
                    {
                      "type": "object",
                      "field": "type",
                      "value": "/api/3/picklists/ab6d7fd7-7b16-4ac2-9cf2-b52a912baee8",
                      "_value": {
                        "display": "MITRE ATT&CK",
                        "itemValue": "MITRE ATT&CK"
                      },
                      "operator": "eq"
                    }
                  ]
                }
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/ea155646-3821-4542-9702-b246da430a8d",
              "uuid": "57ef6777-741c-4da7-8b87-23040f12dc15",
              "id": 494
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Asset record",
              "description": null,
              "arguments": {
                "resource": {
                  "ip": null,
                  "tag": null,
                  "name": null,
                  "notes": null,
                  "scans": null,
                  "state": null,
                  "tasks": null,
                  "users": null,
                  "alerts": null,
                  "owners": null,
                  "status": null,
                  "emailId": null,
                  "category": null,
                  "comments": null,
                  "hostname": "{{vars.input.records[0].computerName.split(\".\",1)[0]}}",
                  "location": null,
                  "__replace": "true",
                  "companies": null,
                  "deviceUid": null,
                  "incidents": null,
                  "managedBy": null,
                  "assetClass": null,
                  "indicators": null,
                  "macAddress": "52:54:00:ef:1c:03",
                  "propertyOf": null,
                  "recordTags": null,
                  "attachments": null,
                  "criticality": null,
                  "dateScanned": null,
                  "description": null,
                  "legalMatters": null,
                  "serialNumber": null,
                  "operatingSystem": null,
                  "vulnerabilities": null,
                  "registrationDate": null,
                  "physicalIncidents": null
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/assets",
                "tagsOperation": "OverwriteTags",
                "step_variables": []
              },
              "status": null,
              "top": "220",
              "left": "869",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "a3d5d3fc-7137-49dc-9fc4-5f0108c661e1",
              "id": 495
            },
            {
              "@type": "WorkflowStep",
              "name": "Link Asset to Alert",
              "description": null,
              "arguments": {
                "resource": {
                  "__link": {
                    "alerts": "[\"{{vars.input.records[0]['@id']}}\"]"
                  }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.steps.Check_if_Asset_exists[0]['@id']}}",
                "collectionType": "/api/3/assets",
                "step_variables": []
              },
              "status": null,
              "top": "320",
              "left": "872",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "eb68ce90-3a41-4aa9-a8a0-2391399e7548",
              "id": 496
            },
            {
              "@type": "WorkflowStep",
              "name": "Was Asset found",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "step_iri": "/api/3/workflow_steps/eb68ce90-3a41-4aa9-a8a0-2391399e7548",
                    "condition": "{{ vars.steps.Check_if_Asset_exists | length > 0 }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/a3d5d3fc-7137-49dc-9fc4-5f0108c661e1",
                    "condition": "{{ vars.steps.Check_if_Asset_exists | length == 0 }}"
                  }
                ]
              },
              "status": null,
              "top": "270",
              "left": "554",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "55fa7f21-80e2-4976-8c25-4319a362bddf",
              "id": 497
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Was Asset found -> Link Asset to Alert",
              "targetStep": "/api/3/workflow_steps/eb68ce90-3a41-4aa9-a8a0-2391399e7548",
              "sourceStep": "/api/3/workflow_steps/55fa7f21-80e2-4976-8c25-4319a362bddf",
              "label": null,
              "isExecuted": false,
              "uuid": "ea1e8a44-52b3-4696-9cd1-f4c4c79aba07"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Is computername empty",
              "targetStep": "/api/3/workflow_steps/c42ed77e-2ac0-4d6e-b426-2e90e2133fcd",
              "sourceStep": "/api/3/workflow_steps/57ef6777-741c-4da7-8b87-23040f12dc15",
              "label": null,
              "isExecuted": false,
              "uuid": "f84e5731-19a9-4cce-90c0-bc00627a0ba6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is computername empty -> Check if Asset exists",
              "targetStep": "/api/3/workflow_steps/4b619256-0e4a-4767-a5e4-8c9c957cbe2e",
              "sourceStep": "/api/3/workflow_steps/c42ed77e-2ac0-4d6e-b426-2e90e2133fcd",
              "label": "",
              "isExecuted": false,
              "uuid": "96ea54ac-2345-422b-8457-1f0c6fe31aef"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is computername empty -> Field is empty",
              "targetStep": "/api/3/workflow_steps/952968f6-b8ec-4a57-b3c1-822c3d81c572",
              "sourceStep": "/api/3/workflow_steps/c42ed77e-2ac0-4d6e-b426-2e90e2133fcd",
              "label": null,
              "isExecuted": false,
              "uuid": "037bae42-c7e7-481c-80a8-865b341fbd61"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Was Asset found -> Create Asset record",
              "targetStep": "/api/3/workflow_steps/a3d5d3fc-7137-49dc-9fc4-5f0108c661e1",
              "sourceStep": "/api/3/workflow_steps/55fa7f21-80e2-4976-8c25-4319a362bddf",
              "label": null,
              "isExecuted": false,
              "uuid": "77e13946-4768-4185-aaed-c580c69c64cd"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Check if Asset exists -> Was Asset found",
              "targetStep": "/api/3/workflow_steps/55fa7f21-80e2-4976-8c25-4319a362bddf",
              "sourceStep": "/api/3/workflow_steps/4b619256-0e4a-4767-a5e4-8c9c957cbe2e",
              "label": null,
              "isExecuted": false,
              "uuid": "f3d4b0f6-ccf4-4ed2-8907-0755e1f1daeb"
            }
          ],
          "priority": null,
          "uuid": "4a7a5afa-6215-4544-93e5-5d54638a8721",
          "recordTags": [],
          "id": 106,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214963,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215028,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Create Alert from Network Sensor and Link to Hunt",
          "aliasName": null,
          "tag": "",
          "description": "Creates and links an Alert from a network based sensor to a Hunt",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "userName",
            "technique",
            "hostName",
            "sourceIP",
            "destinationIP",
            "sourceTool",
            "eventTime",
            "eventName",
            "description",
            "sourcePort",
            "destinationPort",
            "epochTime",
            "huntIRI",
            "comment",
            "sourceData",
            "alertName",
            "mitreTechId"
          ],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/45837bce-3b50-4797-aa1d-642331b98f2b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/1a0726a8-f334-465a-9d74-4cfc07e87a2b",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Find Existing Open Alerts",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "epochTime",
                      "value": "{{vars.input.params.epochTime}}",
                      "operator": "eq",
                      "_operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "sourceIp",
                      "value": "{{vars.input.params.sourceIP}}",
                      "operator": "eq",
                      "_operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "destinationIp",
                      "value": "{{vars.input.params.destinationIP}}",
                      "operator": "eq",
                      "_operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "mitreTechnique",
                      "value": "%{{vars.input.params.technique}}%",
                      "operator": "like",
                      "_operator": "like"
                    },
                    {
                      "logic": "OR",
                      "filters": [
                        {
                          "type": "object",
                          "field": "status",
                          "value": "/api/3/picklists/7de816ff-7140-4ee5-bd05-93ce22002146",
                          "_value": {
                            "itemValue": "Open"
                          },
                          "operator": "eq"
                        },
                        {
                          "type": "object",
                          "field": "status",
                          "value": "/api/3/picklists/891fb9d5-556c-44c6-9f7d-94a27dec732e",
                          "_value": {
                            "itemValue": "Re-Opened"
                          },
                          "operator": "eq"
                        }
                      ]
                    }
                  ]
                },
                "module": "alerts?$limit=300",
                "step_variables": {
                  "resultRecordscount2": "{{vars.result | length}}"
                }
              },
              "status": null,
              "top": "180",
              "left": "880",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "04e322ad-bd7e-48c5-931b-8e7e14594558",
              "id": 498
            },
            {
              "@type": "WorkflowStep",
              "name": "Find Existing Alerts",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "epochTime",
                      "value": "{{vars.input.params.epochTime}}",
                      "operator": "eq",
                      "_operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "sourceIp",
                      "value": "{{vars.input.params.sourceIP}}",
                      "operator": "eq",
                      "_operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "destinationIp",
                      "value": "{{vars.input.params.destinationIP}}",
                      "operator": "eq",
                      "_operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "mitreTechnique",
                      "value": "%{{vars.input.params.technique}}%",
                      "operator": "like",
                      "_operator": "like"
                    }
                  ]
                },
                "module": "alerts?$limit=300",
                "step_variables": {
                  "resultRecordscount": "{{vars.result | length}}"
                }
              },
              "status": null,
              "top": "60",
              "left": "533",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "6b49a17f-d997-499c-9d30-cd70a97075c8",
              "id": 499
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": {
                      "MD5": "{{ vars.MD5 }}",
                      "comment": "{{ vars.comment }}",
                      "huntIRI": "{{ vars.huntIRI }}",
                      "filePath": "{{ vars.filePath }}",
                      "hostName": "{{ vars.hostName }}",
                      "sourceIP": "{{ vars.sourceIP }}",
                      "userName": "{{ vars.userName }}",
                      "alertName": "{{ vars.alertName }}",
                      "epochTime": "{{ vars.epochTime }}",
                      "eventName": "{{ vars.eventName }}",
                      "eventTime": "{{ vars.eventTime }}",
                      "processID": "{{ vars.processID }}",
                      "technique": "{{ vars.technique }}",
                      "sourceData": "{{ vars.sourceData }}",
                      "sourcePort": "{{ vars.sourcePort }}",
                      "sourceTool": "{{ vars.sourceTool }}",
                      "commandline": "{{ vars.commandline }}",
                      "description": "{{ vars.description }}",
                      "mitreTechId": "{{ vars.mitreTechId }}",
                      "processName": "{{ vars.processName }}",
                      "destinationIP": "{{ vars.destinationIP }}",
                      "parentProcess": "{{ vars.parentProcess }}",
                      "destinationPort": "{{ vars.destinationPort }}",
                      "parentProcessID": "{{ vars.parentProcessID }}",
                      "parentCommandLine": "{{ vars.parentCommandLine }}"
                    }
                  }
                }
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "1a0726a8-f334-465a-9d74-4cfc07e87a2b",
              "id": 500
            },
            {
              "@type": "WorkflowStep",
              "name": "Are Any Alerts Still Open",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes",
                    "step_iri": "/api/3/workflow_steps/7948d169-a07f-4931-bcc9-fee83a7893c8",
                    "condition": "{{ vars.resultRecordscount2 != 0 }}"
                  },
                  {
                    "option": "No",
                    "step_iri": "/api/3/workflow_steps/fd2d7209-f21e-45d1-b3b5-29c9ebea666d",
                    "condition": "{{ vars.resultRecordscount2 == 0 }}"
                  }
                ]
              },
              "status": null,
              "top": "360",
              "left": "880",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "e311b4a9-719d-4777-8650-aeb9e01d9a09",
              "id": 501
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert",
              "description": null,
              "arguments": {
                "resource": {
                  "url": "{{vars.input.params.url or None}}",
                  "name": "{% if vars.input.params.alertName%}{{vars.input.params.alertName}}{% else %}MITRE-{{vars.input.params.technique}} Execution of {{vars.input.params.processName}}{% endif %}",
                  "type": {
                    "id": 547,
                    "@id": "/api/3/picklists/6bdeedd7-fb20-4b20-9717-f06520f0f788",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "MITRE ATT&CK",
                    "listName": "/api/3/picklist_names/a7087b9c-5660-495f-a8ac-c3b198ddb8c2",
                    "itemValue": "MITRE ATT&CK",
                    "orderIndex": 8
                  },
                  "hunts": "['{{vars.input.params.huntIRI}}']",
                  "state": {
                    "id": 220,
                    "@id": "/api/3/picklists/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "New",
                    "listName": "/api/3/picklist_names/2f9ed741-25fe-475a-9f12-64336288eebf",
                    "itemValue": "New",
                    "orderIndex": 0
                  },
                  "source": "IDS",
                  "status": {
                    "id": 45,
                    "@id": "/api/3/picklists/7de816ff-7140-4ee5-bd05-93ce22002146",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Open",
                    "listName": "/api/3/picklist_names/33e964a9-d607-49f2-813c-7ce46141815a",
                    "itemValue": "Open",
                    "orderIndex": 1
                  },
                  "filePath": "{{vars.input.params.filePath or None}}",
                  "sourceIp": "{{vars.input.params.sourceIP or None}}",
                  "userName": "{{vars.input.params.userName or None}}",
                  "__replace": "true",
                  "epochTime": "{{vars.input.params.epochTime or None}}",
                  "eventTime": "{{vars.input.params.eventTime}}",
                  "fileNames": "{{vars.input.params.processName or None}}",
                  "sourcePort": "{{vars.input.params.sourcePort or None}}",
                  "sourceTool": "{{vars.input.params.sourceTool or None}}",
                  "sourcedata": "{{vars.input.params.sourceData | toJSON}}",
                  "description": "<p>{{vars.input.params.description}}</p>",
                  "processName": "{{vars.input.params.processName or None}}",
                  "targetAsset": "{{vars.input.params.hostName or None}}",
                  "ackSlaStatus": {
                    "id": 289,
                    "@id": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "Awaiting Action",
                    "listName": "/api/3/picklist_names/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                    "itemValue": "Awaiting Action",
                    "orderIndex": 2
                  },
                  "computerName": "{{vars.input.params.hostName or None}}",
                  "destinationIp": "{{vars.input.params.destinationIP or None}}",
                  "mitreattackid": "{{vars.input.params.mitreTechId}}",
                  "respSlaStatus": {
                    "id": 289,
                    "@id": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "Awaiting Action",
                    "listName": "/api/3/picklist_names/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                    "itemValue": "Awaiting Action",
                    "orderIndex": 2
                  },
                  "mitreTechnique": "{{vars.input.params.technique}}",
                  "destinationPort": "{{vars.input.params.destinationPort or None}}",
                  "parentProcessName": "{{vars.input.params.parentProcess or None}}",
                  "escalatedtoincident": {
                    "id": 32,
                    "@id": "/api/3/picklists/2128a09c-153d-4db3-985d-de6be33deae5",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "No",
                    "listName": "/api/3/picklist_names/e131cc54-9ae4-43c9-b830-af6e331fe024",
                    "itemValue": "No",
                    "orderIndex": 1
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/alerts",
                "tagsOperation": "OverwriteTags",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "360",
              "left": "531",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "fb6ae96d-142e-4752-8d14-98624d33d00b",
              "id": 502
            },
            {
              "@type": "WorkflowStep",
              "name": "Do Alerts Already Exist",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes",
                    "step_iri": "/api/3/workflow_steps/04e322ad-bd7e-48c5-931b-8e7e14594558",
                    "condition": "{{ vars.resultRecordscount != 0 }}"
                  },
                  {
                    "option": "No",
                    "step_iri": "/api/3/workflow_steps/fb6ae96d-142e-4752-8d14-98624d33d00b",
                    "condition": "{{ vars.resultRecordscount == 0 }}"
                  }
                ]
              },
              "status": null,
              "top": "180",
              "left": "532",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "5f5b8252-7556-471a-86e7-cb184e5ff6c7",
              "id": 503
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Comment to Hunt",
              "description": null,
              "arguments": {
                "resource": {
                  "hunts": "['{{vars.input.params.huntIRI}}']",
                  "scans": null,
                  "tasks": null,
                  "users": null,
                  "alerts": null,
                  "assets": null,
                  "emails": null,
                  "events": null,
                  "owners": null,
                  "people": null,
                  "content": "<p>{{vars.input.params.comment}}</p>",
                  "schedule": null,
                  "approvals": null,
                  "companies": null,
                  "incidents": null,
                  "indicators": null,
                  "attachments": null,
                  "vulnerabilities": null
                },
                "_showJson": false,
                "collection": "/api/3/comments",
                "step_variables": []
              },
              "status": null,
              "top": "493",
              "left": "532",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "2ad2826b-6aff-4f46-a6f4-36dad1ef874f",
              "id": 504
            },
            {
              "@type": "WorkflowStep",
              "name": "No New Alerts Needed",
              "description": null,
              "arguments": {
                "params": [],
                "version": "2.1.3",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "360",
              "left": "1200",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "fd2d7209-f21e-45d1-b3b5-29c9ebea666d",
              "id": 505
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Comments to Hunt",
              "description": null,
              "arguments": {
                "resource": {
                  "hunts": "['{{vars.input.params.huntIRI}}']",
                  "scans": null,
                  "tasks": null,
                  "users": null,
                  "alerts": null,
                  "assets": null,
                  "emails": null,
                  "events": null,
                  "owners": null,
                  "people": null,
                  "content": "<p>{{vars.input.params.comment}} Additionally, pre-existing related Alerts with Status \"Open\" or \"Re-Opened\" were observed within CyOps. Those Alerts have now been linked to this Hunt.</p>",
                  "schedule": null,
                  "approvals": null,
                  "companies": null,
                  "incidents": null,
                  "indicators": null,
                  "attachments": null,
                  "vulnerabilities": null
                },
                "_showJson": false,
                "collection": "/api/3/comments",
                "step_variables": []
              },
              "status": null,
              "top": "630",
              "left": "880",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "c7b134ed-73f2-40e9-b7ab-331e19229b36",
              "id": 506
            },
            {
              "@type": "WorkflowStep",
              "name": "Link Open Alerts",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Find_Existing_Open_Alerts}}",
                  "condition": ""
                },
                "resource": {
                  "__link": {
                    "hunts": "['{{vars.input.params.huntIRI}}']"
                  }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.item['@id']}}",
                "collectionType": "/api/3/alerts",
                "step_variables": []
              },
              "status": null,
              "top": "500",
              "left": "880",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "7948d169-a07f-4931-bcc9-fee83a7893c8",
              "id": 507
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Find Existing Open Alerts -> Are Any Alerts Still Open",
              "targetStep": "/api/3/workflow_steps/e311b4a9-719d-4777-8650-aeb9e01d9a09",
              "sourceStep": "/api/3/workflow_steps/04e322ad-bd7e-48c5-931b-8e7e14594558",
              "label": null,
              "isExecuted": false,
              "uuid": "fedb7323-17dc-4f79-8a09-82559528cfe3"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Do Alerts Already Exist -> Create and Link Alert",
              "targetStep": "/api/3/workflow_steps/fb6ae96d-142e-4752-8d14-98624d33d00b",
              "sourceStep": "/api/3/workflow_steps/5f5b8252-7556-471a-86e7-cb184e5ff6c7",
              "label": "No",
              "isExecuted": false,
              "uuid": "86c11f33-7ec0-45a7-bca3-a43628c7cfd0"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Link Open Alerts -> Create and Link Comments to Hunt",
              "targetStep": "/api/3/workflow_steps/c7b134ed-73f2-40e9-b7ab-331e19229b36",
              "sourceStep": "/api/3/workflow_steps/7948d169-a07f-4931-bcc9-fee83a7893c8",
              "label": null,
              "isExecuted": false,
              "uuid": "d8043f5a-bb51-473e-9821-2d77ee936f8a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Are Any Alerts Still Open -> No New Alerts Needed",
              "targetStep": "/api/3/workflow_steps/fd2d7209-f21e-45d1-b3b5-29c9ebea666d",
              "sourceStep": "/api/3/workflow_steps/e311b4a9-719d-4777-8650-aeb9e01d9a09",
              "label": "No",
              "isExecuted": false,
              "uuid": "702dc96e-ede7-48ec-9d02-d233849e3e50"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert -> Create and Link Comment to Hunt",
              "targetStep": "/api/3/workflow_steps/2ad2826b-6aff-4f46-a6f4-36dad1ef874f",
              "sourceStep": "/api/3/workflow_steps/fb6ae96d-142e-4752-8d14-98624d33d00b",
              "label": null,
              "isExecuted": false,
              "uuid": "60ab4a2e-37da-4e20-9ccb-70ff251cd3c1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Are Any Alerts Still Open -> Link Open Alerts",
              "targetStep": "/api/3/workflow_steps/7948d169-a07f-4931-bcc9-fee83a7893c8",
              "sourceStep": "/api/3/workflow_steps/e311b4a9-719d-4777-8650-aeb9e01d9a09",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "c3d5270d-cf89-485b-8606-472c57697db6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Do Alerts Already Exist -> Find Existing Open Alerts",
              "targetStep": "/api/3/workflow_steps/04e322ad-bd7e-48c5-931b-8e7e14594558",
              "sourceStep": "/api/3/workflow_steps/5f5b8252-7556-471a-86e7-cb184e5ff6c7",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "1fdd7196-8891-4a54-8893-514c7d7098ba"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Find Existing Alerts",
              "targetStep": "/api/3/workflow_steps/6b49a17f-d997-499c-9d30-cd70a97075c8",
              "sourceStep": "/api/3/workflow_steps/1a0726a8-f334-465a-9d74-4cfc07e87a2b",
              "label": null,
              "isExecuted": false,
              "uuid": "b95b3f32-17f2-44b7-a797-6429cb08df64"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Find Existing Alerts -> Do Alerts Already Exist",
              "targetStep": "/api/3/workflow_steps/5f5b8252-7556-471a-86e7-cb184e5ff6c7",
              "sourceStep": "/api/3/workflow_steps/6b49a17f-d997-499c-9d30-cd70a97075c8",
              "label": null,
              "isExecuted": false,
              "uuid": "4a5de620-a9db-4259-b4ae-06e7008e0f71"
            }
          ],
          "priority": null,
          "uuid": "4c558395-6eba-4ef9-b416-6056749487f7",
          "recordTags": [],
          "id": 107,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214963,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215028,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Create User from Alert (Host)",
          "aliasName": null,
          "tag": null,
          "description": null,
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/45837bce-3b50-4797-aa1d-642331b98f2b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/097cade9-ac05-45db-a810-0ef880d05235",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get related incidents",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "{{vars.input.records[0]['@id']}}?$relationships=true&$export=true",
                  "body": "",
                  "method": "GET"
                },
                "version": "2.4.0",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "top": "100",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "75ba586e-7ee1-48ff-ab25-5559ab98fb19",
              "id": 508
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Users",
              "description": null,
              "arguments": {
                "arguments": {
                  "domain": "",
                  "hostname": "",
                  "computername": "{{vars.input.records[0].computerName}}",
                  "alertRecordIRI": "{{vars.input.records[0]['@id']}}",
                  "emailRecordIRI": "",
                  "incidentRecordIRI": "{% if vars.steps.Get_related_incidents.data.incidents[0] %}{{vars.steps.Get_related_incidents.data.incidents[0]}}{% endif %}",
                  "user_query_output": "{{vars.input.records[0].userName.replace(\"\\\\\",\"\\\\\\\\\")}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/b6b01cac-f181-4691-bb00-2300d999217d"
              },
              "status": null,
              "top": "100",
              "left": "580",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "fba48af8-0a34-46b5-afc2-fc3f1f29bb81",
              "id": 509
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "resource": "alerts",
                "resources": [
                  "alerts"
                ],
                "step_variables": {
                  "input": {
                    "records": [
                      "{{vars.input.records[0]}}"
                    ]
                  }
                },
                "fieldbasedtrigger": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "userName",
                      "value": "false",
                      "operator": "isnull"
                    },
                    {
                      "type": "object",
                      "field": "type",
                      "value": "/api/3/picklists/ab6d7fd7-7b16-4ac2-9cf2-b52a912baee8",
                      "_value": {
                        "display": "MITRE ATT&CK",
                        "itemValue": "MITRE ATT&CK"
                      },
                      "operator": "eq"
                    }
                  ]
                }
              },
              "status": null,
              "top": "100",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/ea155646-3821-4542-9702-b246da430a8d",
              "uuid": "097cade9-ac05-45db-a810-0ef880d05235",
              "id": 510
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Get related incidents -> Create Users",
              "targetStep": "/api/3/workflow_steps/fba48af8-0a34-46b5-afc2-fc3f1f29bb81",
              "sourceStep": "/api/3/workflow_steps/75ba586e-7ee1-48ff-ab25-5559ab98fb19",
              "label": null,
              "isExecuted": false,
              "uuid": "fa2b4d6c-31ab-45f7-9950-848987fae2e6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get related incidents",
              "targetStep": "/api/3/workflow_steps/75ba586e-7ee1-48ff-ab25-5559ab98fb19",
              "sourceStep": "/api/3/workflow_steps/097cade9-ac05-45db-a810-0ef880d05235",
              "label": null,
              "isExecuted": false,
              "uuid": "207dd18d-ea79-4064-8bd1-41848801e727"
            }
          ],
          "priority": null,
          "uuid": "52acb96f-7dbf-40c5-bd14-a8955de5ddff",
          "recordTags": [],
          "id": 108,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214963,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215028,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Create and Link Alerts from Asset (Host-based)",
          "aliasName": null,
          "tag": "",
          "description": "Creates and links Alerts to an Asset",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "commandline",
            "userName",
            "technique",
            "processName",
            "MD5",
            "hostName",
            "sourceIP",
            "destinationIP",
            "sourceTool",
            "parentProcess",
            "eventTime",
            "parentProcessID",
            "processID",
            "parentCommandLine",
            "filePath",
            "eventName",
            "description",
            "assetIRI",
            "epochTime",
            "comment",
            "sourceImage",
            "targetImage",
            "source",
            "processGUID",
            "scheduledTask",
            "service",
            "alertName",
            "mitreTechId"
          ],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/45837bce-3b50-4797-aa1d-642331b98f2b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/a03bc8a7-0c90-4762-91cb-946aa7a7821c",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert",
              "description": null,
              "arguments": {
                "resource": {
                  "name": "{% if vars.input.params.alertName%}{{vars.input.params.alertName}}{% else %}MITRE-{{vars.input.params.technique}} Execution of {{vars.input.params.processName}}{% endif %}",
                  "type": {
                    "id": 7343,
                    "@id": "/api/3/picklists/ab6d7fd7-7b16-4ac2-9cf2-b52a912baee8",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "MITRE ATT&CK",
                    "listName": "/api/3/picklist_names/a7087b9c-5660-495f-a8ac-c3b198ddb8c2",
                    "itemValue": "MITRE ATT&CK",
                    "orderIndex": 14
                  },
                  "state": {
                    "id": 220,
                    "@id": "/api/3/picklists/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "New",
                    "listName": "/api/3/picklist_names/2f9ed741-25fe-475a-9f12-64336288eebf",
                    "itemValue": "New",
                    "orderIndex": 0
                  },
                  "assets": "{% if vars.input.params.assetIRI %} [\"{{vars.input.params.assetIRI}}\"] {% else %} [] {% endif %}",
                  "source": "{{vars.input.params.source}}",
                  "status": {
                    "id": 45,
                    "@id": "/api/3/picklists/7de816ff-7140-4ee5-bd05-93ce22002146",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Open",
                    "listName": "/api/3/picklist_names/33e964a9-d607-49f2-813c-7ce46141815a",
                    "itemValue": "Open",
                    "orderIndex": 1
                  },
                  "filePath": "{{vars.input.params.filePath}}",
                  "services": "{{vars.input.params.service}}",
                  "userName": "{{vars.input.params.userName}}",
                  "__replace": "true",
                  "epochTime": "{{vars.input.params.epochTime}}",
                  "fileNames": "{{vars.input.params.processName}}",
                  "sourceTool": "{{vars.input.params.sourceTool}}",
                  "sourcedata": "{{vars.input.params.sourceData | toJSON}}",
                  "description": "<p>{{vars.input.params.description}}</p>",
                  "processName": "{{vars.input.params.processName}}",
                  "targetAsset": "{{vars.input.params.hostName}}",
                  "ackSlaStatus": {
                    "id": 289,
                    "@id": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "Awaiting Action",
                    "listName": "/api/3/picklist_names/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                    "itemValue": "Awaiting Action",
                    "orderIndex": 2
                  },
                  "computerName": "{{vars.input.params.hostName}}",
                  "respSlaStatus": {
                    "id": 289,
                    "@id": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "Awaiting Action",
                    "listName": "/api/3/picklist_names/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                    "itemValue": "Awaiting Action",
                    "orderIndex": 2
                  },
                  "sourceProcess": "{{vars.input.params.sourceImage}}",
                  "targetProcess": "{{vars.input.params.targetImage}}",
                  "mitreTechnique": "{{vars.input.params.technique}}",
                  "parentProcessName": "{{vars.input.params.parentProcess}}",
                  "escalatedtoincident": {
                    "id": 32,
                    "@id": "/api/3/picklists/2128a09c-153d-4db3-985d-de6be33deae5",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "No",
                    "listName": "/api/3/picklist_names/e131cc54-9ae4-43c9-b830-af6e331fe024",
                    "itemValue": "No",
                    "orderIndex": 1
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/alerts",
                "tagsOperation": "OverwriteTags",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "340",
              "left": "546",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "142e6dcf-e2c4-476a-b77e-82a1bd58b686",
              "id": 511
            },
            {
              "@type": "WorkflowStep",
              "name": "Do Alerts Already Exist",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes",
                    "step_iri": "/api/3/workflow_steps/d2938d6a-efec-495d-a305-76ca7c19a6f5",
                    "condition": "{{ vars.resultRecordscount != 0 }}"
                  },
                  {
                    "option": "No",
                    "step_iri": "/api/3/workflow_steps/142e6dcf-e2c4-476a-b77e-82a1bd58b686",
                    "condition": "{{ vars.resultRecordscount == 0 }}"
                  }
                ]
              },
              "status": null,
              "top": "107",
              "left": "320",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "d1e0e7a1-20fd-4180-aeca-ff79acd44987",
              "id": 512
            },
            {
              "@type": "WorkflowStep",
              "name": "Retrieve Existing Alerts",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "epochTime",
                      "value": "{{vars.input.params.epochTime}}",
                      "operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "mitreTechnique",
                      "value": "{{vars.input.params.technique}}",
                      "operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "processid",
                      "value": "{{vars.input.params.processID}}",
                      "operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "computerName",
                      "value": "{{vars.input.params.hostName}}",
                      "operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "processGUID",
                      "value": "{{vars.input.params.processGUID}}",
                      "operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "services",
                      "value": "{{vars.input.params.service}}",
                      "operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "scheduledTasks",
                      "value": "{{vars.input.params.scheduledTask}}",
                      "operator": "eq"
                    }
                  ]
                },
                "module": "alerts?$limit=300",
                "step_variables": {
                  "resultRecordscount": "{{vars.result | length}}"
                }
              },
              "status": null,
              "top": "107",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "2c21acb8-23a2-4f64-b818-7c3669f441bf",
              "id": 513
            },
            {
              "@type": "WorkflowStep",
              "name": "Retrieve Existing Open Alerts",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "epochTime",
                      "value": "{{vars.input.params.epochTime}}",
                      "operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "mitreTechnique",
                      "value": "{{vars.input.params.technique}}",
                      "operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "processid",
                      "value": "{{vars.input.params.processID}}",
                      "operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "computerName",
                      "value": "{{vars.input.params.hostName}}",
                      "operator": "eq"
                    },
                    {
                      "logic": "OR",
                      "filters": [
                        {
                          "type": "object",
                          "field": "status",
                          "value": "/api/3/picklists/7de816ff-7140-4ee5-bd05-93ce22002146",
                          "_value": {
                            "itemValue": "Open"
                          },
                          "operator": "eq"
                        },
                        {
                          "type": "object",
                          "field": "status",
                          "value": "/api/3/picklists/891fb9d5-556c-44c6-9f7d-94a27dec732e",
                          "_value": {
                            "itemValue": "Re-Opened"
                          },
                          "operator": "eq"
                        }
                      ]
                    },
                    {
                      "type": "primitive",
                      "field": "processGUID",
                      "value": "{{vars.input.params.processGUID}}",
                      "operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "services",
                      "value": "{{vars.input.params.service}}",
                      "operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "scheduledTasks",
                      "value": "{{vars.input.params.scheduledTask}}",
                      "operator": "eq"
                    }
                  ]
                },
                "module": "alerts?$limit=30",
                "step_variables": {
                  "resultRecordscount2": "{{vars.result | length}}"
                }
              },
              "status": null,
              "top": "167",
              "left": "920",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "d2938d6a-efec-495d-a305-76ca7c19a6f5",
              "id": 514
            },
            {
              "@type": "WorkflowStep",
              "name": "Link Open Alerts to Asset",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Retrieve_Existing_Open_Alerts}}",
                  "condition": ""
                },
                "resource": {
                  "__link": {
                    "assets": "{% if vars.input.params.assetIRI %} [\"{{vars.input.params.assetIRI}}\"] {% else %} [] {% endif %}"
                  }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.item['@id']}}",
                "collectionType": "/api/3/alerts",
                "step_variables": []
              },
              "status": null,
              "top": "500",
              "left": "920",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "65c85f1c-c0e9-4767-a353-f4772606aa30",
              "id": 515
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": {
                      "MD5": "{{ vars.MD5 }}",
                      "source": "{{ vars.source }}",
                      "comment": "{{ vars.comment }}",
                      "huntIRI": "{{ vars.huntIRI }}",
                      "service": "{{ vars.service }}",
                      "assetIRI": "{{ vars.assetIRI }}",
                      "filePath": "{{ vars.filePath }}",
                      "hostName": "{{ vars.hostName }}",
                      "sourceIP": "{{ vars.sourceIP }}",
                      "userName": "{{ vars.userName }}",
                      "alertName": "{{ vars.alertName }}",
                      "epochTime": "{{ vars.epochTime }}",
                      "eventName": "{{ vars.eventName }}",
                      "eventTime": "{{ vars.eventTime }}",
                      "processID": "{{ vars.processID }}",
                      "technique": "{{ vars.technique }}",
                      "sourceTool": "{{ vars.sourceTool }}",
                      "commandline": "{{ vars.commandline }}",
                      "description": "{{ vars.description }}",
                      "mitreTechId": "{{ vars.mitreTechId }}",
                      "processGUID": "{{ vars.processGUID }}",
                      "processName": "{{ vars.processName }}",
                      "sourceImage": "{{ vars.sourceImage }}",
                      "targetImage": "{{ vars.targetImage }}",
                      "destinationIP": "{{ vars.destinationIP }}",
                      "parentProcess": "{{ vars.parentProcess }}",
                      "scheduledTask": "{{ vars.scheduledTask }}",
                      "parentProcessID": "{{ vars.parentProcessID }}",
                      "parentCommandLine": "{{ vars.parentCommandLine }}"
                    }
                  }
                }
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "a03bc8a7-0c90-4762-91cb-946aa7a7821c",
              "id": 516
            },
            {
              "@type": "WorkflowStep",
              "name": "No New Alerts Needed",
              "description": null,
              "arguments": {
                "params": [],
                "version": "2.1.3",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "340",
              "left": "1260",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "47f5b16a-e38f-407a-a358-6a6db545b0e5",
              "id": 517
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Comment to Asset",
              "description": null,
              "arguments": {
                "resource": {
                  "hunt": "",
                  "scans": null,
                  "tasks": null,
                  "alerts": "['{{vars.steps.Create_and_Link_Alert['@id']}}']",
                  "assets": "{% if vars.input.params.assetIRI %} ['{{vars.input.params.assetIRI}}'] {% else %} [] {% endif %}",
                  "emails": null,
                  "events": null,
                  "owners": null,
                  "people": null,
                  "content": "<p>{{vars.input.params.comment}}</p>",
                  "schedule": null,
                  "approvals": null,
                  "companies": null,
                  "incidents": null,
                  "indicators": null,
                  "attachments": null,
                  "vulnerabilities": null
                },
                "_showJson": false,
                "collection": "/api/3/comments",
                "step_variables": []
              },
              "status": null,
              "top": "473",
              "left": "546",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "ff2abc47-5ad6-4b34-af90-616fb01769eb",
              "id": 518
            },
            {
              "@type": "WorkflowStep",
              "name": "Are Any Alerts Still Open",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes",
                    "step_iri": "/api/3/workflow_steps/65c85f1c-c0e9-4767-a353-f4772606aa30",
                    "condition": "{{ vars.resultRecordscount2 != 0 }}"
                  },
                  {
                    "option": "No",
                    "step_iri": "/api/3/workflow_steps/47f5b16a-e38f-407a-a358-6a6db545b0e5",
                    "condition": "{{ vars.resultRecordscount2 == 0 }}"
                  }
                ]
              },
              "status": null,
              "top": "340",
              "left": "920",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "7c8bf9f3-cedd-4632-8b35-4a01bdd14eea",
              "id": 519
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Comments to Asset",
              "description": null,
              "arguments": {
                "resource": {
                  "hunt": "",
                  "scans": null,
                  "tasks": null,
                  "alerts": null,
                  "assets": "{% if vars.input.params.assetIRI %} ['{{vars.input.params.assetIRI}}'] {% else %} [] {% endif %}",
                  "emails": null,
                  "events": null,
                  "owners": null,
                  "people": null,
                  "content": "<p>{{vars.input.params.comment}} Additionally, pre-existing related <a href=\"{{vars.request.baseUri}}{{ vars.steps.Retrieve_Existing_Open_Alerts[0]['@id'] | replace('/api/3','/modules/view-panel')}}\">Alert-{{vars.steps.Retrieve_Existing_Open_Alerts[0].id}}</a>&nbsp;with Status \"Open\" or \"Re-Opened\" was observed within CyOps. This Alert has now been linked to this Asset.</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>",
                  "schedule": null,
                  "approvals": null,
                  "companies": null,
                  "incidents": null,
                  "indicators": null,
                  "attachments": null,
                  "vulnerabilities": null
                },
                "_showJson": false,
                "collection": "/api/3/comments",
                "step_variables": []
              },
              "status": null,
              "top": "660",
              "left": "920",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "687103b3-3179-4229-84fc-16c681c86697",
              "id": 520
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Retrieve Existing Alerts",
              "targetStep": "/api/3/workflow_steps/2c21acb8-23a2-4f64-b818-7c3669f441bf",
              "sourceStep": "/api/3/workflow_steps/a03bc8a7-0c90-4762-91cb-946aa7a7821c",
              "label": null,
              "isExecuted": false,
              "uuid": "298c0996-172a-47c4-b4e7-b3a96c8af8e7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Do Alerts Already Exist -> Retrieve Existing Open Alerts",
              "targetStep": "/api/3/workflow_steps/d2938d6a-efec-495d-a305-76ca7c19a6f5",
              "sourceStep": "/api/3/workflow_steps/d1e0e7a1-20fd-4180-aeca-ff79acd44987",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "e58aa9f7-26f7-4f0e-9b5b-95a52eaf580a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Are Any Alerts Still Open -> Link Open Alerts to Hunt",
              "targetStep": "/api/3/workflow_steps/65c85f1c-c0e9-4767-a353-f4772606aa30",
              "sourceStep": "/api/3/workflow_steps/7c8bf9f3-cedd-4632-8b35-4a01bdd14eea",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "469c031b-57a4-47a7-9134-f4abe2d8b820"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert -> Create and Link Comment to Hunt",
              "targetStep": "/api/3/workflow_steps/ff2abc47-5ad6-4b34-af90-616fb01769eb",
              "sourceStep": "/api/3/workflow_steps/142e6dcf-e2c4-476a-b77e-82a1bd58b686",
              "label": null,
              "isExecuted": false,
              "uuid": "5a9d0b29-620d-4ebb-ac18-b15d05800031"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Retrieve Existing Open Alerts -> Are Any Alerts Still Open",
              "targetStep": "/api/3/workflow_steps/7c8bf9f3-cedd-4632-8b35-4a01bdd14eea",
              "sourceStep": "/api/3/workflow_steps/d2938d6a-efec-495d-a305-76ca7c19a6f5",
              "label": null,
              "isExecuted": false,
              "uuid": "40f2d41a-709b-46ed-bd57-3a75c1268eae"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Link Open Alerts to Hunt -> Create and Link Comments to Hunt",
              "targetStep": "/api/3/workflow_steps/687103b3-3179-4229-84fc-16c681c86697",
              "sourceStep": "/api/3/workflow_steps/65c85f1c-c0e9-4767-a353-f4772606aa30",
              "label": null,
              "isExecuted": false,
              "uuid": "896e75f3-cc19-42a6-9241-af2000ddd296"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Are Any Alerts Still Open -> No New Alerts Needed",
              "targetStep": "/api/3/workflow_steps/47f5b16a-e38f-407a-a358-6a6db545b0e5",
              "sourceStep": "/api/3/workflow_steps/7c8bf9f3-cedd-4632-8b35-4a01bdd14eea",
              "label": "No",
              "isExecuted": false,
              "uuid": "474e99ae-a990-4298-8c69-1c16b6d5a459"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Retrieve Existing Alerts -> Do Alerts Already Exist",
              "targetStep": "/api/3/workflow_steps/d1e0e7a1-20fd-4180-aeca-ff79acd44987",
              "sourceStep": "/api/3/workflow_steps/2c21acb8-23a2-4f64-b818-7c3669f441bf",
              "label": null,
              "isExecuted": false,
              "uuid": "50dc72e5-1d78-4b42-9827-ffc3252785f2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Do Alerts Already Exist -> Create and Link Alert",
              "targetStep": "/api/3/workflow_steps/142e6dcf-e2c4-476a-b77e-82a1bd58b686",
              "sourceStep": "/api/3/workflow_steps/d1e0e7a1-20fd-4180-aeca-ff79acd44987",
              "label": "No",
              "isExecuted": false,
              "uuid": "e5529ae0-9c3a-499c-a051-565247e73945"
            }
          ],
          "priority": null,
          "uuid": "5e4d1f4a-b109-40d3-9d36-4ff6de69b4ca",
          "recordTags": [],
          "id": 109,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214963,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215028,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Create and Link Indicator from Alert",
          "aliasName": null,
          "tag": null,
          "description": "Creates and links indicators when an Alert is created.",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/45837bce-3b50-4797-aa1d-642331b98f2b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/0ebece35-74cb-4bfb-b4af-04bd60ca728b",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Find Existing File Hash Indicators",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "value",
                      "value": "{{vars.input.records[0].filehash}}",
                      "operator": "eq"
                    }
                  ]
                },
                "module": "indicators?$limit=30",
                "step_variables": []
              },
              "status": null,
              "top": "20",
              "left": "680",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "cd56bab7-56af-4ddc-98db-0efe7b2fe66c",
              "id": 521
            },
            {
              "@type": "WorkflowStep",
              "name": "Does Alert have Hash",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "No",
                    "step_iri": "/api/3/workflow_steps/d891ce2f-c845-4497-8845-ac5efdb3b5a9",
                    "condition": "{{ not vars.input.records[0].filehash }}"
                  },
                  {
                    "option": "Yes",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/cd56bab7-56af-4ddc-98db-0efe7b2fe66c"
                  }
                ]
              },
              "status": null,
              "top": "60",
              "left": "320",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "d55282fb-08bb-4ac9-bb15-28ba54007064",
              "id": 522
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Linked Incidents",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "{{vars.input.records[0]['@id']}}?$relationships=true&$export=true",
                  "body": "",
                  "method": "GET"
                },
                "version": "2.4.0",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "f790ba64-541c-4329-847d-8038d2192652",
              "id": 523
            },
            {
              "@type": "WorkflowStep",
              "name": "Create New MD5 Indicator",
              "description": null,
              "arguments": {
                "resource": {
                  "tags": null,
                  "hunts": null,
                  "notes": null,
                  "value": "{{vars.input.records[0].filehash}}",
                  "alerts": "[\"{{vars.input.records[0]['@id']}}\"]",
                  "assets": null,
                  "emails": null,
                  "events": null,
                  "owners": null,
                  "persons": null,
                  "sources": null,
                  "comments": null,
                  "__replace": "true",
                  "campaigns": null,
                  "companies": null,
                  "evidences": null,
                  "incidents": "{% if vars.steps.Get_Linked_Incidents.data.incidents %}['{{vars.steps.Get_Linked_Incidents.data.incidents[0]}}']{% endif %}",
                  "recordTags": null,
                  "reputation": {
                    "id": 6435,
                    "@id": "/api/3/picklists/ae98ebc6-beef-4882-9980-1d88fc6d87cd",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#696969",
                    "display": "TBD",
                    "listName": "/api/3/picklist_names/e75ed3c3-9f23-4a43-832b-0daf236209ba",
                    "itemValue": "TBD",
                    "orderIndex": 3
                  },
                  "attachments": null,
                  "description": null,
                  "indicatorStatus": null,
                  "typeofindicator": {
                    "id": 4169,
                    "@id": "/api/3/picklists/0ca054f2-d923-4992-a4a7-c516e6df281e",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#0d0000",
                    "display": "FileHash-MD5",
                    "listName": "/api/3/picklist_names/50ee5bfa-e18f-49ba-8af9-dcca25b0f9c0",
                    "itemValue": "FileHash-MD5",
                    "orderIndex": 3
                  },
                  "vulnerabilities": null,
                  "correlationGraph": null
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/indicators",
                "tagsOperation": "OverwriteTags",
                "step_variables": []
              },
              "status": null,
              "top": "86",
              "left": "1700",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "9aa0987e-3680-4740-8c96-e9f0fa2ab1d1",
              "id": 524
            },
            {
              "@type": "WorkflowStep",
              "name": "Source IP Private IPspace Check",
              "description": null,
              "arguments": {
                "params": {
                  "cidr": "192.168.0.0/16,10.0.0.0/8,172.16.0.0/12",
                  "ip_address": "{{vars.source_ip}}"
                },
                "version": "2.4.0",
                "connector": "cyops_utilities",
                "operation": "ip_cidr_check",
                "operationTitle": "Utils: Is IP in CIDR",
                "step_variables": []
              },
              "status": null,
              "top": "953",
              "left": "1480",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "30080919-9762-40c8-b0c9-47c7fdae4a4a",
              "id": 525
            },
            {
              "@type": "WorkflowStep",
              "name": "Was File Hash Indicator Found",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes",
                    "step_iri": "/api/3/workflow_steps/eef5701a-9a74-445b-973d-b935312af40d",
                    "condition": "{{ vars.steps.Find_Existing_File_Hash_Indicators | length > 0 }}"
                  },
                  {
                    "option": "No",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/051fa8cb-ee84-4617-9988-1cd72e7ee038"
                  }
                ]
              },
              "status": null,
              "top": "20",
              "left": "1000",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "4ff5e03d-54b7-4771-a675-43cc10a9c9b6",
              "id": 526
            },
            {
              "@type": "WorkflowStep",
              "name": "No IP Address",
              "description": null,
              "arguments": {
                "params": [],
                "version": "2.4.0",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "860",
              "left": "680",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "9cf743f8-22fe-46ab-8cda-6b86e32bccca",
              "id": 527
            },
            {
              "@type": "WorkflowStep",
              "name": "Find Existing IP Address Indicators",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "OR",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "value",
                      "value": "{{vars.input.records[0].sourceIP}}",
                      "operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "value",
                      "value": "{{vars.input.records[0].destinationIP}}",
                      "operator": "eq"
                    }
                  ]
                },
                "module": "indicators?$limit=30",
                "step_variables": []
              },
              "status": null,
              "top": "770",
              "left": "680",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "d2237a49-5bf4-4f10-91ff-36bc66b8a887",
              "id": 528
            },
            {
              "@type": "WorkflowStep",
              "name": "Create New URL Indicator",
              "description": null,
              "arguments": {
                "resource": {
                  "tags": null,
                  "hunts": null,
                  "notes": null,
                  "value": "{{vars.input.records[0].url}}",
                  "alerts": "[\"{{vars.input.records[0]['@id']}}\"]",
                  "assets": null,
                  "emails": null,
                  "events": null,
                  "owners": null,
                  "persons": null,
                  "sources": null,
                  "comments": null,
                  "__replace": "true",
                  "campaigns": null,
                  "companies": null,
                  "evidences": null,
                  "incidents": "{% if vars.steps.Get_Linked_Incidents.data.incidents %}['{{vars.steps.Get_Linked_Incidents.data.incidents[0]}}']{% endif %}",
                  "recordTags": null,
                  "reputation": {
                    "id": 6435,
                    "@id": "/api/3/picklists/ae98ebc6-beef-4882-9980-1d88fc6d87cd",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#696969",
                    "display": "TBD",
                    "listName": "/api/3/picklist_names/e75ed3c3-9f23-4a43-832b-0daf236209ba",
                    "itemValue": "TBD",
                    "orderIndex": 3
                  },
                  "attachments": null,
                  "description": null,
                  "indicatorStatus": null,
                  "typeofindicator": {
                    "id": 434,
                    "@id": "/api/3/picklists/353a37b4-3eeb-43ee-aac6-64806422cfec",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#0a0101",
                    "display": "URL",
                    "listName": "/api/3/picklist_names/50ee5bfa-e18f-49ba-8af9-dcca25b0f9c0",
                    "itemValue": "URL",
                    "orderIndex": 10
                  },
                  "vulnerabilities": null,
                  "correlationGraph": null
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/indicators",
                "tagsOperation": "OverwriteTags",
                "step_variables": []
              },
              "status": null,
              "top": "669",
              "left": "1340",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "dff6bfd4-9169-4710-a836-d4aaeeabc951",
              "id": 529
            },
            {
              "@type": "WorkflowStep",
              "name": "Create New SHA1 Indicator",
              "description": null,
              "arguments": {
                "resource": {
                  "tags": null,
                  "hunts": null,
                  "notes": null,
                  "value": "{{vars.input.records[0].filehash}}",
                  "alerts": "[\"{{vars.input.records[0]['@id']}}\"]",
                  "assets": null,
                  "emails": null,
                  "events": null,
                  "owners": null,
                  "persons": null,
                  "sources": null,
                  "comments": null,
                  "__replace": "true",
                  "campaigns": null,
                  "companies": null,
                  "evidences": null,
                  "incidents": "{% if vars.steps.Get_Linked_Incidents.data.incidents %}['{{vars.steps.Get_Linked_Incidents.data.incidents[0]}}']{% endif %}",
                  "recordTags": null,
                  "reputation": {
                    "id": 6435,
                    "@id": "/api/3/picklists/ae98ebc6-beef-4882-9980-1d88fc6d87cd",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#696969",
                    "display": "TBD",
                    "listName": "/api/3/picklist_names/e75ed3c3-9f23-4a43-832b-0daf236209ba",
                    "itemValue": "TBD",
                    "orderIndex": 3
                  },
                  "attachments": null,
                  "description": null,
                  "indicatorStatus": null,
                  "typeofindicator": {
                    "id": 6836,
                    "@id": "/api/3/picklists/143e40b0-e643-468d-b968-a542fc85f08d",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#0b0101",
                    "display": "FileHash-SHA1",
                    "listName": "/api/3/picklist_names/50ee5bfa-e18f-49ba-8af9-dcca25b0f9c0",
                    "itemValue": "FileHash-SHA1",
                    "orderIndex": 5
                  },
                  "vulnerabilities": null,
                  "correlationGraph": null
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/indicators",
                "tagsOperation": "OverwriteTags",
                "step_variables": []
              },
              "status": null,
              "top": "240",
              "left": "1700",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "4fd70f9b-4ff4-4891-82fb-d38cf977fd23",
              "id": 530
            },
            {
              "@type": "WorkflowStep",
              "name": "Is Source IP Private",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "No",
                    "step_iri": "/api/3/workflow_steps/bedeaf60-4a6d-4b4d-9a0f-2318793ffc25",
                    "condition": "{{ vars.steps.Source_IP_Private_IPspace_Check.data['matched_cidr_ip'] | length == 0 }}"
                  },
                  {
                    "option": "Yes",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/b93a861c-970d-406d-82e2-34ad29a78d8d"
                  }
                ]
              },
              "status": null,
              "top": "953",
              "left": "1820",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "fc160efb-5a3d-43d8-98e3-a85c84bb6bdf",
              "id": 531
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Existing URL Indicator",
              "description": null,
              "arguments": {
                "resource": {
                  "__link": {
                    "alerts": "[\"{{vars.input.records[0]['@id']}}\"]",
                    "incidents": "{% if vars.steps.Get_Linked_Incidents.data.incidents %}['{{vars.steps.Get_Linked_Incidents.data.incidents[0]}}']{% endif %}"
                  }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.steps.Find_Existing_URL_Indicators[0]['@id']}}",
                "collectionType": "/api/3/indicators",
                "step_variables": []
              },
              "status": null,
              "top": "580",
              "left": "1340",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "651f6ad8-9a92-46b2-91b6-5b0fb5507b2f",
              "id": 532
            },
            {
              "@type": "WorkflowStep",
              "name": "No Processname",
              "description": null,
              "arguments": {
                "params": [],
                "version": "2.4.0",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "411",
              "left": "680",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "c8703c95-10c0-410c-b162-de1764f8e212",
              "id": 533
            },
            {
              "@type": "WorkflowStep",
              "name": "Find Existing Processname Indicator",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "value",
                      "value": "{{vars.input.records[0].processName}}",
                      "operator": "eq"
                    }
                  ]
                },
                "module": "indicators?$limit=30",
                "step_variables": []
              },
              "status": null,
              "top": "290",
              "left": "680",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "5cfa7875-a3c6-4211-adf4-705087d5ba90",
              "id": 534
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Destination IP Address Indicator",
              "description": null,
              "arguments": {
                "resource": {
                  "tags": null,
                  "hunts": null,
                  "notes": null,
                  "value": "{{vars.input.records[0].destinationIP}}",
                  "alerts": "['{{vars.input.records[0]['@id']}}']",
                  "assets": null,
                  "emails": null,
                  "events": null,
                  "owners": null,
                  "persons": null,
                  "sources": null,
                  "comments": null,
                  "__replace": "true",
                  "campaigns": null,
                  "companies": null,
                  "evidences": null,
                  "incidents": "{% if vars.steps.Get_Linked_Incidents.data.incidents %}['{{vars.steps.Get_Linked_Incidents.data.incidents[0]}}']{% endif %}",
                  "recordTags": null,
                  "reputation": {
                    "id": 6435,
                    "@id": "/api/3/picklists/ae98ebc6-beef-4882-9980-1d88fc6d87cd",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#696969",
                    "display": "TBD",
                    "listName": "/api/3/picklist_names/e75ed3c3-9f23-4a43-832b-0daf236209ba",
                    "itemValue": "TBD",
                    "orderIndex": 3
                  },
                  "attachments": null,
                  "description": null,
                  "indicatorStatus": null,
                  "typeofindicator": {
                    "id": 433,
                    "@id": "/api/3/picklists/c0beeda4-2c7a-4214-b7e5-53ba1649539c",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#0b0101",
                    "display": "IP Address",
                    "listName": "/api/3/picklist_names/50ee5bfa-e18f-49ba-8af9-dcca25b0f9c0",
                    "itemValue": "IP Address",
                    "orderIndex": 7
                  },
                  "vulnerabilities": null,
                  "correlationGraph": null
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/indicators",
                "tagsOperation": "OverwriteTags",
                "step_variables": []
              },
              "status": null,
              "top": "1100",
              "left": "2130",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "d2eedee8-8f02-4492-8e34-66f4b0a1240a",
              "id": 535
            },
            {
              "@type": "WorkflowStep",
              "name": "Do Not Create Source IP Indicator",
              "description": null,
              "arguments": {
                "params": [],
                "version": "2.4.0",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "988",
              "left": "2130",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "b93a861c-970d-406d-82e2-34ad29a78d8d",
              "id": 536
            },
            {
              "@type": "WorkflowStep",
              "name": "Set File Hash IRI",
              "description": null,
              "arguments": {
                "file_hash_indicator": "{{vars.result['@id']}}"
              },
              "status": null,
              "top": "120",
              "left": "2060",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "be6be4a0-5d49-43bd-a3bd-4ebd5e8b854d",
              "id": 537
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Existing File Hash Indicator",
              "description": null,
              "arguments": {
                "resource": {
                  "__link": {
                    "alerts": "[\"{{vars.input.records[0]['@id']}}\"]",
                    "incidents": "{% if vars.steps.Get_Linked_Incidents.data.incidents %}['{{vars.steps.Get_Linked_Incidents.data.incidents[0]}}']{% endif %}"
                  }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.steps.Find_Existing_File_Hash_Indicators[0]['@id']}}",
                "collectionType": "/api/3/indicators",
                "step_variables": []
              },
              "status": null,
              "top": "9",
              "left": "1700",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "eef5701a-9a74-445b-973d-b935312af40d",
              "id": 538
            },
            {
              "@type": "WorkflowStep",
              "name": "Identify Type of Hash",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "MD5",
                    "step_iri": "/api/3/workflow_steps/9aa0987e-3680-4740-8c96-e9f0fa2ab1d1",
                    "condition": "{{ vars.input.records[0].filehash | length == 32 }}"
                  },
                  {
                    "option": "SHA256",
                    "step_iri": "/api/3/workflow_steps/130fd1b6-d216-430f-8f70-11f01cb68dd5",
                    "condition": "{{ vars.input.records[0].filehash | length == 64 }}"
                  },
                  {
                    "option": "SHA1",
                    "step_iri": "/api/3/workflow_steps/4fd70f9b-4ff4-4891-82fb-d38cf977fd23",
                    "condition": "{{ vars.input.records[0].filehash | length == 40 }}"
                  }
                ]
              },
              "status": null,
              "top": "100",
              "left": "1340",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "051fa8cb-ee84-4617-9988-1cd72e7ee038",
              "id": 539
            },
            {
              "@type": "WorkflowStep",
              "name": "Does Alert have Processname",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "No",
                    "step_iri": "/api/3/workflow_steps/c8703c95-10c0-410c-b162-de1764f8e212",
                    "condition": "{{ not vars.input.records[0].processName }}"
                  },
                  {
                    "option": "Yes",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/5cfa7875-a3c6-4211-adf4-705087d5ba90"
                  }
                ]
              },
              "status": null,
              "top": "300",
              "left": "320",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "5ac09604-09e7-4bbd-b302-0f903e62074e",
              "id": 540
            },
            {
              "@type": "WorkflowStep",
              "name": "Was IP Address Indicator Found",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes",
                    "step_iri": "/api/3/workflow_steps/74c9bf4a-fc54-4696-841c-9b24fbe52b08",
                    "condition": "{{ vars.steps.Find_Existing_IP_Address_Indicators | length > 0 }}"
                  },
                  {
                    "option": "No",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/47bf39f4-b83b-4847-9f83-e9b0d245b04d"
                  }
                ]
              },
              "status": null,
              "top": "770",
              "left": "1012",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "8aa8c063-ab3e-40f8-88dc-2e3d402379dc",
              "id": 541
            },
            {
              "@type": "WorkflowStep",
              "name": "Destination IP Private IPspace Check",
              "description": null,
              "arguments": {
                "params": {
                  "cidr": "192.168.0.0/16,10.0.0.0/8,172.16.0.0/12",
                  "ip_address": "{{vars.dest_ip}}"
                },
                "version": "2.4.0",
                "connector": "cyops_utilities",
                "operation": "ip_cidr_check",
                "operationTitle": "Utils: Is IP in CIDR",
                "step_variables": []
              },
              "status": null,
              "top": "1140",
              "left": "1471",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "ede2ba05-0136-4a88-a391-3ffa28e2ca74",
              "id": 542
            },
            {
              "@type": "WorkflowStep",
              "name": "Was Processname Indicator Found",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes",
                    "step_iri": "/api/3/workflow_steps/f725f916-d354-472e-b893-edbf96cd82aa",
                    "condition": "{{ vars.steps.Find_Existing_Processname_Indicator | length > 0 }}"
                  },
                  {
                    "option": "No",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/035aaf92-e651-43eb-a88e-e15866df2f64"
                  }
                ]
              },
              "status": null,
              "top": "340",
              "left": "1000",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "0cb3d4e6-9ffe-427e-a96c-d20da541fee0",
              "id": 543
            },
            {
              "@type": "WorkflowStep",
              "name": "Is Destination IP Private",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "No",
                    "step_iri": "/api/3/workflow_steps/d2eedee8-8f02-4492-8e34-66f4b0a1240a",
                    "condition": "{{ vars.steps.Destination_IP_Private_IPspace_Check.data['matched_cidr_ip'] | length == 0 }}"
                  },
                  {
                    "option": "Yes",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/3b11b2a9-372b-49d0-a411-b28466229b0a"
                  }
                ]
              },
              "status": null,
              "top": "1140",
              "left": "1820",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "c15d8e61-7fe9-45ab-9f9c-40ea3560ae7d",
              "id": 544
            },
            {
              "@type": "WorkflowStep",
              "name": "Was URL Indicator Found",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes",
                    "step_iri": "/api/3/workflow_steps/651f6ad8-9a92-46b2-91b6-5b0fb5507b2f",
                    "condition": "{{ vars.steps.Find_Existing_URL_Indicators | length > 0 }}"
                  },
                  {
                    "option": "No",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/dff6bfd4-9169-4710-a836-d4aaeeabc951"
                  }
                ]
              },
              "status": null,
              "top": "620",
              "left": "1014",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "98d71721-6bca-4a8c-b5bf-5ab4f3df054e",
              "id": 545
            },
            {
              "@type": "WorkflowStep",
              "name": "Does Alert have URL",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "No",
                    "step_iri": "/api/3/workflow_steps/530c4b1f-335e-4e27-93dd-c6eede5f9990",
                    "condition": "{{ not vars.input.records[0].url }}"
                  },
                  {
                    "option": "Yes",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/b427eaed-8cca-4a28-9ca1-508adcab1327"
                  }
                ]
              },
              "status": null,
              "top": "600",
              "left": "320",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "dc4fd9dd-f7f5-4691-8172-4da27a40e21c",
              "id": 546
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Process Name IRI",
              "description": null,
              "arguments": {
                "process_name_indicator": "{{vars.result[\"@id\"]}}"
              },
              "status": null,
              "top": "372",
              "left": "2060",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "57eef65a-580f-4c80-bc0f-32fc3c54d8c9",
              "id": 547
            },
            {
              "@type": "WorkflowStep",
              "name": "Create New Indicator Record for Processname",
              "description": null,
              "arguments": {
                "resource": {
                  "tags": null,
                  "hunts": null,
                  "notes": null,
                  "value": "{{vars.input.records[0].processName}}",
                  "alerts": "[\"{{vars.input.records[0]['@id']}}\"]",
                  "assets": null,
                  "emails": null,
                  "events": null,
                  "owners": null,
                  "persons": null,
                  "sources": null,
                  "comments": null,
                  "__replace": "true",
                  "campaigns": null,
                  "companies": null,
                  "evidences": null,
                  "incidents": "{% if vars.steps.Get_Linked_Incidents.data.incidents %}['{{vars.steps.Get_Linked_Incidents.data.incidents[0]}}']{% endif %}",
                  "recordTags": null,
                  "reputation": {
                    "id": 6435,
                    "@id": "/api/3/picklists/ae98ebc6-beef-4882-9980-1d88fc6d87cd",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#696969",
                    "display": "TBD",
                    "listName": "/api/3/picklist_names/e75ed3c3-9f23-4a43-832b-0daf236209ba",
                    "itemValue": "TBD",
                    "orderIndex": 3
                  },
                  "attachments": null,
                  "description": null,
                  "indicatorStatus": null,
                  "typeofindicator": {
                    "id": 460,
                    "@id": "/api/3/picklists/0162241b-f5bf-4917-a150-00e920be47bd",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#030000",
                    "display": "File",
                    "listName": "/api/3/picklist_names/50ee5bfa-e18f-49ba-8af9-dcca25b0f9c0",
                    "itemValue": "File",
                    "orderIndex": 2
                  },
                  "vulnerabilities": null,
                  "correlationGraph": null
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/indicators",
                "tagsOperation": "OverwriteTags",
                "step_variables": []
              },
              "status": null,
              "top": "420",
              "left": "1340",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "035aaf92-e651-43eb-a88e-e15866df2f64",
              "id": 548
            },
            {
              "@type": "WorkflowStep",
              "name": "No File Hash",
              "description": null,
              "arguments": {
                "params": [],
                "version": "2.4.0",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "120",
              "left": "680",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "d891ce2f-c845-4497-8845-ac5efdb3b5a9",
              "id": 549
            },
            {
              "@type": "WorkflowStep",
              "name": "Create New SHA256 Indicator",
              "description": null,
              "arguments": {
                "resource": {
                  "tags": null,
                  "hunts": null,
                  "notes": null,
                  "value": "{{vars.input.records[0].filehash}}",
                  "alerts": "[\"{{vars.input.records[0]['@id']}}\"]",
                  "assets": null,
                  "emails": null,
                  "events": null,
                  "owners": null,
                  "persons": null,
                  "sources": null,
                  "comments": null,
                  "__replace": "true",
                  "campaigns": null,
                  "companies": null,
                  "evidences": null,
                  "incidents": "{% if vars.steps.Get_Linked_Incidents.data.incidents %}['{{vars.steps.Get_Linked_Incidents.data.incidents[0]}}']{% endif %}",
                  "recordTags": null,
                  "reputation": {
                    "id": 6435,
                    "@id": "/api/3/picklists/ae98ebc6-beef-4882-9980-1d88fc6d87cd",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#696969",
                    "display": "TBD",
                    "listName": "/api/3/picklist_names/e75ed3c3-9f23-4a43-832b-0daf236209ba",
                    "itemValue": "TBD",
                    "orderIndex": 3
                  },
                  "attachments": null,
                  "description": null,
                  "indicatorStatus": null,
                  "typeofindicator": {
                    "id": 6835,
                    "@id": "/api/3/picklists/4ea7b083-a0af-41ea-8d7c-7ace16021722",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#0b0000",
                    "display": "FileHash-SHA256",
                    "listName": "/api/3/picklist_names/50ee5bfa-e18f-49ba-8af9-dcca25b0f9c0",
                    "itemValue": "FileHash-SHA256",
                    "orderIndex": 4
                  },
                  "vulnerabilities": null,
                  "correlationGraph": null
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/indicators",
                "tagsOperation": "OverwriteTags",
                "step_variables": []
              },
              "status": null,
              "top": "160",
              "left": "1700",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "130fd1b6-d216-430f-8f70-11f01cb68dd5",
              "id": 550
            },
            {
              "@type": "WorkflowStep",
              "name": "Find Existing URL Indicators",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "value",
                      "value": "{{vars.input.records[0].url}}",
                      "operator": "eq"
                    }
                  ]
                },
                "module": "indicators?$limit=30",
                "step_variables": []
              },
              "status": null,
              "top": "580",
              "left": "680",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "b427eaed-8cca-4a28-9ca1-508adcab1327",
              "id": 551
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Source IP Address Indicator",
              "description": null,
              "arguments": {
                "resource": {
                  "tags": null,
                  "hunts": null,
                  "notes": null,
                  "value": "{{vars.input.records[0].sourceIP}}",
                  "alerts": "['{{vars.input.records[0]['@id']}}']",
                  "assets": null,
                  "emails": null,
                  "events": null,
                  "owners": null,
                  "persons": null,
                  "sources": null,
                  "comments": null,
                  "__replace": "true",
                  "campaigns": null,
                  "companies": null,
                  "evidences": null,
                  "incidents": "{% if vars.steps.Get_Linked_Incidents.data.incidents %}['{{vars.steps.Get_Linked_Incidents.data.incidents[0]}}']{% endif %}",
                  "recordTags": null,
                  "reputation": {
                    "id": 6435,
                    "@id": "/api/3/picklists/ae98ebc6-beef-4882-9980-1d88fc6d87cd",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#696969",
                    "display": "TBD",
                    "listName": "/api/3/picklist_names/e75ed3c3-9f23-4a43-832b-0daf236209ba",
                    "itemValue": "TBD",
                    "orderIndex": 3
                  },
                  "attachments": null,
                  "description": null,
                  "indicatorStatus": null,
                  "typeofindicator": {
                    "id": 433,
                    "@id": "/api/3/picklists/c0beeda4-2c7a-4214-b7e5-53ba1649539c",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#0b0101",
                    "display": "IP Address",
                    "listName": "/api/3/picklist_names/50ee5bfa-e18f-49ba-8af9-dcca25b0f9c0",
                    "itemValue": "IP Address",
                    "orderIndex": 7
                  },
                  "vulnerabilities": null,
                  "correlationGraph": null
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/indicators",
                "tagsOperation": "OverwriteTags",
                "step_variables": []
              },
              "status": null,
              "top": "900",
              "left": "2126",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "bedeaf60-4a6d-4b4d-9a0f-2318793ffc25",
              "id": 552
            },
            {
              "@type": "WorkflowStep",
              "name": "Set IP variables",
              "description": null,
              "arguments": {
                "dest_ip": "{{vars.input.records[0].destinationIP}}",
                "source_ip": "{{vars.input.records[0].sourceIP}}"
              },
              "status": null,
              "top": "1048",
              "left": "1160",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "47bf39f4-b83b-4847-9f83-e9b0d245b04d",
              "id": 553
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Existing IP Address Indicator",
              "description": null,
              "arguments": {
                "resource": {
                  "__link": {
                    "alerts": "['{{vars.input.records[0]['@id']}}']",
                    "incidents": "{% if vars.steps.Get_Linked_Incidents.data.incidents %}['{{vars.steps.Get_Linked_Incidents.data.incidents[0]}}']{% endif %}"
                  }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.steps.Find_Existing_IP_Address_Indicators[0]['@id']}}",
                "collectionType": "/api/3/indicators",
                "step_variables": []
              },
              "status": null,
              "top": "760",
              "left": "1340",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "74c9bf4a-fc54-4696-841c-9b24fbe52b08",
              "id": 554
            },
            {
              "@type": "WorkflowStep",
              "name": "Does Alert have IP Address",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "No",
                    "step_iri": "/api/3/workflow_steps/9cf743f8-22fe-46ab-8cda-6b86e32bccca",
                    "condition": "{{ not vars.input.records[0].sourceIP and not vars.input.records[0].destinationIP }}"
                  },
                  {
                    "option": "Yes",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/d2237a49-5bf4-4f10-91ff-36bc66b8a887"
                  }
                ]
              },
              "status": null,
              "top": "780",
              "left": "320",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "fd22ae84-5f55-4698-8353-cc93fd0cd06a",
              "id": 555
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Existing Processname Indicator",
              "description": null,
              "arguments": {
                "resource": {
                  "__link": {
                    "alerts": "[\"{{vars.input.records[0]['@id']}}\"]",
                    "incidents": "{% if vars.steps.Get_Linked_Incidents.data.incidents %}['{{vars.steps.Get_Linked_Incidents.data.incidents[0]}}']{% endif %}"
                  }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.steps.Find_Existing_Processname_Indicator[0]['@id']}}",
                "collectionType": "/api/3/indicators",
                "step_variables": []
              },
              "status": null,
              "top": "330",
              "left": "1340",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "f725f916-d354-472e-b893-edbf96cd82aa",
              "id": 556
            },
            {
              "@type": "WorkflowStep",
              "name": "Do Not Create Destination IP Indicator",
              "description": null,
              "arguments": {
                "params": [],
                "version": "2.4.0",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "1200",
              "left": "2132",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "3b11b2a9-372b-49d0-a411-b28466229b0a",
              "id": 557
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "resource": "alerts",
                "resources": [
                  "alerts"
                ],
                "step_variables": {
                  "input": {
                    "records": [
                      "{{vars.input.records[0]}}"
                    ]
                  }
                },
                "fieldbasedtrigger": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "object",
                      "field": "type",
                      "value": "/api/3/picklists/ab6d7fd7-7b16-4ac2-9cf2-b52a912baee8",
                      "_value": {
                        "display": "MITRE ATT&CK",
                        "itemValue": "MITRE ATT&CK"
                      },
                      "operator": "eq"
                    }
                  ]
                }
              },
              "status": null,
              "top": "51",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/ea155646-3821-4542-9702-b246da430a8d",
              "uuid": "0ebece35-74cb-4bfb-b4af-04bd60ca728b",
              "id": 558
            },
            {
              "@type": "WorkflowStep",
              "name": "Correlate File Hash and Process Name Indicators",
              "description": null,
              "arguments": {
                "resource": {
                  "description": "<p>{{vars.file_hash_indicator}}</p>"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.process_name_indicator}}",
                "collectionType": "/api/3/indicators",
                "step_variables": []
              },
              "status": null,
              "top": "240",
              "left": "2412",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "4808c725-31b9-45e7-bd48-09914b02d212",
              "id": 559
            },
            {
              "@type": "WorkflowStep",
              "name": "No URL",
              "description": null,
              "arguments": {
                "params": [],
                "version": "2.4.0",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "660",
              "left": "680",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "530c4b1f-335e-4e27-93dd-c6eede5f9990",
              "id": 560
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Identify Type of Hash -> Create New SHA256 Indicator",
              "targetStep": "/api/3/workflow_steps/130fd1b6-d216-430f-8f70-11f01cb68dd5",
              "sourceStep": "/api/3/workflow_steps/051fa8cb-ee84-4617-9988-1cd72e7ee038",
              "label": "SHA256",
              "isExecuted": false,
              "uuid": "aa07f075-557f-46f5-9344-da9a7321546f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Linked Incidents -> Does Alert have Hash",
              "targetStep": "/api/3/workflow_steps/d55282fb-08bb-4ac9-bb15-28ba54007064",
              "sourceStep": "/api/3/workflow_steps/f790ba64-541c-4329-847d-8038d2192652",
              "label": null,
              "isExecuted": false,
              "uuid": "e0a9b727-daa2-407a-adb6-5c84a23dcba7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Find Existing Processname Indicator -> Was Processname Indicator Found",
              "targetStep": "/api/3/workflow_steps/0cb3d4e6-9ffe-427e-a96c-d20da541fee0",
              "sourceStep": "/api/3/workflow_steps/5cfa7875-a3c6-4211-adf4-705087d5ba90",
              "label": null,
              "isExecuted": false,
              "uuid": "35953ca9-d700-4fe0-9b2f-a65d09848e07"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Does Alert have IP Address -> Find Existing IP Address Indicators",
              "targetStep": "/api/3/workflow_steps/d2237a49-5bf4-4f10-91ff-36bc66b8a887",
              "sourceStep": "/api/3/workflow_steps/fd22ae84-5f55-4698-8353-cc93fd0cd06a",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "f4d31aba-41be-49a9-b4da-84eb5e8c5f21"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Was File Hash Indicator Found -> Update Existing File Hash Indicator",
              "targetStep": "/api/3/workflow_steps/eef5701a-9a74-445b-973d-b935312af40d",
              "sourceStep": "/api/3/workflow_steps/4ff5e03d-54b7-4771-a675-43cc10a9c9b6",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "d383e13c-26d5-40eb-b558-c5dc3bc17766"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Linked Incidents -> Does Alert have URL",
              "targetStep": "/api/3/workflow_steps/dc4fd9dd-f7f5-4691-8172-4da27a40e21c",
              "sourceStep": "/api/3/workflow_steps/f790ba64-541c-4329-847d-8038d2192652",
              "label": null,
              "isExecuted": false,
              "uuid": "8b65b935-51ff-4b32-95f6-a494cec11709"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Linked Incidents",
              "targetStep": "/api/3/workflow_steps/f790ba64-541c-4329-847d-8038d2192652",
              "sourceStep": "/api/3/workflow_steps/0ebece35-74cb-4bfb-b4af-04bd60ca728b",
              "label": null,
              "isExecuted": false,
              "uuid": "9162deef-2e71-4401-959c-75c84c22ea9f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Was URL Indicator Found -> Updating Existing URL Indicator",
              "targetStep": "/api/3/workflow_steps/651f6ad8-9a92-46b2-91b6-5b0fb5507b2f",
              "sourceStep": "/api/3/workflow_steps/98d71721-6bca-4a8c-b5bf-5ab4f3df054e",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "80559989-8839-4b03-9dac-21bc18bfbc6b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Linked Incidents -> Does Alert have Processname",
              "targetStep": "/api/3/workflow_steps/5ac09604-09e7-4bbd-b302-0f903e62074e",
              "sourceStep": "/api/3/workflow_steps/f790ba64-541c-4329-847d-8038d2192652",
              "label": null,
              "isExecuted": false,
              "uuid": "fea6b01a-a8ec-495b-a107-f3c0fc508791"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Was IP Address Indicator Found -> Set IP variables",
              "targetStep": "/api/3/workflow_steps/47bf39f4-b83b-4847-9f83-e9b0d245b04d",
              "sourceStep": "/api/3/workflow_steps/8aa8c063-ab3e-40f8-88dc-2e3d402379dc",
              "label": "No",
              "isExecuted": false,
              "uuid": "3e88e862-2d7c-4050-89ce-165113a8f36c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Find Existing URL Indicators -> Was URL",
              "targetStep": "/api/3/workflow_steps/98d71721-6bca-4a8c-b5bf-5ab4f3df054e",
              "sourceStep": "/api/3/workflow_steps/b427eaed-8cca-4a28-9ca1-508adcab1327",
              "label": null,
              "isExecuted": false,
              "uuid": "de3c987f-b5dc-4706-841b-87f508169283"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Does Alert have Processname -> Find Existing Processname Indicator",
              "targetStep": "/api/3/workflow_steps/5cfa7875-a3c6-4211-adf4-705087d5ba90",
              "sourceStep": "/api/3/workflow_steps/5ac09604-09e7-4bbd-b302-0f903e62074e",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "99445d12-785d-4289-946c-761a51fca8df"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Process Name IRI -> Correlate File Hash and Process Name Indicators",
              "targetStep": "/api/3/workflow_steps/4808c725-31b9-45e7-bd48-09914b02d212",
              "sourceStep": "/api/3/workflow_steps/57eef65a-580f-4c80-bc0f-32fc3c54d8c9",
              "label": null,
              "isExecuted": false,
              "uuid": "79fbb75d-4a6f-49a5-91e5-5115866e8b15"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create New SHA256 Indicator -> Set Process Name IRI",
              "targetStep": "/api/3/workflow_steps/be6be4a0-5d49-43bd-a3bd-4ebd5e8b854d",
              "sourceStep": "/api/3/workflow_steps/130fd1b6-d216-430f-8f70-11f01cb68dd5",
              "label": null,
              "isExecuted": false,
              "uuid": "f008949a-a657-46d3-8451-acbc1a16b2bd"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Destination IP Private -> Copy  of Create IP Address Indicator",
              "targetStep": "/api/3/workflow_steps/d2eedee8-8f02-4492-8e34-66f4b0a1240a",
              "sourceStep": "/api/3/workflow_steps/c15d8e61-7fe9-45ab-9f9c-40ea3560ae7d",
              "label": "No",
              "isExecuted": false,
              "uuid": "58b7afc3-2915-4512-82cd-a9e0ab92dc3b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Source IP Private -> Do Not Create Source IP Indicator",
              "targetStep": "/api/3/workflow_steps/b93a861c-970d-406d-82e2-34ad29a78d8d",
              "sourceStep": "/api/3/workflow_steps/fc160efb-5a3d-43d8-98e3-a85c84bb6bdf",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "4b781abb-b999-4da1-b21f-f30a77cf2484"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create New SHA1 Indicator -> Set Process Name IRI",
              "targetStep": "/api/3/workflow_steps/be6be4a0-5d49-43bd-a3bd-4ebd5e8b854d",
              "sourceStep": "/api/3/workflow_steps/4fd70f9b-4ff4-4891-82fb-d38cf977fd23",
              "label": null,
              "isExecuted": false,
              "uuid": "ff109d70-2d78-432f-8d4b-553fabaccefd"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Does Alert have Hash -> No File Hash",
              "targetStep": "/api/3/workflow_steps/d891ce2f-c845-4497-8845-ac5efdb3b5a9",
              "sourceStep": "/api/3/workflow_steps/d55282fb-08bb-4ac9-bb15-28ba54007064",
              "label": "No",
              "isExecuted": false,
              "uuid": "92c766e0-8905-48d1-ba55-b6a921ddd413"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Was File Hash Indicator Found -> Identify Type of Hash",
              "targetStep": "/api/3/workflow_steps/051fa8cb-ee84-4617-9988-1cd72e7ee038",
              "sourceStep": "/api/3/workflow_steps/4ff5e03d-54b7-4771-a675-43cc10a9c9b6",
              "label": "No",
              "isExecuted": false,
              "uuid": "0355c9c9-3c3b-4b45-9bf3-acf0c9d8eb4c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create New Indicator Record for Processname -> Set Process Name IRI",
              "targetStep": "/api/3/workflow_steps/57eef65a-580f-4c80-bc0f-32fc3c54d8c9",
              "sourceStep": "/api/3/workflow_steps/035aaf92-e651-43eb-a88e-e15866df2f64",
              "label": null,
              "isExecuted": false,
              "uuid": "1340b7cc-3f61-4e9a-a18a-aecfd0f56f57"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Destination IP Private -> Copy  of Do Not Create Source IP Indicator",
              "targetStep": "/api/3/workflow_steps/3b11b2a9-372b-49d0-a411-b28466229b0a",
              "sourceStep": "/api/3/workflow_steps/c15d8e61-7fe9-45ab-9f9c-40ea3560ae7d",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "cb2edbf7-21b8-45c6-9343-7ef98b772344"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Update Existing Processname Indicator -> Set Process Name IRI",
              "targetStep": "/api/3/workflow_steps/57eef65a-580f-4c80-bc0f-32fc3c54d8c9",
              "sourceStep": "/api/3/workflow_steps/f725f916-d354-472e-b893-edbf96cd82aa",
              "label": null,
              "isExecuted": false,
              "uuid": "024c9604-c8fd-45f8-8632-7c0071a0901d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Destination IP Private IPspace Check -> Copy  of Is Source IP Private",
              "targetStep": "/api/3/workflow_steps/c15d8e61-7fe9-45ab-9f9c-40ea3560ae7d",
              "sourceStep": "/api/3/workflow_steps/ede2ba05-0136-4a88-a391-3ffa28e2ca74",
              "label": null,
              "isExecuted": false,
              "uuid": "6eb9c419-ea4d-4d01-b172-ba9f7d9bc9e7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Was URL Indicator Found -> Create New URL Indicator",
              "targetStep": "/api/3/workflow_steps/dff6bfd4-9169-4710-a836-d4aaeeabc951",
              "sourceStep": "/api/3/workflow_steps/98d71721-6bca-4a8c-b5bf-5ab4f3df054e",
              "label": "No",
              "isExecuted": false,
              "uuid": "9ac4069e-8767-40f8-817f-f51abc1113e8"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Was Processname Indicator Found -> Update Existing Processname Indicator",
              "targetStep": "/api/3/workflow_steps/f725f916-d354-472e-b893-edbf96cd82aa",
              "sourceStep": "/api/3/workflow_steps/0cb3d4e6-9ffe-427e-a96c-d20da541fee0",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "b2518d48-c718-42fe-8374-40e0a4d2afbe"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Linked Incidents -> Does Alert have IP Address",
              "targetStep": "/api/3/workflow_steps/fd22ae84-5f55-4698-8353-cc93fd0cd06a",
              "sourceStep": "/api/3/workflow_steps/f790ba64-541c-4329-847d-8038d2192652",
              "label": null,
              "isExecuted": false,
              "uuid": "18d95023-1d89-47d0-b77d-d522d5c315e4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Does Alert have URL -> Find Existing URL Indicators",
              "targetStep": "/api/3/workflow_steps/b427eaed-8cca-4a28-9ca1-508adcab1327",
              "sourceStep": "/api/3/workflow_steps/dc4fd9dd-f7f5-4691-8172-4da27a40e21c",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "cdbf2cbb-27d3-466e-bf81-69cfd4e9d7ea"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Find Existing IP Address Indicators -> Was IP Address Indicator Found",
              "targetStep": "/api/3/workflow_steps/8aa8c063-ab3e-40f8-88dc-2e3d402379dc",
              "sourceStep": "/api/3/workflow_steps/d2237a49-5bf4-4f10-91ff-36bc66b8a887",
              "label": null,
              "isExecuted": false,
              "uuid": "c485dc59-9714-4947-b715-610ca8c26e70"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Find Existing File Hash Indicators -> Was File Hash Indicator Found",
              "targetStep": "/api/3/workflow_steps/4ff5e03d-54b7-4771-a675-43cc10a9c9b6",
              "sourceStep": "/api/3/workflow_steps/cd56bab7-56af-4ddc-98db-0efe7b2fe66c",
              "label": null,
              "isExecuted": false,
              "uuid": "2f5a5e6a-6b19-4454-8fbd-f6f1d4333d54"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Does Alert have Processname -> No Processname",
              "targetStep": "/api/3/workflow_steps/c8703c95-10c0-410c-b162-de1764f8e212",
              "sourceStep": "/api/3/workflow_steps/5ac09604-09e7-4bbd-b302-0f903e62074e",
              "label": "No",
              "isExecuted": false,
              "uuid": "b6727c3a-5a03-43d7-a138-b741dc1ee636"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create New MD5 Indicator -> Set Process Name IRI",
              "targetStep": "/api/3/workflow_steps/be6be4a0-5d49-43bd-a3bd-4ebd5e8b854d",
              "sourceStep": "/api/3/workflow_steps/9aa0987e-3680-4740-8c96-e9f0fa2ab1d1",
              "label": null,
              "isExecuted": false,
              "uuid": "4864fae4-6efb-461e-826f-c14cb9647253"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Does Alert have URL -> No URL",
              "targetStep": "/api/3/workflow_steps/530c4b1f-335e-4e27-93dd-c6eede5f9990",
              "sourceStep": "/api/3/workflow_steps/dc4fd9dd-f7f5-4691-8172-4da27a40e21c",
              "label": "No",
              "isExecuted": false,
              "uuid": "17510649-c5c9-4207-b541-13423e60775e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Does Alert have Hash -> Find Existing File Hash Indicators",
              "targetStep": "/api/3/workflow_steps/cd56bab7-56af-4ddc-98db-0efe7b2fe66c",
              "sourceStep": "/api/3/workflow_steps/d55282fb-08bb-4ac9-bb15-28ba54007064",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "e4192101-9c91-4880-951b-798cc03d6b42"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Source IP Private -> Create IP Address Indicator",
              "targetStep": "/api/3/workflow_steps/bedeaf60-4a6d-4b4d-9a0f-2318793ffc25",
              "sourceStep": "/api/3/workflow_steps/fc160efb-5a3d-43d8-98e3-a85c84bb6bdf",
              "label": "No",
              "isExecuted": false,
              "uuid": "dbef6fa0-2660-46b7-8f05-690601abd149"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Identify Type of Hash -> Create New SHA1 Indicator",
              "targetStep": "/api/3/workflow_steps/4fd70f9b-4ff4-4891-82fb-d38cf977fd23",
              "sourceStep": "/api/3/workflow_steps/051fa8cb-ee84-4617-9988-1cd72e7ee038",
              "label": "SHA1",
              "isExecuted": false,
              "uuid": "8dba090a-e316-4e40-8121-97ef2e850b1d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set File Hash IRI -> Correlate File Hash and Process Name Indicators",
              "targetStep": "/api/3/workflow_steps/4808c725-31b9-45e7-bd48-09914b02d212",
              "sourceStep": "/api/3/workflow_steps/be6be4a0-5d49-43bd-a3bd-4ebd5e8b854d",
              "label": null,
              "isExecuted": false,
              "uuid": "97f84ece-5c5f-475a-a79f-21d16d088334"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set IP variables -> Destination IP Private IPspace Check",
              "targetStep": "/api/3/workflow_steps/ede2ba05-0136-4a88-a391-3ffa28e2ca74",
              "sourceStep": "/api/3/workflow_steps/47bf39f4-b83b-4847-9f83-e9b0d245b04d",
              "label": null,
              "isExecuted": false,
              "uuid": "f9bcf476-c453-4eea-a89e-7bfaa736a130"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Identify Type of Hash -> Create New MD5 Indicator",
              "targetStep": "/api/3/workflow_steps/9aa0987e-3680-4740-8c96-e9f0fa2ab1d1",
              "sourceStep": "/api/3/workflow_steps/051fa8cb-ee84-4617-9988-1cd72e7ee038",
              "label": "MD5",
              "isExecuted": false,
              "uuid": "3361e7a1-cf3d-4e64-9ec5-b27cb00806fe"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Update Existing File Hash Indicator -> Set Process Name IRI",
              "targetStep": "/api/3/workflow_steps/be6be4a0-5d49-43bd-a3bd-4ebd5e8b854d",
              "sourceStep": "/api/3/workflow_steps/eef5701a-9a74-445b-973d-b935312af40d",
              "label": null,
              "isExecuted": false,
              "uuid": "dc2ebc2f-a7dc-4f1c-9d2e-9c7c3e28a401"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Does Alert have IP Address -> No IP Address",
              "targetStep": "/api/3/workflow_steps/9cf743f8-22fe-46ab-8cda-6b86e32bccca",
              "sourceStep": "/api/3/workflow_steps/fd22ae84-5f55-4698-8353-cc93fd0cd06a",
              "label": "No",
              "isExecuted": false,
              "uuid": "ddaecff2-fc39-42ca-bec9-9ec30da01bf5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Source IP Private IPspace Check -> Is Source IP Private",
              "targetStep": "/api/3/workflow_steps/fc160efb-5a3d-43d8-98e3-a85c84bb6bdf",
              "sourceStep": "/api/3/workflow_steps/30080919-9762-40c8-b0c9-47c7fdae4a4a",
              "label": null,
              "isExecuted": false,
              "uuid": "04e77dcb-e1b1-4aea-9e48-0da064a750c6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Was Processname Indicator Found -> Create New Indicator Record for Processname",
              "targetStep": "/api/3/workflow_steps/035aaf92-e651-43eb-a88e-e15866df2f64",
              "sourceStep": "/api/3/workflow_steps/0cb3d4e6-9ffe-427e-a96c-d20da541fee0",
              "label": "No",
              "isExecuted": false,
              "uuid": "29aaf574-4984-4a65-b52b-c9253040f4e5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Was IP Address Indicator Found -> Update Existing IP Address Indicator",
              "targetStep": "/api/3/workflow_steps/74c9bf4a-fc54-4696-841c-9b24fbe52b08",
              "sourceStep": "/api/3/workflow_steps/8aa8c063-ab3e-40f8-88dc-2e3d402379dc",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "8ca24a6e-5820-43a0-8169-f0f09a130843"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set IP variables -> Is Source IP Private",
              "targetStep": "/api/3/workflow_steps/30080919-9762-40c8-b0c9-47c7fdae4a4a",
              "sourceStep": "/api/3/workflow_steps/47bf39f4-b83b-4847-9f83-e9b0d245b04d",
              "label": null,
              "isExecuted": false,
              "uuid": "7bdb3925-b447-4cb3-a77f-d64c6bb876f3"
            }
          ],
          "priority": null,
          "uuid": "638fae7e-eb8b-44c7-9c32-d1f7281180a4",
          "recordTags": [],
          "id": 110,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214963,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215028,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Create and Link User",
          "aliasName": null,
          "tag": "#Subroutine #DeDuplicate #Relate",
          "description": "Create user (if it doesn't exist already), and link to specified email, alert or incident",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "user_query_output",
            "alertRecordIRI",
            "emailRecordIRI",
            "incidentRecordIRI",
            "domain",
            "computername"
          ],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/45837bce-3b50-4797-aa1d-642331b98f2b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/af5dfb63-e492-4f74-b514-7dd96d6700f5",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Link User to Alert",
              "description": null,
              "arguments": {
                "resource": {
                  "__link": {
                    "users": "[\"{{vars.steps.Create_New_User['@id']}}\"]",
                    "incidents": "{% if vars.input.params.incidentRecordIRI %}['{{vars.input.params.incidentRecordIRI}}']{% endif %}"
                  }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.params.alertRecordIRI}}",
                "collectionType": "/api/3/alerts",
                "step_variables": []
              },
              "status": null,
              "top": "170",
              "left": "1060",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "fee8d9d9-2bca-4b2e-859e-15d31660eba6",
              "id": 561
            },
            {
              "@type": "WorkflowStep",
              "name": "No host data",
              "description": null,
              "arguments": {
                "params": [],
                "version": "2.4.0",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "140",
              "left": "1920",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "0eb3953f-ffae-4f8b-a214-74af9603f4a4",
              "id": 562
            },
            {
              "@type": "WorkflowStep",
              "name": "Copy  of Link User to Alert",
              "description": null,
              "arguments": {
                "resource": {
                  "__link": {
                    "users": "[\"{{vars.steps.Link_User['@id']}}\"]",
                    "incidents": "{% if vars.input.params.incidentRecordIRI %}['{{vars.input.params.incidentRecordIRI}}']{% endif %}"
                  }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.params.alertRecordIRI}}",
                "collectionType": "/api/3/alerts",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "1060",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "fdae9f66-f615-4b07-8d27-4b227cee791e",
              "id": 563
            },
            {
              "@type": "WorkflowStep",
              "name": "Find Host Record",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "hostname",
                      "value": "%{{vars.input.params.computername}}%",
                      "operator": "like"
                    }
                  ]
                },
                "module": "assets?$limit=1000",
                "step_variables": {
                  "resultRecordscount": "{{vars.result | length}}"
                }
              },
              "status": null,
              "top": "231",
              "left": "1920",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "a5e10c86-9653-4529-953d-7d7f7bd08989",
              "id": 564
            },
            {
              "@type": "WorkflowStep",
              "name": "Do Nothing",
              "description": null,
              "arguments": {
                "params": [],
                "version": "2.1.3",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "400",
              "left": "760",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "faf30677-7ea2-41aa-9fab-4e32c9e7d3c9",
              "id": 565
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": {
                      "domain": "{{ vars.domain }}",
                      "hostname": "{{ vars.hostname }}",
                      "computername": "{{ vars.computername }}",
                      "indicatorType": "{{ vars.indicatorType }}",
                      "alertRecordIRI": "{{ vars.alertRecordIRI }}",
                      "emailRecordIRI": "{{ vars.emailRecordIRI }}",
                      "indicatorValue": "{{ vars.indicatorValue }}",
                      "incidentRecordIRI": "{{ vars.incidentRecordIRI }}",
                      "user_query_output": "{{ vars.user_query_output }}"
                    }
                  }
                }
              },
              "status": null,
              "top": "40",
              "left": "80",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "af5dfb63-e492-4f74-b514-7dd96d6700f5",
              "id": 566
            },
            {
              "@type": "WorkflowStep",
              "name": "Set User IRI from Copy link",
              "description": null,
              "arguments": {
                "userIRI": "{{vars.steps.Create_New_User['@id']}}"
              },
              "status": null,
              "top": "170",
              "left": "1340",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "3c8a2df5-af1c-4432-a5f3-4019d1f24b10",
              "id": 567
            },
            {
              "@type": "WorkflowStep",
              "name": "Host data in Alert",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "step_iri": "/api/3/workflow_steps/a5e10c86-9653-4529-953d-7d7f7bd08989",
                    "condition": "{{ vars.input.params.computername | length > 0 }}"
                  },
                  {
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/0eb3953f-ffae-4f8b-a214-74af9603f4a4"
                  }
                ]
              },
              "status": null,
              "top": "231",
              "left": "1634",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "aa50ad82-bc53-450a-87f1-2c25787d39f7",
              "id": 568
            },
            {
              "@type": "WorkflowStep",
              "name": "Link User and Alert to Host Record",
              "description": null,
              "arguments": {
                "resource": {
                  "__link": {
                    "users": "[\"{{vars.userIRI}}\"]",
                    "alerts": "[\"{{vars.input.params.alertRecordIRI}}\"]",
                    "incidents": "{% if vars.input.params.incidentRecordIRI %}['{{vars.input.params.incidentRecordIRI}}']{% endif %}"
                  }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.steps.Find_Host_Record[0]['@id']}}",
                "collectionType": "/api/3/assets",
                "step_variables": []
              },
              "status": null,
              "top": "191",
              "left": "2492",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "60ece500-c35d-4147-b682-c492f042f431",
              "id": 569
            },
            {
              "@type": "WorkflowStep",
              "name": "Retrieve existing records",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "securityid",
                      "value": "{{vars.input.params['user_query_output']}}",
                      "operator": "eq"
                    }
                  ]
                },
                "module": "users?$limit=1000",
                "step_variables": {
                  "resultRecordscount": "{{vars.result | length}}"
                }
              },
              "status": null,
              "top": "240",
              "left": "80",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "26ef85e2-ec7c-493a-b866-aef393433c43",
              "id": 570
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Host Record and link to User and Alert",
              "description": null,
              "arguments": {
                "resource": {
                  "ip": null,
                  "tag": null,
                  "name": "{{vars.input.params.computername.split(\".\",1)[0]}}",
                  "notes": null,
                  "scans": null,
                  "tasks": null,
                  "users": "[\"{{vars.userIRI}}\"]",
                  "alerts": "[\"{{vars.input.params.alertRecordIRI}}\"]",
                  "owners": null,
                  "status": null,
                  "emailID": null,
                  "category": null,
                  "comments": null,
                  "hostname": "{{vars.input.params.computername.split(\".\",1)[0]}}",
                  "location": null,
                  "companies": null,
                  "deviceUID": null,
                  "incidents": "{% if vars.input.params.incidentRecordIRI %}['{{vars.input.params.incidentRecordIRI}}']{% endif %}",
                  "managedBy": null,
                  "assetClass": null,
                  "indicators": null,
                  "macAddress": "52:54:00:ef:1c:03",
                  "propertyOf": null,
                  "attachments": null,
                  "criticality": null,
                  "dateScanned": null,
                  "description": null,
                  "legalMatters": null,
                  "serialNumber": null,
                  "operatingSystem": null,
                  "vulnerabilities": null,
                  "registrationDate": null
                },
                "_showJson": false,
                "collection": "/api/3/assets",
                "step_variables": []
              },
              "status": null,
              "top": "268",
              "left": "2491",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "b652929d-ec01-46a0-830d-9ae6cd24133f",
              "id": 571
            },
            {
              "@type": "WorkflowStep",
              "name": "Link User",
              "description": null,
              "arguments": {
                "resource": {
                  "__link": {
                    "alerts": "[\"{{vars.input.params.alertRecordIRI}}\"]",
                    "incidents": "{% if vars.input.params.incidentRecordIRI %}['{{vars.input.params.incidentRecordIRI}}']{% endif %}"
                  }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.steps.Retrieve_existing_records[0]['@id']}}",
                "collectionType": "/api/3/users",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "760",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "baedb074-23d0-43dc-a052-944119433db4",
              "id": 572
            },
            {
              "@type": "WorkflowStep",
              "name": "Set User IRI from link",
              "description": null,
              "arguments": {
                "userIRI": "{{vars.steps.Link_User['@id']}}"
              },
              "status": null,
              "top": "300",
              "left": "1340",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "726377e1-e30f-43d9-a0f4-67ac4ee60fc5",
              "id": 573
            },
            {
              "@type": "WorkflowStep",
              "name": "Does host record exist",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "step_iri": "/api/3/workflow_steps/60ece500-c35d-4147-b682-c492f042f431",
                    "condition": "{{ vars.resultRecordscount != 0 }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/b652929d-ec01-46a0-830d-9ae6cd24133f",
                    "condition": "{{ vars.resultRecordscount == 0 }}"
                  }
                ]
              },
              "status": null,
              "top": "231",
              "left": "2200",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "b3822027-62dd-420a-bbb1-23799aba3cc0",
              "id": 574
            },
            {
              "@type": "WorkflowStep",
              "name": "Data present",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "step_iri": "/api/3/workflow_steps/26ef85e2-ec7c-493a-b866-aef393433c43",
                    "condition": "{{ vars.input.params['user_query_output'] | length > 0 }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/3c743377-cbda-451d-bcdd-a3c5b7528902",
                    "condition": "{{ vars.input.params['user_query_output'] | length == 0 }}"
                  }
                ]
              },
              "status": null,
              "top": "140",
              "left": "80",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "705a51ad-a1e3-4218-8dab-64a6d207e93e",
              "id": 575
            },
            {
              "@type": "WorkflowStep",
              "name": "Create New User",
              "description": null,
              "arguments": {
                "resource": {
                  "alerts": "[\"{{vars.input.params.alertRecordIRI}}\"]",
                  "assets": null,
                  "domain": "{{vars.input.params['user_query_output'].split(sep=\"\\\\\\\\\")[0]}}",
                  "owners": null,
                  "comments": null,
                  "username": "{{vars.input.params['user_query_output'].split(sep=\"\\\\\\\\\")[1]}}",
                  "incidents": "{% if vars.input.params.incidentRecordIRI %}['{{vars.input.params.incidentRecordIRI}}']{% endif %}",
                  "securityid": "{{vars.input.params['user_query_output']}}",
                  "knownCompromised": null
                },
                "_showJson": false,
                "collection": "/api/3/users",
                "step_variables": []
              },
              "status": null,
              "top": "170",
              "left": "760",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "5d9edf10-f475-42c9-b721-d70a5f2f2547",
              "id": 576
            },
            {
              "@type": "WorkflowStep",
              "name": "Do records exist",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "step_iri": "/api/3/workflow_steps/baedb074-23d0-43dc-a052-944119433db4",
                    "condition": "{{ vars.resultRecordscount != 0 and vars.input.params['user_query_output'] != \"NT AUTHORITY\\\\\\\\SYSTEM\" }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/5d9edf10-f475-42c9-b721-d70a5f2f2547",
                    "condition": "{{ vars.resultRecordscount == 0 and vars.input.params['user_query_output'] != \"NT AUTHORITY\\\\\\\\SYSTEM\" }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/faf30677-7ea2-41aa-9fab-4e32c9e7d3c9",
                    "condition": "{{ vars.input.params['user_query_output'] == \"NT AUTHORITY\\\\\\\\SYSTEM\" or vars.resultRecordscount == 0 }}"
                  }
                ]
              },
              "status": null,
              "top": "240",
              "left": "380",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "9c48c2f9-3de8-4c03-8792-d7dc3fb39af9",
              "id": 577
            },
            {
              "@type": "WorkflowStep",
              "name": "No data",
              "description": null,
              "arguments": {
                "params": [],
                "version": "2.2.0",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "140",
              "left": "380",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "3c743377-cbda-451d-bcdd-a3c5b7528902",
              "id": 578
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Data present",
              "targetStep": "/api/3/workflow_steps/705a51ad-a1e3-4218-8dab-64a6d207e93e",
              "sourceStep": "/api/3/workflow_steps/af5dfb63-e492-4f74-b514-7dd96d6700f5",
              "label": null,
              "isExecuted": false,
              "uuid": "edbfe875-d37c-4006-ab1d-5685d4135026"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Data present -> No data",
              "targetStep": "/api/3/workflow_steps/3c743377-cbda-451d-bcdd-a3c5b7528902",
              "sourceStep": "/api/3/workflow_steps/705a51ad-a1e3-4218-8dab-64a6d207e93e",
              "label": null,
              "isExecuted": false,
              "uuid": "37a9418c-a135-447d-81af-744c016f4e1d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Does host record exist -> Link User to Host Record",
              "targetStep": "/api/3/workflow_steps/60ece500-c35d-4147-b682-c492f042f431",
              "sourceStep": "/api/3/workflow_steps/b3822027-62dd-420a-bbb1-23799aba3cc0",
              "label": "",
              "isExecuted": false,
              "uuid": "352e1b71-068e-46d2-8466-8669c3afc39f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Find Host Record -> Copy  of Does records exist",
              "targetStep": "/api/3/workflow_steps/b3822027-62dd-420a-bbb1-23799aba3cc0",
              "sourceStep": "/api/3/workflow_steps/a5e10c86-9653-4529-953d-7d7f7bd08989",
              "label": null,
              "isExecuted": false,
              "uuid": "9bba0711-2b8f-49c4-971c-e402a45176d4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Does host record exist -> Create Host Record",
              "targetStep": "/api/3/workflow_steps/b652929d-ec01-46a0-830d-9ae6cd24133f",
              "sourceStep": "/api/3/workflow_steps/b3822027-62dd-420a-bbb1-23799aba3cc0",
              "label": null,
              "isExecuted": false,
              "uuid": "08838adc-b996-4bb9-a6bb-92580fe1f273"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Does indicator exist -> Create New Indicator",
              "targetStep": "/api/3/workflow_steps/5d9edf10-f475-42c9-b721-d70a5f2f2547",
              "sourceStep": "/api/3/workflow_steps/9c48c2f9-3de8-4c03-8792-d7dc3fb39af9",
              "label": null,
              "isExecuted": false,
              "uuid": "aca6f930-452b-4e15-9034-bd4adf1bdc82"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Does records exist -> Do Nothing",
              "targetStep": "/api/3/workflow_steps/faf30677-7ea2-41aa-9fab-4e32c9e7d3c9",
              "sourceStep": "/api/3/workflow_steps/9c48c2f9-3de8-4c03-8792-d7dc3fb39af9",
              "label": null,
              "isExecuted": false,
              "uuid": "0bafceeb-db9d-459a-9589-4a32db7d0ef1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Does indicator exist -> Link to Alert",
              "targetStep": "/api/3/workflow_steps/baedb074-23d0-43dc-a052-944119433db4",
              "sourceStep": "/api/3/workflow_steps/9c48c2f9-3de8-4c03-8792-d7dc3fb39af9",
              "label": null,
              "isExecuted": false,
              "uuid": "9a570e76-1915-4196-8119-ae12406f17c7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Host data in Alert -> No host data",
              "targetStep": "/api/3/workflow_steps/0eb3953f-ffae-4f8b-a214-74af9603f4a4",
              "sourceStep": "/api/3/workflow_steps/aa50ad82-bc53-450a-87f1-2c25787d39f7",
              "label": null,
              "isExecuted": false,
              "uuid": "32705013-3508-41eb-9d0b-b9be6c5553b9"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Host data in Alert -> Find Host Record",
              "targetStep": "/api/3/workflow_steps/a5e10c86-9653-4529-953d-7d7f7bd08989",
              "sourceStep": "/api/3/workflow_steps/aa50ad82-bc53-450a-87f1-2c25787d39f7",
              "label": "",
              "isExecuted": false,
              "uuid": "b2a4dbe8-d1ee-4789-a2b5-8554e68297f4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create New User -> Link User to Alert",
              "targetStep": "/api/3/workflow_steps/fee8d9d9-2bca-4b2e-859e-15d31660eba6",
              "sourceStep": "/api/3/workflow_steps/5d9edf10-f475-42c9-b721-d70a5f2f2547",
              "label": null,
              "isExecuted": false,
              "uuid": "6216ce50-a8b2-4386-8598-ad2288b0fcf4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Link User to Alert -> Copy  of Set User IRI from link",
              "targetStep": "/api/3/workflow_steps/3c8a2df5-af1c-4432-a5f3-4019d1f24b10",
              "sourceStep": "/api/3/workflow_steps/fee8d9d9-2bca-4b2e-859e-15d31660eba6",
              "label": null,
              "isExecuted": false,
              "uuid": "b94a13b4-7542-44e2-864a-010cd7f73e11"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set User IRI from link -> Host data in Alert",
              "targetStep": "/api/3/workflow_steps/aa50ad82-bc53-450a-87f1-2c25787d39f7",
              "sourceStep": "/api/3/workflow_steps/726377e1-e30f-43d9-a0f4-67ac4ee60fc5",
              "label": null,
              "isExecuted": false,
              "uuid": "9174ace5-638a-45e0-823f-986fc4c9e85a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Data present -> Retrieve existing records",
              "targetStep": "/api/3/workflow_steps/26ef85e2-ec7c-493a-b866-aef393433c43",
              "sourceStep": "/api/3/workflow_steps/705a51ad-a1e3-4218-8dab-64a6d207e93e",
              "label": null,
              "isExecuted": false,
              "uuid": "b4a2a170-71b1-4710-814a-c0415af5e9ec"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Check if indicator already exists -> Does indicator exist",
              "targetStep": "/api/3/workflow_steps/9c48c2f9-3de8-4c03-8792-d7dc3fb39af9",
              "sourceStep": "/api/3/workflow_steps/26ef85e2-ec7c-493a-b866-aef393433c43",
              "label": null,
              "isExecuted": false,
              "uuid": "03328e86-1dc6-4ae7-8332-3f59ff084aa2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Link User -> Copy  of Link User to Alert",
              "targetStep": "/api/3/workflow_steps/fdae9f66-f615-4b07-8d27-4b227cee791e",
              "sourceStep": "/api/3/workflow_steps/baedb074-23d0-43dc-a052-944119433db4",
              "label": null,
              "isExecuted": false,
              "uuid": "8971cc48-7b32-4525-b417-2195990e9aae"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Link User to Alert -> Set User IRI from link",
              "targetStep": "/api/3/workflow_steps/726377e1-e30f-43d9-a0f4-67ac4ee60fc5",
              "sourceStep": "/api/3/workflow_steps/fdae9f66-f615-4b07-8d27-4b227cee791e",
              "label": null,
              "isExecuted": false,
              "uuid": "0e4cdabe-053e-493e-8c55-4c78197ced3a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set User IRI from Copy link -> Host data in Alert",
              "targetStep": "/api/3/workflow_steps/aa50ad82-bc53-450a-87f1-2c25787d39f7",
              "sourceStep": "/api/3/workflow_steps/3c8a2df5-af1c-4432-a5f3-4019d1f24b10",
              "label": null,
              "isExecuted": false,
              "uuid": "4ab8777c-84fa-4641-8c1a-dc2059da4ea0"
            }
          ],
          "priority": null,
          "uuid": "b6b01cac-f181-4691-bb00-2300d999217d",
          "recordTags": [],
          "id": 111,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214963,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215028,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Create and Link Alerts from Hunt (Host-based)",
          "aliasName": null,
          "tag": "",
          "description": "Creates and links an Alert from a host based sensor to a Hunt",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "commandline",
            "userName",
            "technique",
            "processName",
            "MD5",
            "hostName",
            "sourceIP",
            "destinationIP",
            "sourceTool",
            "parentProcess",
            "eventTime",
            "parentProcessID",
            "processID",
            "parentCommandLine",
            "filePath",
            "eventName",
            "description",
            "huntIRI",
            "epochTime",
            "comment",
            "sourceImage",
            "targetImage",
            "source",
            "processGUID",
            "scheduledTask",
            "service",
            "url",
            "bytestransferred",
            "bitstransferid",
            "sourceData",
            "registryKey",
            "registryKeyValue",
            "computerName",
            "alertName",
            "decodedCommandLine",
            "mitre_tech_id"
          ],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/45837bce-3b50-4797-aa1d-642331b98f2b",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/2cb08b66-5d1c-4301-8a30-b17fbb56164e",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Comments to Hunt",
              "description": null,
              "arguments": {
                "resource": {
                  "hunts": "{%if vars.input.params.huntIRI %}[\"{{vars.input.params.huntIRI}}\"]{% endif %}",
                  "scans": null,
                  "tasks": null,
                  "users": null,
                  "alerts": null,
                  "assets": null,
                  "emails": null,
                  "events": null,
                  "owners": null,
                  "people": null,
                  "content": "<p>{{vars.input.params.comment}} Additionally, pre-existing related <a href=\"{{vars.request.baseUri}}{{ vars.steps.Retrieve_Existing_Open_Alerts[0]['@id'] | replace('/api/3','/modules/view-panel')}}\">Alert-{{vars.steps.Retrieve_Existing_Open_Alerts[0].id}}</a>&nbsp;with Status \"Open\" or \"Re-Opened\" was observed within CyOps. This Alert has now been linked to this Hunt.</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>",
                  "accounts": null,
                  "schedule": null,
                  "approvals": null,
                  "companies": null,
                  "customers": null,
                  "incidents": null,
                  "indicators": null,
                  "attachments": null,
                  "fraudAlerts": null,
                  "vulnerabilities": null
                },
                "_showJson": false,
                "collection": "/api/3/comments",
                "step_variables": []
              },
              "status": null,
              "top": "660",
              "left": "920",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "a602303d-0bf7-4d07-af67-b4889e959109",
              "id": 579
            },
            {
              "@type": "WorkflowStep",
              "name": "Retrieve Existing Open Alerts",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "epochTime",
                      "value": "{{vars.input.params.epochTime}}",
                      "operator": "eq",
                      "_operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "mitreTechnique",
                      "value": "%{{vars.input.params.technique}}%",
                      "operator": "like",
                      "_operator": "like"
                    },
                    {
                      "type": "primitive",
                      "field": "processId",
                      "value": "{{vars.input.params.processID}}",
                      "operator": "eq",
                      "_operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "computerName",
                      "value": "{{vars.input.params.computerName}}",
                      "operator": "eq",
                      "_operator": "eq"
                    },
                    {
                      "logic": "OR",
                      "filters": [
                        {
                          "type": "object",
                          "field": "status",
                          "value": "/api/3/picklists/7de816ff-7140-4ee5-bd05-93ce22002146",
                          "_value": {
                            "itemValue": "Open"
                          },
                          "operator": "eq"
                        },
                        {
                          "type": "object",
                          "field": "status",
                          "value": "/api/3/picklists/891fb9d5-556c-44c6-9f7d-94a27dec732e",
                          "_value": {
                            "itemValue": "Re-Opened"
                          },
                          "operator": "eq"
                        }
                      ]
                    },
                    {
                      "type": "primitive",
                      "field": "processGuid",
                      "value": "%{{vars.input.params.processGUID}}%",
                      "operator": "like",
                      "_operator": "like"
                    },
                    {
                      "type": "primitive",
                      "field": "scheduledTask",
                      "value": "{{vars.input.params.scheduledTask}}",
                      "operator": "eq",
                      "_operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "services",
                      "value": "{{vars.input.params.service}}",
                      "operator": "eq",
                      "_operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "url",
                      "value": "{{vars.input.params.url}}",
                      "operator": "eq",
                      "_operator": "eq"
                    }
                  ]
                },
                "module": "alerts?$limit=30",
                "step_variables": {
                  "resultRecordscount2": "{{vars.result | length}}"
                }
              },
              "status": null,
              "top": "166",
              "left": "920",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "f2b8fc96-f9ab-4aa0-9e76-4a9222cfe2fd",
              "id": 580
            },
            {
              "@type": "WorkflowStep",
              "name": "Link Open Alerts to Hunt",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Retrieve_Existing_Open_Alerts}}",
                  "condition": ""
                },
                "resource": {
                  "__link": {
                    "hunts": "{%if vars.input.params.huntIRI %}[\"{{vars.input.params.huntIRI}}\"]{% endif %}"
                  }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.item['@id']}}",
                "collectionType": "/api/3/alerts",
                "step_variables": []
              },
              "status": null,
              "top": "500",
              "left": "920",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "d9847cd8-9245-4b78-8495-2314e6e1c471",
              "id": 581
            },
            {
              "@type": "WorkflowStep",
              "name": "Retrieve Existing Alerts",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "epochTime",
                      "value": "{{vars.input.params.epochTime}}",
                      "operator": "eq",
                      "_operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "mitreTechnique",
                      "value": "%{{vars.input.params.technique}}%",
                      "operator": "like",
                      "_operator": "like"
                    },
                    {
                      "type": "primitive",
                      "field": "processId",
                      "value": "{{vars.input.params.processID}}",
                      "operator": "eq",
                      "_operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "computerName",
                      "value": "{{vars.input.params.computerName}}",
                      "operator": "eq",
                      "_operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "processGuid",
                      "value": "%{{vars.input.params.processGUID}}%",
                      "operator": "like",
                      "_operator": "like"
                    },
                    {
                      "type": "primitive",
                      "field": "services",
                      "value": "{{vars.input.params.service}}",
                      "operator": "eq",
                      "_operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "scheduledTask",
                      "value": "{{vars.input.params.scheduledTask}}",
                      "operator": "eq",
                      "_operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "url",
                      "value": "{{vars.input.params.url}}",
                      "operator": "eq",
                      "_operator": "eq"
                    }
                  ]
                },
                "module": "alerts?$limit=30000",
                "step_variables": {
                  "resultRecordscount": "{{vars.result | length}}"
                }
              },
              "status": null,
              "top": "20",
              "left": "546",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "a5bd47c3-f136-41e5-a27b-a45006708ad2",
              "id": 582
            },
            {
              "@type": "WorkflowStep",
              "name": "No New Alerts Needed",
              "description": null,
              "arguments": {
                "params": [],
                "version": "2.1.3",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "340",
              "left": "1260",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "5ba9b295-fb48-40bd-9c4e-627b67b17747",
              "id": 583
            },
            {
              "@type": "WorkflowStep",
              "name": "Are Any Alerts Still Open",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes",
                    "step_iri": "/api/3/workflow_steps/d9847cd8-9245-4b78-8495-2314e6e1c471",
                    "condition": "{{ vars.resultRecordscount2 != 0 }}"
                  },
                  {
                    "option": "No",
                    "step_iri": "/api/3/workflow_steps/5ba9b295-fb48-40bd-9c4e-627b67b17747",
                    "condition": "{{ vars.resultRecordscount2 == 0 }}"
                  }
                ]
              },
              "status": null,
              "top": "340",
              "left": "920",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "18d5baae-787a-4113-8a4f-93706dd2e51e",
              "id": 584
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": {
                      "MD5": "{{ vars.MD5 }}",
                      "url": "{{ vars.url }}",
                      "source": "{{ vars.source }}",
                      "comment": "{{ vars.comment }}",
                      "huntIRI": "{{ vars.huntIRI }}",
                      "service": "{{ vars.service }}",
                      "filePath": "{{ vars.filePath }}",
                      "hostName": "{{ vars.hostName }}",
                      "sourceIP": "{{ vars.sourceIP }}",
                      "userName": "{{ vars.userName }}",
                      "alertName": "{{ vars.alertName }}",
                      "epochTime": "{{ vars.epochTime }}",
                      "eventName": "{{ vars.eventName }}",
                      "eventTime": "{{ vars.eventTime }}",
                      "processID": "{{ vars.processID }}",
                      "technique": "{{ vars.technique }}",
                      "sourceData": "{{ vars.sourceData }}",
                      "sourceTool": "{{ vars.sourceTool }}",
                      "commandline": "{{ vars.commandline }}",
                      "description": "{{ vars.description }}",
                      "processGUID": "{{ vars.processGUID }}",
                      "processName": "{{ vars.processName }}",
                      "registryKey": "{{ vars.registryKey }}",
                      "sourceImage": "{{ vars.sourceImage }}",
                      "targetImage": "{{ vars.targetImage }}",
                      "computerName": "{{ vars.computerName }}",
                      "destinationIP": "{{ vars.destinationIP }}",
                      "mitre_tech_id": "{{ vars.mitre_tech_id }}",
                      "parentProcess": "{{ vars.parentProcess }}",
                      "scheduledTask": "{{ vars.scheduledTask }}",
                      "bitstransferid": "{{ vars.bitstransferid }}",
                      "parentProcessID": "{{ vars.parentProcessID }}",
                      "bytestransferred": "{{ vars.bytestransferred }}",
                      "registryKeyValue": "{{ vars.registryKeyValue }}",
                      "parentCommandLine": "{{ vars.parentCommandLine }}",
                      "decodedCommandLine": "{{ vars.decodedCommandLine }}"
                    }
                  }
                }
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "2cb08b66-5d1c-4301-8a30-b17fbb56164e",
              "id": 585
            },
            {
              "@type": "WorkflowStep",
              "name": "Do Alerts Already Exist",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes",
                    "step_iri": "/api/3/workflow_steps/f2b8fc96-f9ab-4aa0-9e76-4a9222cfe2fd",
                    "condition": "{{ vars.resultRecordscount != 0 }}"
                  },
                  {
                    "option": "No",
                    "step_iri": "/api/3/workflow_steps/a33d4138-f480-48c4-9d51-3d40232670ff",
                    "condition": "{{ vars.resultRecordscount == 0 }}"
                  }
                ]
              },
              "status": null,
              "top": "166",
              "left": "546",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "18eb9a8a-5dd7-4aa5-91d6-2c7da7598328",
              "id": 586
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Comment to Hunt",
              "description": null,
              "arguments": {
                "resource": {
                  "hunts": "{%if vars.input.params.huntIRI %}[\"{{vars.input.params.huntIRI}}\"]{% endif %}",
                  "scans": null,
                  "tasks": null,
                  "users": null,
                  "alerts": null,
                  "assets": null,
                  "emails": null,
                  "events": null,
                  "owners": null,
                  "people": null,
                  "content": "<p>{{vars.input.params.comment}}</p>",
                  "accounts": null,
                  "schedule": null,
                  "approvals": "",
                  "companies": null,
                  "customers": null,
                  "incidents": null,
                  "indicators": null,
                  "attachments": null,
                  "fraudAlerts": null,
                  "vulnerabilities": null
                },
                "_showJson": false,
                "collection": "/api/3/comments",
                "step_variables": []
              },
              "status": null,
              "top": "473",
              "left": "546",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "f14346b1-ecac-4093-a36e-e8dfb9a0ead2",
              "id": 587
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert",
              "description": null,
              "arguments": {
                "resource": {
                  "url": "{{vars.input.params.url or None}}",
                  "name": "{% if vars.input.params.alertName%}{{vars.input.params.alertName}}{% else %}MITRE-{{vars.input.params.technique}} Execution of {{vars.input.params.processName}}{% endif %}",
                  "type": {
                    "id": 547,
                    "@id": "/api/3/picklists/6bdeedd7-fb20-4b20-9717-f06520f0f788",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "MITRE ATT&CK",
                    "listName": "/api/3/picklist_names/a7087b9c-5660-495f-a8ac-c3b198ddb8c2",
                    "itemValue": "MITRE ATT&CK",
                    "orderIndex": 8
                  },
                  "hunts": "{%if vars.input.params.huntIRI %}[\"{{vars.input.params.huntIRI}}\"]{% endif %}",
                  "state": {
                    "id": 220,
                    "@id": "/api/3/picklists/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "New",
                    "listName": "/api/3/picklist_names/2f9ed741-25fe-475a-9f12-64336288eebf",
                    "itemValue": "New",
                    "orderIndex": 0
                  },
                  "source": "{{vars.input.params.source or None}}",
                  "status": {
                    "id": 120,
                    "@id": "/api/3/picklists/7de816ff-7140-4ee5-bd05-93ce22002146",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Open",
                    "listName": "/api/3/picklist_names/33e964a9-d607-49f2-813c-7ce46141815a",
                    "itemValue": "Open",
                    "orderIndex": 0
                  },
                  "fileHash": "{{vars.input.params.MD5 or None}}",
                  "filePath": "{{vars.input.params.filePath or None}}",
                  "services": "{{vars.input.params.service or None}}",
                  "severity": {
                    "id": 81,
                    "@id": "/api/3/picklists/40187287-89fc-4e9c-b717-e9443d57eedb",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#DE7A13",
                    "display": "High",
                    "listName": "/api/3/picklist_names/4e80cba3-032f-48b4-ac03-17e3ec247aac",
                    "itemValue": "High",
                    "orderIndex": 3
                  },
                  "sourceIp": "{{vars.input.params.sourceIP or None}}",
                  "userName": "{{vars.input.params.userName or None}}",
                  "__replace": "true",
                  "epochTime": "{{vars.input.params.epochTime}}",
                  "eventTime": "{{vars.input.params.eventTime}}",
                  "processId": "{{vars.input.params.processID or None}}",
                  "sourceTool": "{{vars.input.params.sourceTool or None}}",
                  "sourcedata": "{{vars.input.params.sourceData | toJSON}}",
                  "commandLine": "{{vars.input.params.commandline or None}}",
                  "description": "<p>{{vars.input.params.description}}</p>",
                  "processGuid": "{{vars.input.params.processGUID or None}}",
                  "processName": "{{vars.input.params.processName or None}}",
                  "registryKey": "{{vars.input.params.registryKey or None}}",
                  "targetAsset": "{{vars.input.params.hostName or None}}",
                  "ackSlaStatus": {
                    "id": 289,
                    "@id": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "Awaiting Action",
                    "listName": "/api/3/picklist_names/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                    "itemValue": "Awaiting Action",
                    "orderIndex": 2
                  },
                  "computerName": "{{vars.input.params.computerName or None}}",
                  "destinationIp": "{{vars.input.params.destinationIP or None}}",
                  "mitreattackid": "{{vars.input.params['mitre_tech_id']}}",
                  "respSlaStatus": {
                    "id": 289,
                    "@id": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "Awaiting Action",
                    "listName": "/api/3/picklist_names/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                    "itemValue": "Awaiting Action",
                    "orderIndex": 2
                  },
                  "scheduledTask": "{{vars.input.params.scheduledTask or None}}",
                  "sourceProcess": "{{vars.input.params.sourceImage or None}}",
                  "targetProcess": "{{vars.input.params.targetImage or None}}",
                  "mitreTechnique": "{{vars.input.params.technique}}",
                  "bytesTransferred": "{{vars.input.params.bytestransferred or None}}",
                  "parentProcessPid": "{{vars.input.params.parentProcessID or None}}",
                  "registryKeyValue": "{{vars.input.params.registryKeyValue or None}}",
                  "parentProcessName": "{{vars.input.params.parentProcess or None}}",
                  "decodedCommandLine": "{{vars.input.params.decodedCommandLine or None}}",
                  "escalatedtoincident": {
                    "id": 32,
                    "@id": "/api/3/picklists/2128a09c-153d-4db3-985d-de6be33deae5",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#808080",
                    "display": "No",
                    "listName": "/api/3/picklist_names/e131cc54-9ae4-43c9-b830-af6e331fe024",
                    "itemValue": "No",
                    "orderIndex": 1
                  },
                  "parentProcessCmdLine": "{{vars.input.params.parentCommandLine or None}}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/alerts",
                "tagsOperation": "OverwriteTags",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "340",
              "left": "546",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "a33d4138-f480-48c4-9d51-3d40232670ff",
              "id": 588
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Retrieve Existing Alerts",
              "targetStep": "/api/3/workflow_steps/a5bd47c3-f136-41e5-a27b-a45006708ad2",
              "sourceStep": "/api/3/workflow_steps/2cb08b66-5d1c-4301-8a30-b17fbb56164e",
              "label": null,
              "isExecuted": false,
              "uuid": "a33144ce-63ac-4cdc-a677-afc0e1af312f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Retrieve Existing Open Alerts -> Are Any Alerts Still Open",
              "targetStep": "/api/3/workflow_steps/18d5baae-787a-4113-8a4f-93706dd2e51e",
              "sourceStep": "/api/3/workflow_steps/f2b8fc96-f9ab-4aa0-9e76-4a9222cfe2fd",
              "label": null,
              "isExecuted": false,
              "uuid": "6d581d9b-2411-4c3b-8187-99d960725438"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Retrieve Existing Alerts -> Do Alerts Already Exist",
              "targetStep": "/api/3/workflow_steps/18eb9a8a-5dd7-4aa5-91d6-2c7da7598328",
              "sourceStep": "/api/3/workflow_steps/a5bd47c3-f136-41e5-a27b-a45006708ad2",
              "label": null,
              "isExecuted": false,
              "uuid": "d5b016bf-88ab-4dd7-aab9-218b9485b6f8"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert -> Create and Link Comment to Hunt",
              "targetStep": "/api/3/workflow_steps/f14346b1-ecac-4093-a36e-e8dfb9a0ead2",
              "sourceStep": "/api/3/workflow_steps/a33d4138-f480-48c4-9d51-3d40232670ff",
              "label": null,
              "isExecuted": false,
              "uuid": "f0eae8c8-39d4-4297-99b4-db48de9f9795"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Do Alerts Already Exist -> Create and Link Alert",
              "targetStep": "/api/3/workflow_steps/a33d4138-f480-48c4-9d51-3d40232670ff",
              "sourceStep": "/api/3/workflow_steps/18eb9a8a-5dd7-4aa5-91d6-2c7da7598328",
              "label": "No",
              "isExecuted": false,
              "uuid": "92f25bb8-97fb-49b3-8fd5-612443286b3e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Link Open Alerts to Hunt -> Create and Link Comments to Hunt",
              "targetStep": "/api/3/workflow_steps/a602303d-0bf7-4d07-af67-b4889e959109",
              "sourceStep": "/api/3/workflow_steps/d9847cd8-9245-4b78-8495-2314e6e1c471",
              "label": null,
              "isExecuted": false,
              "uuid": "74e32cd1-951f-4cf5-9d1a-f9ed820db5e1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Are Any Alerts Still Open -> No New Alerts Needed",
              "targetStep": "/api/3/workflow_steps/5ba9b295-fb48-40bd-9c4e-627b67b17747",
              "sourceStep": "/api/3/workflow_steps/18d5baae-787a-4113-8a4f-93706dd2e51e",
              "label": "No",
              "isExecuted": false,
              "uuid": "9d3c6963-dc8a-4947-8ce2-8434d014285c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Are Any Alerts Still Open -> Link Open Alerts to Hunt",
              "targetStep": "/api/3/workflow_steps/d9847cd8-9245-4b78-8495-2314e6e1c471",
              "sourceStep": "/api/3/workflow_steps/18d5baae-787a-4113-8a4f-93706dd2e51e",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "fa80c110-81a3-406b-817c-f5e502a493bb"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Do Alerts Already Exist -> Retrieve Existing Open Alerts",
              "targetStep": "/api/3/workflow_steps/f2b8fc96-f9ab-4aa0-9e76-4a9222cfe2fd",
              "sourceStep": "/api/3/workflow_steps/18eb9a8a-5dd7-4aa5-91d6-2c7da7598328",
              "label": "Yes",
              "isExecuted": false,
              "uuid": "4f6e8315-6114-4858-95d5-d66d59c4ed46"
            }
          ],
          "priority": null,
          "uuid": "bf7d418b-7ff3-44c1-b473-90d0a03c4641",
          "recordTags": [],
          "id": 112,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214963,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215028,
          "owners": [],
          "isPrivate": false
        }
      ]
    },
    {
      "@type": "WorkflowCollection",
      "name": "13 - MITRE ATT&CK™ - Boot or Logon Autostart Execution",
      "description": "Playbooks designed to hunt Boot or Logon Autostart Execution Techniques identified in the MITRE ATT&CK Framework",
      "visible": true,
      "image": null,
      "uuid": "5ec3f1cd-b517-4849-b726-67c9d4dcbe36",
      "id": 25,
      "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "createDate": 1629214963,
      "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "modifyDate": 1629214963,
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "HUNTS - Winlogon Helper DLL (T1547.004)",
          "aliasName": null,
          "tag": "ATT&CK, Persistence, Winlogon_Helper_DLL",
          "description": "Hunts for abnormal DLL loads and processes spawned by Winlogon",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/5ec3f1cd-b517-4849-b726-67c9d4dcbe36",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/4749602d-f3c9-49ba-b4e8-6a3848fc2b84",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Deduplicate comments",
              "description": null,
              "arguments": {
                "arguments": {
                  "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
              },
              "status": null,
              "top": "271",
              "left": "1810",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "7e43e69b-0dc6-4999-9471-e53b1c21430d",
              "id": 596
            },
            {
              "@type": "WorkflowStep",
              "name": "Retrieve key modification query results",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "9ab494b3-68d1-424f-9f76-0693bd787483",
                "params": {
                  "sid": "{'value':\"{{vars.steps.Query_for_Winlogon_helper_DLL_registry_key_modification.data.sid}}\"}",
                  "additional_args": "{\"A\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "220",
              "left": "1240",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "3f9092fd-71ef-425e-846c-4a820292225b",
              "id": 597
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "4bdcd0e9-38e7-4651-b427-6784022a698e",
                "title": "T1547.004 - Hunt for Winlogon Helper DLLs",
                "resources": [
                  "hunt"
                ],
                "inputVariables": [
                  {
                    "name": "siem",
                    "type": "picklists",
                    "label": "SIEM",
                    "title": "Picklist",
                    "usable": true,
                    "_ignore": false,
                    "tooltip": "Choose your SIEM",
                    "dataType": "picklist",
                    "formType": "picklist",
                    "required": true,
                    "_expanded": true,
                    "collection": false,
                    "dataSource": {
                      "model": "picklists",
                      "query": {
                        "sort": [
                          {
                            "field": "orderIndex",
                            "direction": "ASC"
                          }
                        ],
                        "logic": "AND",
                        "filters": [
                          {
                            "field": "listName__name",
                            "value": "SIEMs",
                            "operator": "eq"
                          }
                        ]
                      },
                      "displayConditions": {
                        "876c1483-416b-4d2f-8138-15769ae16d5c": {
                          "conditions": null,
                          "visibility": "visible"
                        },
                        "bcebcab1-3f93-468a-9f3f-91e5c511a0b5": {
                          "conditions": null,
                          "visibility": "visible"
                        }
                      }
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "_nameTouched": true,
                    "defaultValue": {
                      "id": 280,
                      "@id": "/api/3/picklists/876c1483-416b-4d2f-8138-15769ae16d5c",
                      "icon": null,
                      "@type": "Picklist",
                      "color": null,
                      "display": "Elastic",
                      "listName": "/api/3/picklist_names/98830189-afff-40e6-bed1-94012551dc67",
                      "itemValue": "Elastic",
                      "orderIndex": 1
                    },
                    "useModuleField": false,
                    "displayTemplate": "{{ itemValue }}",
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "siem": "{{vars.request.data[\"siem\"]}}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "hunt": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "368",
              "left": "9",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "4749602d-f3c9-49ba-b4e8-6a3848fc2b84",
              "id": 589
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Splunk hunt times",
              "description": null,
              "arguments": {
                "splunkHuntEnd": "{% if vars.input.records[0].huntEnd %}latest={{vars.input.records[0].huntEnd}}{% endif %}",
                "splunkHuntStart": "earliest={{vars.input.records[0].huntStart}}"
              },
              "status": null,
              "top": "270",
              "left": "668",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "2d87b80d-8dc7-4480-8a20-39db28bdae9f",
              "id": 590
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Elasticsearch hunt times",
              "description": null,
              "arguments": {
                "elasticHuntEnd": "{% if vars.input.records[0].huntEnd %} {{ arrow.get(vars.input.records[0].huntEnd).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }} {% else %} now {% endif %}",
                "elasticHuntStart": "{{ arrow.get(vars.input.records[0].huntStart).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }}"
              },
              "status": null,
              "top": "460",
              "left": "666",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "4d40f301-15a4-46cc-9db1-a70138728720",
              "id": 591
            },
            {
              "@type": "WorkflowStep",
              "name": "Query for Winlogon helper DLL registry key modification",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "9ab494b3-68d1-424f-9f76-0693bd787483",
                "params": {
                  "query": "index=sysmon EventCode=13 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} TargetObject=\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Shell\" OR TargetObject=\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Userinit\" OR TargetObject=\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Notify*\" OR TargetObject=\"HKLM\\\\SOFTWARE\\\\WOW6432Node\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Userinit\" OR TargetObject=\"HKLM\\\\SOFTWARE\\\\WOW6432Node\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Shell\" OR TargetObject=\"HKCU\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon*\" | table host Image process_exec vendor_product TimeCreated ProcessId TargetObject Computer Details object_path UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"A\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "220",
              "left": "960",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "54a1134a-8b78-4d83-8710-a8a395e0c2e5",
              "id": 592
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic Query for abnormal processes spawned by Winlogon",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:1 AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND  parent_image_path:\"C:\\\\Windows\\\\System32\\\\winlogon.exe\" NOT (image_path:\"C:\\\\Windows\\\\System32\\\\*\" OR image_path:\"C:\\\\Windows\\\\SysWOW64\\\\*\")",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "509",
              "left": "960",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "6a9cac7f-a22d-474f-89ee-32fbaed2eade",
              "id": 593
            },
            {
              "@type": "WorkflowStep",
              "name": "Query for abnormal processes spawned by Winlogon",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "9ab494b3-68d1-424f-9f76-0693bd787483",
                "params": {
                  "query": "index=sysmon EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} ParentImage=\"C:\\\\Windows\\\\System32\\\\winlogon.exe\" Image!=\"C:\\\\Windows\\\\System32\\\\*\" Image!=\"C:\\\\Windows\\\\SysWOW64\\\\*\" | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"A\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "320",
              "left": "960",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "3896f245-73a3-4511-b7cc-38b38c93aaea",
              "id": 594
            },
            {
              "@type": "WorkflowStep",
              "name": "Copy  of Deduplicate comments",
              "description": null,
              "arguments": {
                "arguments": {
                  "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
              },
              "status": null,
              "top": "460",
              "left": "1531",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "91566f8c-e5b6-40f9-a3a1-052527439574",
              "id": 595
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Retrieve_query_results.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query indicated winlogon.exe spawned {{vars.item.process_exec}} on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-Winlogon Helper DLL-{{vars.item.process_exec}} executed by Winlogon",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "Winlogon Helper DLL (Child Process)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.vendor_product}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "Winlogon.exe spawned an abnormal child process. This is unusual behavior in most networks and could be used by an adversary to achieve persistence. The process spawned by winlogon.exe should be evaluated to determine its legitimacy.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1004",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "320",
              "left": "1520",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "604e5cd8-8ff6-4a7e-8896-02737b358fac",
              "id": 598
            },
            {
              "@type": "WorkflowStep",
              "name": "Retrieve query results",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "9ab494b3-68d1-424f-9f76-0693bd787483",
                "params": {
                  "sid": "{'value':\"{{vars.steps.Query_for_abnormal_processes_spawned_by_Winlogon.data.sid}}\"}",
                  "additional_args": "{\"A\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "320",
              "left": "1240",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "00981c53-ca2e-4ce6-b2df-bd8fec38ce06",
              "id": 599
            },
            {
              "@type": "WorkflowStep",
              "name": "Select SIEM",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Splunk",
                    "step_iri": "/api/3/workflow_steps/2d87b80d-8dc7-4480-8a20-39db28bdae9f",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Splunk\" }}"
                  },
                  {
                    "option": "Elasticsearch",
                    "step_iri": "/api/3/workflow_steps/4d40f301-15a4-46cc-9db1-a70138728720",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Elastic\" }}"
                  }
                ]
              },
              "status": null,
              "top": "369",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "52fb9370-ae02-41f1-821b-46b53e834c1b",
              "id": 600
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic2 Create and Link Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_Query_for_abnormal_processes_spawned_by_Winlogon.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query identified {{vars.item._source.image_path.split(\"\\\\\")[-1] }} spawned by Winlogon at {{vars.item._source.event_data.UtcTime}}",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-Winlogon Helper DLL (Child Process)-{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "Winlogon Helper DLL (Child Process)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "Winlogon.exe spawned an abnormal child process. This is unusual behavior in most networks and could be used by an adversary to achieve persistence. The process spawned by winlogon.exe should be evaluated to determine its legitimacy.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1004",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "509",
              "left": "1240",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "664ea9e7-f0e1-4c2d-9de9-ce7728f00b43",
              "id": 601
            },
            {
              "@type": "WorkflowStep",
              "name": "Copy of Create and Link Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Retrieve_key_modification_query_results.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query indicated Winlogon helper DLL key value {{vars.item.Details}} was added to key {{vars.item.TargetObject}} on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "",
                  "alertName": "ATT&CK-Winlogon Helper DLL-{{vars.item.process_exec}} was used to change a Winlogon Registry key",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "Winlogon Helper DLL (Key Add/Mod)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.vendor_product}}",
                  "commandline": "{{vars.item.Details}}",
                  "description": "A Winlogon DLL helper registry key was modified/added. This is potentially unusual behavior in most networks and could be used by an adversary to achieve persistence. The added/modified registry key value should be evaluated to determine its legitimacy.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "{{vars.item.TargetObject}}",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1004",
                  "parentProcess": "",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "220",
              "left": "1520",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "0b4742be-4a6c-48dd-aeb1-8199bb92dae4",
              "id": 602
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic1 Create and Link Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_Query_for_Winlogon_helper_DLL_registry_key_modification.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query indicated Winlogon helper DLL key value {{vars.item._source.event_data.Details}} was added to key {{vars.item._source.event_data.TargetObject}} on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-Winlogon Helper DLL-Winlogon Registry Key value modified to {{vars.item._source.event_data.Details}}",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "Winlogon Helper DLL (Key Add/Mod)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "A Winlogon DLL helper registry key was modified/added. This is potentially unusual behavior in most networks and could be used by an adversary to achieve persistence. The added/modified registry key value should be evaluated to determine its legitimacy.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "{{vars.item._source.event_data.TargetObject}}",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1004",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "{{vars.item._source.event_data.Details}}",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "420",
              "left": "1240",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "d60fb413-58d7-49bd-b73b-add35a1275ca",
              "id": 603
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic Query for Winlogon helper DLL registry key modification",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:13 AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND (event_data.TargetObject:\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Shell\" OR event_data.TargetObject:\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Userinit\" OR event_data.TargetObject:\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Notify\" OR event_data.TargetObject:\"HKLM\\\\SOFTWARE\\\\WOW6432Node\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Userinit\" OR event_data.TargetObject:\"HKLM\\\\SOFTWARE\\\\WOW6432Node\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Shell\" OR event_data.TargetObject:\"HKCU\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\")",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "420",
              "left": "960",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "a787831b-bdaa-45fe-b688-6510299b7b72",
              "id": 604
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Query for use of attrib to hide files -> Copy  of Query for use of attrib to hide files",
              "targetStep": "/api/3/workflow_steps/00981c53-ca2e-4ce6-b2df-bd8fec38ce06",
              "sourceStep": "/api/3/workflow_steps/3896f245-73a3-4511-b7cc-38b38c93aaea",
              "label": null,
              "isExecuted": false,
              "uuid": "1d4552c5-8c81-4deb-a8a9-087906ffccc6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic1 Create and Link Alert -> Copy  of Deduplicate comments",
              "targetStep": "/api/3/workflow_steps/91566f8c-e5b6-40f9-a3a1-052527439574",
              "sourceStep": "/api/3/workflow_steps/d60fb413-58d7-49bd-b73b-add35a1275ca",
              "label": null,
              "isExecuted": false,
              "uuid": "2281149c-519a-4758-8a47-05e994ca343b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Select SIEM -> Set Elasticsearch hunt times",
              "targetStep": "/api/3/workflow_steps/4d40f301-15a4-46cc-9db1-a70138728720",
              "sourceStep": "/api/3/workflow_steps/52fb9370-ae02-41f1-821b-46b53e834c1b",
              "label": "Elasticsearch",
              "isExecuted": false,
              "uuid": "66cc79f3-c407-416d-9cd0-6c2602f43f62"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Retrieve key modification query results -> Copy  of Create and Link Alert",
              "targetStep": "/api/3/workflow_steps/0b4742be-4a6c-48dd-aeb1-8199bb92dae4",
              "sourceStep": "/api/3/workflow_steps/3f9092fd-71ef-425e-846c-4a820292225b",
              "label": null,
              "isExecuted": false,
              "uuid": "e87c350a-a2b4-4eaa-94ae-02320a6a4f58"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create and Link Alert -> Deduplicate comments",
              "targetStep": "/api/3/workflow_steps/7e43e69b-0dc6-4999-9471-e53b1c21430d",
              "sourceStep": "/api/3/workflow_steps/0b4742be-4a6c-48dd-aeb1-8199bb92dae4",
              "label": null,
              "isExecuted": false,
              "uuid": "b8a4fd8d-27ab-4539-b6dc-483fbc427e71"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elasticsearch hunt times -> Elastic Query for abnormal processes spawned by Winlogon",
              "targetStep": "/api/3/workflow_steps/6a9cac7f-a22d-474f-89ee-32fbaed2eade",
              "sourceStep": "/api/3/workflow_steps/4d40f301-15a4-46cc-9db1-a70138728720",
              "label": null,
              "isExecuted": false,
              "uuid": "cdda0610-5fbe-41e2-bc3d-2a2bdf075f79"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Select SIEM",
              "targetStep": "/api/3/workflow_steps/52fb9370-ae02-41f1-821b-46b53e834c1b",
              "sourceStep": "/api/3/workflow_steps/4749602d-f3c9-49ba-b4e8-6a3848fc2b84",
              "label": null,
              "isExecuted": false,
              "uuid": "603b388e-da66-4104-9f48-99c678c2825b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Query for abnormal processes spawned by Winlogon",
              "targetStep": "/api/3/workflow_steps/3896f245-73a3-4511-b7cc-38b38c93aaea",
              "sourceStep": "/api/3/workflow_steps/2d87b80d-8dc7-4480-8a20-39db28bdae9f",
              "label": null,
              "isExecuted": false,
              "uuid": "1dff7ca5-07bb-470b-8a4f-30b66b79a32c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Retrieve query results -> Create and Link Alert",
              "targetStep": "/api/3/workflow_steps/604e5cd8-8ff6-4a7e-8896-02737b358fac",
              "sourceStep": "/api/3/workflow_steps/00981c53-ca2e-4ce6-b2df-bd8fec38ce06",
              "label": null,
              "isExecuted": false,
              "uuid": "93a23410-b572-4e8e-8be2-d1c74ac51ca0"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert -> Deduplicate comments",
              "targetStep": "/api/3/workflow_steps/7e43e69b-0dc6-4999-9471-e53b1c21430d",
              "sourceStep": "/api/3/workflow_steps/604e5cd8-8ff6-4a7e-8896-02737b358fac",
              "label": null,
              "isExecuted": false,
              "uuid": "2147a114-ec5c-47c8-9707-55436fe3ccf0"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Query for Winlogon helper DLL registry key modification",
              "targetStep": "/api/3/workflow_steps/54a1134a-8b78-4d83-8710-a8a395e0c2e5",
              "sourceStep": "/api/3/workflow_steps/2d87b80d-8dc7-4480-8a20-39db28bdae9f",
              "label": null,
              "isExecuted": false,
              "uuid": "f1e8deba-7ec7-4c8e-a90a-d136fc361f68"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic2 Create and Link Alert -> Copy  of Deduplicate comments",
              "targetStep": "/api/3/workflow_steps/91566f8c-e5b6-40f9-a3a1-052527439574",
              "sourceStep": "/api/3/workflow_steps/664ea9e7-f0e1-4c2d-9de9-ce7728f00b43",
              "label": null,
              "isExecuted": false,
              "uuid": "bb863eeb-603b-4003-8aa1-74b7a5f25062"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Select SIEM -> Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/2d87b80d-8dc7-4480-8a20-39db28bdae9f",
              "sourceStep": "/api/3/workflow_steps/52fb9370-ae02-41f1-821b-46b53e834c1b",
              "label": "Splunk",
              "isExecuted": false,
              "uuid": "3ce3382d-7796-4a17-bed6-ab0a7f6d25b6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elasticsearch hunt times -> Elastic Query for Winlogon helper DLL registry key modification",
              "targetStep": "/api/3/workflow_steps/a787831b-bdaa-45fe-b688-6510299b7b72",
              "sourceStep": "/api/3/workflow_steps/4d40f301-15a4-46cc-9db1-a70138728720",
              "label": null,
              "isExecuted": false,
              "uuid": "eefc5c2e-1603-4539-89c2-f441af202797"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic Query for abnormal processes spawned by Winlogon -> Copy  of Elastic1 Create and Link Alert",
              "targetStep": "/api/3/workflow_steps/664ea9e7-f0e1-4c2d-9de9-ce7728f00b43",
              "sourceStep": "/api/3/workflow_steps/6a9cac7f-a22d-474f-89ee-32fbaed2eade",
              "label": null,
              "isExecuted": false,
              "uuid": "c0df8e30-cf47-4001-86c3-daf28e82170a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic Query for Winlogon helper DLL registry key modification -> Copy  of Copy  of Create and Link Alert",
              "targetStep": "/api/3/workflow_steps/d60fb413-58d7-49bd-b73b-add35a1275ca",
              "sourceStep": "/api/3/workflow_steps/a787831b-bdaa-45fe-b688-6510299b7b72",
              "label": null,
              "isExecuted": false,
              "uuid": "3fcbcc46-fe6b-4577-997d-3cd3ad38e45d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Query for Netsh helper DLL registry key modification -> Copy  of Retrieve key creation query results",
              "targetStep": "/api/3/workflow_steps/3f9092fd-71ef-425e-846c-4a820292225b",
              "sourceStep": "/api/3/workflow_steps/54a1134a-8b78-4d83-8710-a8a395e0c2e5",
              "label": null,
              "isExecuted": false,
              "uuid": "d349543b-d632-4b88-833d-44579e241245"
            }
          ],
          "priority": null,
          "uuid": "99ed0cfe-3182-42ef-b293-7bc857fe5a0c",
          "recordTags": [],
          "id": 113,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214963,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215009,
          "owners": [],
          "isPrivate": false
        }
      ]
    },
    {
      "@type": "WorkflowCollection",
      "name": "13 - MITRE ATT&CK™ - Pull Technique Details",
      "description": null,
      "visible": true,
      "image": null,
      "uuid": "7514a5a4-4880-4c99-b8c1-7aa7828c8c78",
      "id": 29,
      "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "createDate": 1629214963,
      "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "modifyDate": 1629214963,
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Link ATT&CK technique to Alert",
          "aliasName": null,
          "tag": null,
          "description": null,
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/7514a5a4-4880-4c99-b8c1-7aa7828c8c78",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/6d9d49ad-8c89-4e3b-8d98-038255b7c789",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "resource": "alerts",
                "resources": [
                  "alerts"
                ],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": [
                      "{{vars.input.records[0]}}"
                    ]
                  }
                },
                "fieldbasedtrigger": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "mitreattackid",
                      "value": "false",
                      "operator": "isnull",
                      "_operator": "isnull"
                    }
                  ]
                }
              },
              "status": null,
              "top": "30",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/ea155646-3821-4542-9702-b246da430a8d",
              "uuid": "6d9d49ad-8c89-4e3b-8d98-038255b7c789",
              "id": 704
            },
            {
              "@type": "WorkflowStep",
              "name": "Find technique",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "mitreId",
                      "value": "{{vars.input.records[0].mitreattackid}}",
                      "operator": "eq",
                      "_operator": "eq"
                    }
                  ]
                },
                "module": "mitre_techniques?$limit=30",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "07ca8de9-3388-4c07-804d-e027dc8276c1",
              "id": 705
            },
            {
              "@type": "WorkflowStep",
              "name": "Link technique to alert",
              "description": null,
              "arguments": {
                "when": "{{vars.steps.Find_technique | length > 0}}",
                "resource": {
                  "__link": {
                    "techniques": "{{vars.steps.Find_technique[0]['@id']}}"
                  }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "/api/3/alerts",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "c6b59cb9-56db-43a5-bf4a-e2ce02741216",
              "id": 706
            },
            {
              "@type": "WorkflowStep",
              "name": "Is it a subtechnique",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "step_iri": "/api/3/workflow_steps/a9076327-3f00-46d2-8f9b-b750505cde5a",
                    "condition": "{{ \".\" in vars.input.records[0].mitreattackid }}",
                    "step_name": "Find subtechnique"
                  },
                  {
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/07ca8de9-3388-4c07-804d-e027dc8276c1",
                    "step_name": "Find technique"
                  }
                ]
              },
              "status": null,
              "top": "165",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "4da2f828-5a80-42bf-a745-e8eeddf69ae4",
              "id": 707
            },
            {
              "@type": "WorkflowStep",
              "name": "Find subtechnique",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "primitive",
                      "field": "mitreId",
                      "value": "{{vars.input.records[0].mitreattackid}}",
                      "operator": "eq",
                      "_operator": "eq"
                    }
                  ]
                },
                "module": "mitre_sub_techniques?$limit=30",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "a9076327-3f00-46d2-8f9b-b750505cde5a",
              "id": 708
            },
            {
              "@type": "WorkflowStep",
              "name": "Link subtechnique to alert",
              "description": null,
              "arguments": {
                "when": "{{vars.steps.Find_subtechnique | length > 0}}",
                "resource": {
                  "__link": {
                    "subtechniques": "{{vars.steps.Find_subtechnique[0]['@id']}}"
                  }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "/api/3/alerts",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "435",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "98e0cf82-ec55-454f-a3ed-707e4979bf3a",
              "id": 709
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Find subtechnique -> Link subtechnique to alert",
              "targetStep": "/api/3/workflow_steps/98e0cf82-ec55-454f-a3ed-707e4979bf3a",
              "sourceStep": "/api/3/workflow_steps/a9076327-3f00-46d2-8f9b-b750505cde5a",
              "label": null,
              "isExecuted": false,
              "uuid": "75c7620c-1425-4064-ac00-83922d72f798"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is it a subtechnique -> Find technique",
              "targetStep": "/api/3/workflow_steps/07ca8de9-3388-4c07-804d-e027dc8276c1",
              "sourceStep": "/api/3/workflow_steps/4da2f828-5a80-42bf-a745-e8eeddf69ae4",
              "label": null,
              "isExecuted": false,
              "uuid": "22b9d3ae-6282-431e-b911-86dd9ccb8450"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is it a subtechnique -> Find subtechnique",
              "targetStep": "/api/3/workflow_steps/a9076327-3f00-46d2-8f9b-b750505cde5a",
              "sourceStep": "/api/3/workflow_steps/4da2f828-5a80-42bf-a745-e8eeddf69ae4",
              "label": null,
              "isExecuted": false,
              "uuid": "0c10107a-c4c1-493c-808b-27c9c59756ac"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Is it a subtechnique",
              "targetStep": "/api/3/workflow_steps/4da2f828-5a80-42bf-a745-e8eeddf69ae4",
              "sourceStep": "/api/3/workflow_steps/6d9d49ad-8c89-4e3b-8d98-038255b7c789",
              "label": null,
              "isExecuted": false,
              "uuid": "20e966c2-bbfd-483c-8ee4-fd68fcd0d6fd"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Find technique -> Link technique to alert",
              "targetStep": "/api/3/workflow_steps/c6b59cb9-56db-43a5-bf4a-e2ce02741216",
              "sourceStep": "/api/3/workflow_steps/07ca8de9-3388-4c07-804d-e027dc8276c1",
              "label": null,
              "isExecuted": false,
              "uuid": "d923614f-c3d8-48d1-b29b-1154b3b091e2"
            }
          ],
          "priority": null,
          "uuid": "3cd8c0dc-d217-41ad-83f2-a650876289be",
          "recordTags": [],
          "id": 121,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214963,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215036,
          "owners": [],
          "isPrivate": false
        }
      ]
    },
    {
      "@type": "WorkflowCollection",
      "name": "13 - MITRE ATT&CK™ - Event Triggered Execution",
      "description": "Playbooks designed to hunt Event Triggered Execution Techniques identified in the MITRE ATT&CK Framework",
      "visible": true,
      "image": null,
      "uuid": "a54055a4-be90-40d5-9bf4-1dc4e137d98c",
      "id": 27,
      "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "createDate": 1629214963,
      "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "modifyDate": 1629214963,
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "HUNTS - AppInit DLLs (T1546.010)",
          "aliasName": null,
          "tag": "ATT&CK, Persistence, Privilege_Escalation, AppInit_DLLs",
          "description": "Hunts for modification to AppInit DLLs registry keys.",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/a54055a4-be90-40d5-9bf4-1dc4e137d98c",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/6a92549a-2676-40b0-ba95-46becd4b6582",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Elastic Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_query_for_AppInit_DLLs.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query indicated AppInit DLL key value {{vars.item._source.event_data.Details}} was added to key {{vars.item._source.event_data.TargetObject}} on {{vars.item._source.computer_name | regex_search('([^.]+)')}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "",
                  "alertName": "ATT&CK-AppInit DLLs-{% if vars.item._source.event_data.Details %}{{vars.item._source.event_data.Details}} key value added{% else %}key created{% endif %}",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "AppInit DLL (Key Add/Mod)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "",
                  "description": "An AppInit DLL registry key was modified/added. This is potentially unusual behavior in most networks and could be used by an adversary to achieve persistence. The added/modified registry key value should be evaluated to determine its legitimacy.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "{{vars.item._source.event_data.TargetObject}}",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1103",
                  "parentProcess": "",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "",
                  "bytestransferred": "",
                  "registryKeyValue": "{{vars.item._source.event_data.Details}}",
                  "parentCommandLine": "",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "240",
              "left": "1440",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "fdadf5e1-fb9c-466f-a9da-468f24acd4a1",
              "id": 633
            },
            {
              "@type": "WorkflowStep",
              "name": "Deduplicate comments",
              "description": null,
              "arguments": {
                "arguments": {
                  "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
              },
              "status": null,
              "top": "160",
              "left": "1748",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "c71b917a-d9b6-48b6-8ba0-ce2e053af4ed",
              "id": 634
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "6e996307-5d9a-4a8f-a8fe-9d502b75ac6f",
                "title": "T1546.010 - Hunt for AppInit DLLs",
                "resources": [
                  "hunt"
                ],
                "inputVariables": [
                  {
                    "name": "siem",
                    "type": "picklists",
                    "label": "SIEM",
                    "title": "Picklist",
                    "usable": true,
                    "tooltip": "Choose your SIEM",
                    "dataType": "picklist",
                    "formType": "picklist",
                    "required": true,
                    "_expanded": true,
                    "mmdUpdate": true,
                    "collection": false,
                    "dataSource": {
                      "model": "picklists",
                      "query": {
                        "sort": [
                          {
                            "field": "orderIndex",
                            "direction": "ASC"
                          }
                        ],
                        "logic": "AND",
                        "filters": [
                          {
                            "field": "listName__name",
                            "value": "SIEMs",
                            "operator": "eq"
                          }
                        ]
                      },
                      "displayConditions": {
                        "876c1483-416b-4d2f-8138-15769ae16d5c": {
                          "conditions": null,
                          "visibility": "visible"
                        },
                        "bcebcab1-3f93-468a-9f3f-91e5c511a0b5": {
                          "conditions": null,
                          "visibility": "visible"
                        }
                      }
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "_nameTouched": true,
                    "defaultValue": {
                      "id": 280,
                      "@id": "/api/3/picklists/876c1483-416b-4d2f-8138-15769ae16d5c",
                      "icon": null,
                      "@type": "Picklist",
                      "color": null,
                      "display": "Elastic",
                      "listName": "/api/3/picklist_names/98830189-afff-40e6-bed1-94012551dc67",
                      "itemValue": "Elastic",
                      "orderIndex": 1
                    },
                    "displayTemplate": "{{ itemValue }}",
                    "lengthConstraint": false,
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "siem": "{{vars.request.data[\"siem\"]}}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "hunt": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "160",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "6a92549a-2676-40b0-ba95-46becd4b6582",
              "id": 635
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic query for AppInit DLLs",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "@timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND event_type:sysmon AND (event_id:\"12\" OR event_id:\"13\") AND (event_data.TargetObject.keyword:HKLM\\\\SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Windows\\ NT\\\\CurrentVersion\\\\Windows\\\\AppInit_DLLs OR event_data.TargetObject.keyword:HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\ NT\\\\CurrentVersion\\\\Windows\\\\AppInit_DLLs)",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "240",
              "left": "900",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "14b1bc8d-d28b-4730-b3c9-2178ac0a4f3e",
              "id": 636
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Splunk Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Retrieve_key_modification_query_results.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query indicated AppInit DLL key value {{vars.item.Details}} was added to key {{vars.item.TargetObject}} on {{vars.item.host}} at {{vars.item.TimeCreated}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "",
                  "userName": "",
                  "alertName": "ATT&CK-AppInit DLLs-{% if vars.item.Details %}{{vars.item.Details}} key value added{% else %}key created{% endif %}",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "AppInit DLL (Key Add/Mod)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.EventChannel}}",
                  "commandline": "",
                  "description": "An AppInit DLL registry key was modified/added. This is potentially unusual behavior in most networks and could be used by an adversary to achieve persistence. The added/modified registry key value should be evaluated to determine its legitimacy.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "{{vars.item.TargetObject}}",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1103",
                  "parentProcess": "",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "",
                  "bytestransferred": "",
                  "registryKeyValue": "{{vars.item.Details}}",
                  "parentCommandLine": "",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "80",
              "left": "1440",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "2d546562-2f77-480b-9a8e-769455e4afe0",
              "id": 637
            },
            {
              "@type": "WorkflowStep",
              "name": "Retrieve key modification query results",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "9ab494b3-68d1-424f-9f76-0693bd787483",
                "params": {
                  "sid": "{'value':\"{{vars.steps.Query_for_AppInit_DLL_registry_key_modification.data.sid}}\"}",
                  "additional_args": "{\"A\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "80",
              "left": "1169",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "065508dd-8751-43d7-97bb-e2456ea43521",
              "id": 638
            },
            {
              "@type": "WorkflowStep",
              "name": "Query for AppInit DLL registry key modification",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "9ab494b3-68d1-424f-9f76-0693bd787483",
                "params": {
                  "query": "index=sysmon (EventCode=12 OR EventCode=13) {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} TargetObject=\"HKLM\\\\SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows\\\\AppInit_DLLs\" OR TargetObject=\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows\\\\AppInit_DLLs\" | dedup host, TargetObject, Details | table host Image process_exec EventChannel UtcTime TimeCreated ProcessId TargetObject Computer Details object_path",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"A\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "80",
              "left": "900",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "361845f0-cd9f-4276-b2e0-6c7b40a8d61a",
              "id": 639
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Splunk hunt times",
              "description": null,
              "arguments": {
                "splunkHuntEnd": "{% if vars.input.records[0].huntEnd %}latest={{vars.input.records[0].huntEnd}}{% endif %}",
                "splunkHuntStart": "earliest={{vars.input.records[0].huntStart}}"
              },
              "status": null,
              "top": "80",
              "left": "631",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "2ba4c6e5-51e4-47aa-bcaf-d7994bd488f9",
              "id": 640
            },
            {
              "@type": "WorkflowStep",
              "name": "Select SIEM",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Elasticsearch",
                    "step_iri": "/api/3/workflow_steps/3ef17323-008b-4e7d-8fd1-a9b7447ce6bb",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Elastic\" }}"
                  },
                  {
                    "option": "Splunk",
                    "step_iri": "/api/3/workflow_steps/2ba4c6e5-51e4-47aa-bcaf-d7994bd488f9",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Splunk\" }}"
                  }
                ]
              },
              "status": null,
              "top": "160",
              "left": "287",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "d3526580-a0be-4760-964d-32b7c0872588",
              "id": 641
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Elastic hunt times",
              "description": null,
              "arguments": {
                "elasticHuntEnd": "{% if vars.input.records[0].huntEnd %} {{ arrow.get(vars.input.records[0].huntEnd).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }} {% else %} now {% endif %}",
                "elasticHuntStart": "{{ arrow.get(vars.input.records[0].huntStart).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }}"
              },
              "status": null,
              "top": "240",
              "left": "632",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "3ef17323-008b-4e7d-8fd1-a9b7447ce6bb",
              "id": 642
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Query for Netsh helper DLL registry key modification -> Copy  of Retrieve key creation query results",
              "targetStep": "/api/3/workflow_steps/065508dd-8751-43d7-97bb-e2456ea43521",
              "sourceStep": "/api/3/workflow_steps/361845f0-cd9f-4276-b2e0-6c7b40a8d61a",
              "label": null,
              "isExecuted": false,
              "uuid": "468e1e7b-b6cd-4792-a518-e43c049e9542"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create and Link Alert -> Deduplicate comments",
              "targetStep": "/api/3/workflow_steps/c71b917a-d9b6-48b6-8ba0-ce2e053af4ed",
              "sourceStep": "/api/3/workflow_steps/2d546562-2f77-480b-9a8e-769455e4afe0",
              "label": null,
              "isExecuted": false,
              "uuid": "d581f8d8-f781-4789-b23f-b99cc02bb70f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Elastic Alert -> Deduplicate comments",
              "targetStep": "/api/3/workflow_steps/c71b917a-d9b6-48b6-8ba0-ce2e053af4ed",
              "sourceStep": "/api/3/workflow_steps/fdadf5e1-fb9c-466f-a9da-468f24acd4a1",
              "label": null,
              "isExecuted": false,
              "uuid": "f6e9385a-753e-412d-bb45-21cfa2edc165"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Select SIEM -> Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/2ba4c6e5-51e4-47aa-bcaf-d7994bd488f9",
              "sourceStep": "/api/3/workflow_steps/d3526580-a0be-4760-964d-32b7c0872588",
              "label": "Splunk",
              "isExecuted": false,
              "uuid": "c5058399-b3b4-4b42-a667-10475aa55cde"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Select SIEM",
              "targetStep": "/api/3/workflow_steps/d3526580-a0be-4760-964d-32b7c0872588",
              "sourceStep": "/api/3/workflow_steps/6a92549a-2676-40b0-ba95-46becd4b6582",
              "label": null,
              "isExecuted": false,
              "uuid": "321b7903-8cff-4b73-a8b3-d4d8973da8b1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Retrieve key modification query results -> Copy  of Create and Link Alert",
              "targetStep": "/api/3/workflow_steps/2d546562-2f77-480b-9a8e-769455e4afe0",
              "sourceStep": "/api/3/workflow_steps/065508dd-8751-43d7-97bb-e2456ea43521",
              "label": null,
              "isExecuted": false,
              "uuid": "208f5084-4857-4bff-a66d-2ded84936951"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Query for AppInit DLL registry key modification",
              "targetStep": "/api/3/workflow_steps/361845f0-cd9f-4276-b2e0-6c7b40a8d61a",
              "sourceStep": "/api/3/workflow_steps/2ba4c6e5-51e4-47aa-bcaf-d7994bd488f9",
              "label": null,
              "isExecuted": false,
              "uuid": "eb8baeaf-b06d-4a1b-94ef-df34dfe911d2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Select SIEM -> Copy  of Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/3ef17323-008b-4e7d-8fd1-a9b7447ce6bb",
              "sourceStep": "/api/3/workflow_steps/d3526580-a0be-4760-964d-32b7c0872588",
              "label": "Elasticsearch",
              "isExecuted": false,
              "uuid": "881bfe33-3883-4253-98f1-fbe4f0d815fd"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic query for AppInit DLLs -> Create and Link Elastic Alert",
              "targetStep": "/api/3/workflow_steps/fdadf5e1-fb9c-466f-a9da-468f24acd4a1",
              "sourceStep": "/api/3/workflow_steps/14b1bc8d-d28b-4730-b3c9-2178ac0a4f3e",
              "label": null,
              "isExecuted": false,
              "uuid": "ead341a7-155f-4232-89e8-9076ee4fc8d1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> Elastic query for AppInit DLLs",
              "targetStep": "/api/3/workflow_steps/14b1bc8d-d28b-4730-b3c9-2178ac0a4f3e",
              "sourceStep": "/api/3/workflow_steps/3ef17323-008b-4e7d-8fd1-a9b7447ce6bb",
              "label": null,
              "isExecuted": false,
              "uuid": "873bdc56-e269-457e-8b5a-f26253083934"
            }
          ],
          "priority": null,
          "uuid": "00e98266-9618-4345-a20b-09f241c02e96",
          "recordTags": [],
          "id": 116,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214963,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215024,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "HUNTS - Netsh Helper DLL (T1546.007)",
          "aliasName": null,
          "tag": "ATT&CK, Persistence, Netsh_Helper_DLL",
          "description": "Hunts for abnormal DLL loads and processes spawned by netsh.exe.",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/a54055a4-be90-40d5-9bf4-1dc4e137d98c",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/49b53f31-144f-4a8c-9991-3ba03d4267c9",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Retrieve query results",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "9ab494b3-68d1-424f-9f76-0693bd787483",
                "params": {
                  "sid": "{'value':\"{{vars.steps.Query_for_processes_spawned_by_Netsh.data.sid}}\"}",
                  "additional_args": "{\"A\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "340",
              "left": "1211",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "30fa23ba-6baf-414e-8030-345cbc520353",
              "id": 652
            },
            {
              "@type": "WorkflowStep",
              "name": "Retrieve key modification query results",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "9ab494b3-68d1-424f-9f76-0693bd787483",
                "params": {
                  "sid": "{'value':\"{{vars.steps.Query_for_Netsh_helper_DLL_registry_key_modification.data.sid}}\"}",
                  "additional_args": "{\"A\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "260",
              "left": "1212",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "b1f606e8-dec4-4c65-b668-dc17cab8b5f4",
              "id": 643
            },
            {
              "@type": "WorkflowStep",
              "name": "Query for Netsh helper DLL registry key modification",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "9ab494b3-68d1-424f-9f76-0693bd787483",
                "params": {
                  "query": "index=sysmon (EventCode=12 OR EventCode=13) {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} TargetObject=\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\NetSh\\\\*\"  Details!=NULL Details!=\"(Empty)\" | table host Image process_exec vendor_product TimeCreated ProcessId TargetObject Computer Details object_path UtcTime EventChannel ProcessGuid Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"A\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "260",
              "left": "934",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "889d9193-7557-4c25-a1d8-0f55b509d46b",
              "id": 644
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic Create and Link Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_Query_for_processes_spawned_by_Netsh.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query indicated netsh.exe spawned {{vars.item._source.image_path.split(\"\\\\\")[-1] }} on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-Netsh Helper DLL-{{vars.item._source.image_path.split(\"\\\\\")[-1] }} spawned by Netsh",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "Netsh Helper DLL (Child Process)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "Netsh.exe spawned a child process. This is unusual behavior in most networks and could be used by an adversary to achieve persistence. The process spawned by netsh.exe should be evaluated to determine its legitimacy.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1128",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "531",
              "left": "1488",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "e31f56b9-4267-4487-93b8-9fd1933a6d2c",
              "id": 653
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Retrieve_query_results.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query indicated netsh.exe spawned {{vars.item.process_exec}} on {{vars.item.host}} at {{vars.item.TimeCreated}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-Netsh Helper DLL-{{vars.item.process_exec}} spawned by Netsh",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "Netsh Helper DLL (Child Process)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.EventChannel}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "Netsh.exe spawned a child process. This is unusual behavior in most networks and could be used by an adversary to achieve persistence. The process spawned by netsh.exe should be evaluated to determine its legitimacy.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1128",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "340",
              "left": "1486",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "d3936adc-3f23-4e4d-bec7-6f67c41256bc",
              "id": 645
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Elasticsearch hunt times",
              "description": null,
              "arguments": {
                "elasticHuntEnd": "{% if vars.input.records[0].huntEnd %} {{ arrow.get(vars.input.records[0].huntEnd).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }} {% else %} now {% endif %}",
                "elasticHuntStart": "{{ arrow.get(vars.input.records[0].huntStart).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }}"
              },
              "status": null,
              "top": "489",
              "left": "640",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "7d5e91b5-f322-4016-9c59-8ba56ddc7607",
              "id": 646
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic Query for Netsh helper DLL registry key modification",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND (event_id:\"12\" OR event_id:\"13\") AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND event_data.TargetObject:\"HKLM\\\\SOFTWARE\\\\Microsoft\\\\NetSh\\\\*\"",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "440",
              "left": "931",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "b2cd09f2-e17f-4c12-99a8-2a6b459f4fc9",
              "id": 647
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic Copy of Create and Link Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_Query_for_Netsh_helper_DLL_registry_key_modification.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query indicated Netsh helper DLL key value {{vars.item._source.event_data.Details}} was added to key {{vars.item.TargetObject}} on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "",
                  "alertName": "ATT&CK-Netsh Helper DLL-{{vars.item._source.image_path.split(\"\\\\\")[-1] }} created or modified a Netsh Registry key",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "Netsh Helper DLL (Key Add/Mod)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "",
                  "description": "A Netsh DLL helper registry key was modified/added. This is potentially unusual behavior in most networks and could be used by an adversary to achieve persistence. The added/modified registry key value should be evaluated to determine its legitimacy.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path}}",
                  "registryKey": "{{vars.item._source.event_data.TargetObject}}",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1128",
                  "parentProcess": "",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "",
                  "bytestransferred": "",
                  "registryKeyValue": "{{vars.item._source.event_data.Details}}",
                  "parentCommandLine": "",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "440",
              "left": "1480",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "a27ca441-204e-4ed8-a2a2-4d85bbefe599",
              "id": 648
            },
            {
              "@type": "WorkflowStep",
              "name": "Query for processes spawned by Netsh",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "9ab494b3-68d1-424f-9f76-0693bd787483",
                "params": {
                  "query": "index=sysmon EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} (ParentImage=\"C:\\\\Windows\\\\System32\\\\netsh.exe\" OR ParentImage=\"C:\\\\Windows\\\\SysWOW64\\\\netsh.exe\")  | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"A\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "340",
              "left": "932",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "d67a0aa3-ea21-49f2-a9cb-5a09aeba2810",
              "id": 649
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "7bf4217c-9905-4f8d-8ec5-bb58495bc69e",
                "title": "T1546.007 - Hunt for Netsh Helper DLL",
                "resources": [
                  "hunt"
                ],
                "inputVariables": [
                  {
                    "name": "siem",
                    "type": "picklists",
                    "label": "SIEM",
                    "title": "Picklist",
                    "usable": true,
                    "tooltip": "Choose your SIEM",
                    "dataType": "picklist",
                    "formType": "picklist",
                    "required": true,
                    "_expanded": true,
                    "mmdUpdate": true,
                    "collection": false,
                    "dataSource": {
                      "model": "picklists",
                      "query": {
                        "sort": [
                          {
                            "field": "orderIndex",
                            "direction": "ASC"
                          }
                        ],
                        "logic": "AND",
                        "filters": [
                          {
                            "field": "listName__name",
                            "value": "SIEMs",
                            "operator": "eq"
                          }
                        ]
                      },
                      "displayConditions": {
                        "876c1483-416b-4d2f-8138-15769ae16d5c": {
                          "conditions": null,
                          "visibility": "visible"
                        },
                        "bcebcab1-3f93-468a-9f3f-91e5c511a0b5": {
                          "conditions": null,
                          "visibility": "visible"
                        }
                      }
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "_nameTouched": true,
                    "defaultValue": {
                      "id": 280,
                      "@id": "/api/3/picklists/876c1483-416b-4d2f-8138-15769ae16d5c",
                      "icon": null,
                      "@type": "Picklist",
                      "color": null,
                      "display": "Elastic",
                      "listName": "/api/3/picklist_names/98830189-afff-40e6-bed1-94012551dc67",
                      "itemValue": "Elastic",
                      "orderIndex": 1
                    },
                    "displayTemplate": "{{ itemValue }}",
                    "lengthConstraint": false,
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "siem": "{{vars.request.data[\"siem\"]}}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "hunt": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "380",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "49b53f31-144f-4a8c-9991-3ba03d4267c9",
              "id": 650
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic Query for processes spawned by Netsh",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:\"1\" AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND (parent_image_path:\"C:\\\\Windows\\\\SysWOW64\\\\netsh.exe\" OR parent_image_path:\"C:\\\\Windows\\\\System32\\\\netsh.exe\")",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "531",
              "left": "931",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "2f6e2fee-cc91-4777-a7d6-b121d3726990",
              "id": 651
            },
            {
              "@type": "WorkflowStep",
              "name": "Copy  of Create and Link Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Retrieve_key_modification_query_results.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query indicated Netsh helper DLL key value {{vars.item.Details}} was added to key {{vars.item.TargetObject}} on {{vars.item.host}} at {{vars.item.TimeCreated}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "",
                  "alertName": "ATT&CK-Netsh Helper DLL-{{vars.item.process_exec}} created or modified a Netsh Registry key",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "Netsh Helper DLL (Key Add/Mod)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.vendor_product}}",
                  "commandline": "",
                  "description": "A Netsh DLL helper registry key was modified/added. This is potentially unusual behavior in most networks and could be used by an adversary to achieve persistence. The added/modified registry key value should be evaluated to determine its legitimacy.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "{{vars.item.TargetObject}}",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1128",
                  "parentProcess": "",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "",
                  "bytestransferred": "",
                  "registryKeyValue": "{{vars.item.Details}}",
                  "parentCommandLine": "",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "260",
              "left": "1489",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "c9632034-c51a-4bcf-9177-1ab91fd69383",
              "id": 654
            },
            {
              "@type": "WorkflowStep",
              "name": "Deduplicate comments",
              "description": null,
              "arguments": {
                "arguments": {
                  "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
              },
              "status": null,
              "top": "400",
              "left": "1820",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "85bf3611-816d-407f-9b76-b4a8fb5932e9",
              "id": 655
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Splunk hunt times",
              "description": null,
              "arguments": {
                "splunkHuntEnd": "{% if vars.input.records[0].huntEnd %}latest={{vars.input.records[0].huntEnd}}{% endif %}",
                "splunkHuntStart": "earliest={{vars.input.records[0].huntStart}}"
              },
              "status": null,
              "top": "306",
              "left": "640",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "6f0ff634-d9c8-4649-b97a-a3cc801360df",
              "id": 656
            },
            {
              "@type": "WorkflowStep",
              "name": "Select SIEM",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Elasticsearch",
                    "step_iri": "/api/3/workflow_steps/7d5e91b5-f322-4016-9c59-8ba56ddc7607",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Elastic\" }}"
                  },
                  {
                    "option": "Splunk",
                    "step_iri": "/api/3/workflow_steps/6f0ff634-d9c8-4649-b97a-a3cc801360df",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Splunk\" }}"
                  }
                ]
              },
              "status": null,
              "top": "380",
              "left": "294",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "defa2458-166c-4037-8779-c36eeeccc22c",
              "id": 657
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Query for processes spawned by Netsh",
              "targetStep": "/api/3/workflow_steps/d67a0aa3-ea21-49f2-a9cb-5a09aeba2810",
              "sourceStep": "/api/3/workflow_steps/6f0ff634-d9c8-4649-b97a-a3cc801360df",
              "label": null,
              "isExecuted": false,
              "uuid": "be16f162-856b-45bc-88d1-6c7a97cb4905"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Select SIEM -> Set Elasticsearch hunt times",
              "targetStep": "/api/3/workflow_steps/7d5e91b5-f322-4016-9c59-8ba56ddc7607",
              "sourceStep": "/api/3/workflow_steps/defa2458-166c-4037-8779-c36eeeccc22c",
              "label": "Elasticsearch",
              "isExecuted": false,
              "uuid": "9f29d7ae-bc1e-4ef7-8b4e-5219f2c2ccc8"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic Query for Netsh helper DLL registry key modification -> Copy  of Copy  of Create and Link Alert",
              "targetStep": "/api/3/workflow_steps/a27ca441-204e-4ed8-a2a2-4d85bbefe599",
              "sourceStep": "/api/3/workflow_steps/b2cd09f2-e17f-4c12-99a8-2a6b459f4fc9",
              "label": null,
              "isExecuted": false,
              "uuid": "4e2f87fb-fafd-45ea-9490-b798772118ac"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create and Link Alert -> Deduplicate comments",
              "targetStep": "/api/3/workflow_steps/85bf3611-816d-407f-9b76-b4a8fb5932e9",
              "sourceStep": "/api/3/workflow_steps/c9632034-c51a-4bcf-9177-1ab91fd69383",
              "label": null,
              "isExecuted": false,
              "uuid": "f685b22f-6f40-4dc7-96ae-d490d49da113"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Query for Netsh helper DLL registry key modification -> Copy  of Retrieve key creation query results",
              "targetStep": "/api/3/workflow_steps/b1f606e8-dec4-4c65-b668-dc17cab8b5f4",
              "sourceStep": "/api/3/workflow_steps/889d9193-7557-4c25-a1d8-0f55b509d46b",
              "label": null,
              "isExecuted": false,
              "uuid": "38cec2d3-65cc-4aa9-99c8-95b17950a8d8"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert -> Deduplicate comments",
              "targetStep": "/api/3/workflow_steps/85bf3611-816d-407f-9b76-b4a8fb5932e9",
              "sourceStep": "/api/3/workflow_steps/d3936adc-3f23-4e4d-bec7-6f67c41256bc",
              "label": null,
              "isExecuted": false,
              "uuid": "dca05632-d31e-4795-839d-88d27b59a1b1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Query for Netsh helper DLL registry key modification",
              "targetStep": "/api/3/workflow_steps/889d9193-7557-4c25-a1d8-0f55b509d46b",
              "sourceStep": "/api/3/workflow_steps/6f0ff634-d9c8-4649-b97a-a3cc801360df",
              "label": null,
              "isExecuted": false,
              "uuid": "5eaa7c5e-848b-42ee-bc21-a33e47738c0f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elasticsearch hunt times -> a",
              "targetStep": "/api/3/workflow_steps/2f6e2fee-cc91-4777-a7d6-b121d3726990",
              "sourceStep": "/api/3/workflow_steps/7d5e91b5-f322-4016-9c59-8ba56ddc7607",
              "label": null,
              "isExecuted": false,
              "uuid": "b38dcccf-b855-4b5c-8401-3e6a1afb38ee"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Retrieve key modification query results -> Copy  of Create and Link Alert",
              "targetStep": "/api/3/workflow_steps/c9632034-c51a-4bcf-9177-1ab91fd69383",
              "sourceStep": "/api/3/workflow_steps/b1f606e8-dec4-4c65-b668-dc17cab8b5f4",
              "label": null,
              "isExecuted": false,
              "uuid": "2578386b-e79a-4f20-b4e3-77e74ab45543"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic Copy of Create and Link Alert -> Deduplicate comments",
              "targetStep": "/api/3/workflow_steps/85bf3611-816d-407f-9b76-b4a8fb5932e9",
              "sourceStep": "/api/3/workflow_steps/a27ca441-204e-4ed8-a2a2-4d85bbefe599",
              "label": null,
              "isExecuted": false,
              "uuid": "19b2eb15-f7fa-4cfe-95c9-6bddc42c6a59"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic Create and Link Alert -> Deduplicate comments",
              "targetStep": "/api/3/workflow_steps/85bf3611-816d-407f-9b76-b4a8fb5932e9",
              "sourceStep": "/api/3/workflow_steps/e31f56b9-4267-4487-93b8-9fd1933a6d2c",
              "label": null,
              "isExecuted": false,
              "uuid": "aedb524e-4e98-4d92-b544-598d90f63fe3"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Query for use of attrib to hide files -> Copy  of Query for use of attrib to hide files",
              "targetStep": "/api/3/workflow_steps/30fa23ba-6baf-414e-8030-345cbc520353",
              "sourceStep": "/api/3/workflow_steps/d67a0aa3-ea21-49f2-a9cb-5a09aeba2810",
              "label": null,
              "isExecuted": false,
              "uuid": "5f710c3b-9ddb-48a2-ac2c-89775fa71406"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Select SIEM -> Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/6f0ff634-d9c8-4649-b97a-a3cc801360df",
              "sourceStep": "/api/3/workflow_steps/defa2458-166c-4037-8779-c36eeeccc22c",
              "label": "Splunk",
              "isExecuted": false,
              "uuid": "d8acbd9c-353e-4f30-8647-3ae7dcf7fecc"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic Query for processes spawned by Netsh -> Copy  of Create and Link Alert",
              "targetStep": "/api/3/workflow_steps/e31f56b9-4267-4487-93b8-9fd1933a6d2c",
              "sourceStep": "/api/3/workflow_steps/2f6e2fee-cc91-4777-a7d6-b121d3726990",
              "label": null,
              "isExecuted": false,
              "uuid": "7857f587-4b43-4bcb-873a-9702f1e0b38f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Select SIEM",
              "targetStep": "/api/3/workflow_steps/defa2458-166c-4037-8779-c36eeeccc22c",
              "sourceStep": "/api/3/workflow_steps/49b53f31-144f-4a8c-9991-3ba03d4267c9",
              "label": null,
              "isExecuted": false,
              "uuid": "a54dc5ab-751a-4699-8013-ad098bd82249"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Retrieve query results -> Create and Link Alert",
              "targetStep": "/api/3/workflow_steps/d3936adc-3f23-4e4d-bec7-6f67c41256bc",
              "sourceStep": "/api/3/workflow_steps/30fa23ba-6baf-414e-8030-345cbc520353",
              "label": null,
              "isExecuted": false,
              "uuid": "47ab40ff-40d7-4570-8245-eecac1f3e6fa"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elasticsearch hunt times -> Elastic Query for Netsh helper DLL registry key modification",
              "targetStep": "/api/3/workflow_steps/b2cd09f2-e17f-4c12-99a8-2a6b459f4fc9",
              "sourceStep": "/api/3/workflow_steps/7d5e91b5-f322-4016-9c59-8ba56ddc7607",
              "label": null,
              "isExecuted": false,
              "uuid": "9234f182-a799-4a8b-bd9c-24d69171cffb"
            }
          ],
          "priority": null,
          "uuid": "43be338a-1b12-4fed-836e-8206014cb2ea",
          "recordTags": [],
          "id": 117,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214963,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215024,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "HUNTS - Hidden Files and Directories (T1564.001)",
          "aliasName": null,
          "tag": "ATT&CK, Persistence, Defense_Evasion, Hidden_Files",
          "description": "Hunts for the use of attrib.exe to hide files.",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/a54055a4-be90-40d5-9bf4-1dc4e137d98c",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/5476800c-cd38-485f-91c5-a1edce86aaf0",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Retrieve_query_results.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query indicated attrib.exe was used to make a file or directory hidden on {{vars.item.host}} at {{vars.item.TimeCreated}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-Hidden Files and Directories-Attrib used to hide {{vars.item.CommandLine | regex_search('(?<=\\+h\\s)[^\\\\\\/:*?\"<>|\\r\\n]+$')}}",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "Hidden Files and Directories (attrib.exe)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.vendor_product}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "Attrib.exe was used to make a file or directory hidden. This could be an attempt by an adversary to hide files or directories in an attempt to conceal tools or data. This technique may be used to achieve persistence or evade superficial analysis and detection. The file or directory being hidden by attrib.exe should be evaluated to determine its legitimacy.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1158",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "250",
              "left": "1400",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "71462f03-1497-4e30-b757-97f39102805c",
              "id": 658
            },
            {
              "@type": "WorkflowStep",
              "name": "Query for use of attrib to hide files",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "9ab494b3-68d1-424f-9f76-0693bd787483",
                "params": {
                  "query": "index=sysmon EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} (Image=\"C:\\\\Windows\\\\System32\\\\attrib.exe\" OR Image=\"C:\\\\Windows\\\\SysWOW64\\\\attrib.exe\") AND CommandLine=\"*+h*\"  | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid EventChannel UtcTime Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"A\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "252",
              "left": "840",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "acc33264-b7bc-4805-b212-f0c9ad0eeae9",
              "id": 659
            },
            {
              "@type": "WorkflowStep",
              "name": "Which SIEM",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "step_iri": "/api/3/workflow_steps/29d11398-e056-4295-bd6b-8c93acaed2b0",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Elastic\" }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/1ec6610b-ab74-4831-b72c-6038f64a983b",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Splunk\" }}"
                  }
                ]
              },
              "status": null,
              "top": "312",
              "left": "280",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "42cb9f47-7ac9-4187-92b1-69a3456e9ae0",
              "id": 660
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Elastic hunt times",
              "description": null,
              "arguments": {
                "elasticHuntEnd": "{% if vars.input.records[0].huntEnd %} {{ arrow.get(vars.input.records[0].huntEnd).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }} {% else %} now {% endif %}",
                "elasticHuntStart": "{{ arrow.get(vars.input.records[0].huntStart).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }}"
              },
              "status": null,
              "top": "370",
              "left": "571",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "29d11398-e056-4295-bd6b-8c93acaed2b0",
              "id": 661
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Elastic Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_Query_for_use_of_attrib_to_hide_files.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query indicated attrib.exe was used to make a file or directory hidden on {{vars.item._source.computer_name}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-Hidden Files and Directories-Attrib used to hide {{vars.item._source.event_data.CommandLine | regex_search('(?<=\\+h\\s)[^\\\\\\/:*?\"<>|\\r\\n]+$')}}",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "Hidden Files and Directories (attrib.exe)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "Attrib.exe was used to make a file or directory hidden. This could be an attempt by an adversary to hide files or directories in an attempt to conceal tools or data. This technique may be used to achieve persistence or evade superficial analysis and detection. The file or directory being hidden by attrib.exe should be evaluated to determine its legitimacy.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1158",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "369",
              "left": "1400",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "10045323-d14d-425d-9465-01348aa28601",
              "id": 662
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic Query for use of attrib to hide files",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:\"1\" AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND (image_path:\"C:\\\\Windows\\\\System32\\\\attrib.exe\" OR image_path:\"C:\\\\Windows\\\\SysWOW64\\\\attrib.exe\") AND event_data.CommandLine:\"*+h*\"",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "369",
              "left": "840",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "32427545-868f-4f79-b9dd-8a2b136ef1f7",
              "id": 663
            },
            {
              "@type": "WorkflowStep",
              "name": "Deduplicate comments",
              "description": null,
              "arguments": {
                "arguments": {
                  "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
              },
              "status": null,
              "top": "309",
              "left": "1694",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "879a44a1-4fad-46df-8434-70baad768403",
              "id": 664
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "49535df9-e10a-4a73-ae37-219c894ccfb5",
                "title": "T1564.001 - Hunt for Hidden Files and Directories",
                "resources": [
                  "hunt"
                ],
                "inputVariables": [
                  {
                    "name": "siem",
                    "type": "picklists",
                    "label": "SIEM",
                    "title": "Picklist",
                    "usable": true,
                    "tooltip": "Choose your SIEM",
                    "dataType": "picklist",
                    "formType": "picklist",
                    "required": true,
                    "_expanded": true,
                    "mmdUpdate": true,
                    "collection": false,
                    "dataSource": {
                      "model": "picklists",
                      "query": {
                        "sort": [
                          {
                            "field": "orderIndex",
                            "direction": "ASC"
                          }
                        ],
                        "logic": "AND",
                        "filters": [
                          {
                            "field": "listName__name",
                            "value": "SIEMs",
                            "operator": "eq"
                          }
                        ]
                      },
                      "displayConditions": {
                        "876c1483-416b-4d2f-8138-15769ae16d5c": {
                          "conditions": null,
                          "visibility": "visible"
                        },
                        "bcebcab1-3f93-468a-9f3f-91e5c511a0b5": {
                          "conditions": null,
                          "visibility": "visible"
                        }
                      }
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "_nameTouched": true,
                    "defaultValue": {
                      "id": 280,
                      "@id": "/api/3/picklists/876c1483-416b-4d2f-8138-15769ae16d5c",
                      "icon": null,
                      "@type": "Picklist",
                      "color": null,
                      "display": "Elastic",
                      "listName": "/api/3/picklist_names/98830189-afff-40e6-bed1-94012551dc67",
                      "itemValue": "Elastic",
                      "orderIndex": 1
                    },
                    "displayTemplate": "{{ itemValue }}",
                    "lengthConstraint": false,
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "siem": "{{vars.request.data[\"siem\"]}}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "hunt": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "313",
              "left": "9",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "5476800c-cd38-485f-91c5-a1edce86aaf0",
              "id": 665
            },
            {
              "@type": "WorkflowStep",
              "name": "Retrieve query results",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "9ab494b3-68d1-424f-9f76-0693bd787483",
                "params": {
                  "sid": "{'value':\"{{vars.steps.Query_for_use_of_attrib_to_hide_files.data.sid}}\"}",
                  "additional_args": "{\"A\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "251",
              "left": "1120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "dc9c17b4-2094-413f-8890-8d1ef279fed0",
              "id": 666
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Splunk hunt times",
              "description": null,
              "arguments": {
                "splunkHuntEnd": "{% if vars.input.records[0].huntEnd %}latest={{vars.input.records[0].huntEnd}}{% endif %}",
                "splunkHuntStart": "earliest={{vars.input.records[0].huntStart}}"
              },
              "status": null,
              "top": "253",
              "left": "571",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "1ec6610b-ab74-4831-b72c-6038f64a983b",
              "id": 667
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Elastic Alert -> Deduplicate comments",
              "targetStep": "/api/3/workflow_steps/879a44a1-4fad-46df-8434-70baad768403",
              "sourceStep": "/api/3/workflow_steps/10045323-d14d-425d-9465-01348aa28601",
              "label": null,
              "isExecuted": false,
              "uuid": "74bed78e-bdfd-45b9-80e6-537cc9604ce1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Query for use of attrib to hide files",
              "targetStep": "/api/3/workflow_steps/acc33264-b7bc-4805-b212-f0c9ad0eeae9",
              "sourceStep": "/api/3/workflow_steps/1ec6610b-ab74-4831-b72c-6038f64a983b",
              "label": null,
              "isExecuted": false,
              "uuid": "3fcc6466-797c-41e1-b8e3-de9a4ef3d27c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Which SIEM",
              "targetStep": "/api/3/workflow_steps/42cb9f47-7ac9-4187-92b1-69a3456e9ae0",
              "sourceStep": "/api/3/workflow_steps/5476800c-cd38-485f-91c5-a1edce86aaf0",
              "label": null,
              "isExecuted": false,
              "uuid": "d2509e20-1c3f-493c-9e7a-f3357469a06c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Copy  of Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/29d11398-e056-4295-bd6b-8c93acaed2b0",
              "sourceStep": "/api/3/workflow_steps/42cb9f47-7ac9-4187-92b1-69a3456e9ae0",
              "label": "",
              "isExecuted": false,
              "uuid": "c6dbdde5-dbd6-46c5-bb8e-d5851363b15a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert -> Deduplicate comments",
              "targetStep": "/api/3/workflow_steps/879a44a1-4fad-46df-8434-70baad768403",
              "sourceStep": "/api/3/workflow_steps/71462f03-1497-4e30-b757-97f39102805c",
              "label": null,
              "isExecuted": false,
              "uuid": "d805f793-6632-41d2-a960-da3134f8548d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> Elastic Query for use of attrib to hide files",
              "targetStep": "/api/3/workflow_steps/32427545-868f-4f79-b9dd-8a2b136ef1f7",
              "sourceStep": "/api/3/workflow_steps/29d11398-e056-4295-bd6b-8c93acaed2b0",
              "label": null,
              "isExecuted": false,
              "uuid": "f2a51411-e0ee-4ca9-86bd-009d7eb98a65"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic Query for use of attrib to hide files -> Create and Link Elastic Alert",
              "targetStep": "/api/3/workflow_steps/10045323-d14d-425d-9465-01348aa28601",
              "sourceStep": "/api/3/workflow_steps/32427545-868f-4f79-b9dd-8a2b136ef1f7",
              "label": null,
              "isExecuted": false,
              "uuid": "b8623e4b-9398-4b26-9175-47febaf4568a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/1ec6610b-ab74-4831-b72c-6038f64a983b",
              "sourceStep": "/api/3/workflow_steps/42cb9f47-7ac9-4187-92b1-69a3456e9ae0",
              "label": "",
              "isExecuted": false,
              "uuid": "7bc92ab7-05d1-4b4b-8ac8-81d2b2bf000a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Retrieve query results -> Create and Link Alert",
              "targetStep": "/api/3/workflow_steps/71462f03-1497-4e30-b757-97f39102805c",
              "sourceStep": "/api/3/workflow_steps/dc9c17b4-2094-413f-8890-8d1ef279fed0",
              "label": null,
              "isExecuted": false,
              "uuid": "990589cf-4742-408a-b348-430be16bdb6d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Query for use of attrib to hide files -> Copy  of Query for use of attrib to hide files",
              "targetStep": "/api/3/workflow_steps/dc9c17b4-2094-413f-8890-8d1ef279fed0",
              "sourceStep": "/api/3/workflow_steps/acc33264-b7bc-4805-b212-f0c9ad0eeae9",
              "label": null,
              "isExecuted": false,
              "uuid": "1a22dfda-91c2-427e-b126-e1989ad21ba1"
            }
          ],
          "priority": null,
          "uuid": "936fcc0f-6bae-41b4-abd6-348d62279f88",
          "recordTags": [],
          "id": 118,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214963,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215024,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "HUNTS - Screensaver (T1546.002)",
          "aliasName": null,
          "tag": "ATT&CK, Persistence, Screensaver",
          "description": "Hunts for use of Windows Screensaver to enable attacker persistence. Hunts for abnormal screensaver executions, processes spawned by a screensaver, and abnormal modifications to screensaver registry keys.",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/a54055a4-be90-40d5-9bf4-1dc4e137d98c",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/16f56c2e-9ce3-41ec-a00d-da3833ef0afb",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Select SIEM",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Elastic",
                    "step_iri": "/api/3/workflow_steps/21ef595e-cc86-4202-9216-601231e78189",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Elastic\" }}"
                  },
                  {
                    "option": "Splunk",
                    "step_iri": "/api/3/workflow_steps/604def40-cd56-40c2-bfaa-4d4ff441ae08",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Splunk\" }}"
                  }
                ]
              },
              "status": null,
              "top": "300",
              "left": "340",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "3be12990-10f6-4244-9298-600f597aeaa0",
              "id": 668
            },
            {
              "@type": "WorkflowStep",
              "name": "Query for modification of scrnsave_exe registry key using reg_exe",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=sysmon EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} (Image=\"C:\\\\Windows\\\\System32\\\\reg.exe\" OR Image=\"C:\\\\Windows\\\\SysWOW64\\\\reg.exe\") AND (CommandLine=\"reg*add*\\\"HKCU\\\\Control Panel\\\\Desktop\\\"*/v*\\\"SCRNSAVE.EXE\\\"*\" OR CommandLine=\"reg*add*\\\"HKEY_CURRENT_USER\\\\Control Panel\\\\Desktop\\\"*/v*\\\"SCRNSAVE.EXE\\\"*\")   | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "160",
              "left": "928",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "221d4819-2352-43c2-aafa-9bf6e968c723",
              "id": 669
            },
            {
              "@type": "WorkflowStep",
              "name": "Copy  of Create and Link Alert2",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_Query_for_modification_of_scrnsave_exe_registry_key_using_reg_exe.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM queried for Sysmon logs indicating the scrnsave.exe Registry key was modified via reg.exe on host {{vars.item._source.beat.hostname}}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-Screensaver-{{vars.item._source.image_path.split(\"\\\\\")[-1] }} modified screensaver Registry key",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "Screensaver-Registry Key Modification for Persistence",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "An attempt to modify the scrnsave.exe Registry key using reg.exe was observed. This is potentially indicative of an adversary establishing persistence by setting the screensaver to execute malware after a user or device has been inactive for a set period of time. The contents of the command line arguments should be evaluated and the host where this command was executed should be investigated for signs of compromise.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1180",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "430",
              "left": "1208",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "1182e350-8f56-4899-9dd3-9e51cc5a18f2",
              "id": 670
            },
            {
              "@type": "WorkflowStep",
              "name": "Copy of Create and Link Alert1",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_Query_for_modification_of_scrnsave_exe_registry_key_using_powershell.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM queried for Sysmon logs indicating the scrnsave.exe Registry key was modified using Powershell on host {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-Screensaver-{{vars.item._source.image_path.split(\"\\\\\")[-1] }} modified screensaver Registry key",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "Screensaver-Registry Key Modification for Persistence",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "An attempt to modify the scrnsave.exe Registry key using Powershell was observed. This is potentially indicative of an adversary establishing persistence by setting the screensaver to execute malware after a user or device has been inactive for a set period of time. The contents of the command line arguments should be evaluated and the host where this command was executed should be investigated for signs of compromise.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1180",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "340",
              "left": "1207",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "4491e7b1-4eb2-4838-aa6f-bf332e27fe34",
              "id": 671
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic Query for modification of scrnsave_exe registry key using reg_exe",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:\"1\" AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND (image_path:C\\:\\\\Windows\\\\SysWOW64\\\\reg.exe OR image_path:C\\:\\\\Windows\\\\System32\\\\reg.exe) AND (image_path:C\\:\\\\Windows\\\\SysWOW64\\\\reg.exe OR image_path:C\\:\\\\Windows\\\\System32\\\\reg.exe) AND event_data.CommandLine:reg*add\\ \\\"HK*\\\\Control\\ Panel*\\\\Desktop\\\"\\ \\/v*\"SCRNSAVE.EXE\"*",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "430",
              "left": "927",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "3601bd56-895b-4db3-8f02-f8c64891aac0",
              "id": 672
            },
            {
              "@type": "WorkflowStep",
              "name": "Query for modification of scrnsave_exe registry key using powershell",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=sysmon EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} CommandLine=\"*New-ItemProperty*-Path*\\\"HKCU:\\\\Control Panel\\\\Desktop\\\"*-Name*\\\"SCRNSAVE.EXE\\\"*\" | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "80",
              "left": "927",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "ae54984e-aac2-4229-8114-0f646031e6cd",
              "id": 673
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic Query for modification of scrnsave_exe registry key using powershell",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:\"1\" AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND event_data.CommandLine:*New-ItemProperty*-Path*\\\"HKCU\\:\\\\Control\\ Panel\\\\Desktop\\\"\\ -Name\\ \\\"SCRNSAVE.EXE\\\"*",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "340",
              "left": "928",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "ae2b6fa9-922c-416d-af4b-1b7da63843da",
              "id": 674
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert2",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.get_results_reg.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM queried for Sysmon logs indicating the scrnsave.exe Registry key was modified via reg.exe on host {{vars.item.host}} at {{vars.item.UtcTime}} and generated Alerts from the search results.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-Screensaver-{{vars.item.process_exec}} modified screensaver Registry key",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "Screensaver-Registry Key Modification for Persistence",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.vendor_product}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "An attempt to modify the scrnsave.exe Registry key using reg.exe was observed. This is potentially indicative of an adversary establishing persistence by setting the screensaver to execute malware after a user or device has been inactive for a set period of time. The contents of the command line arguments should be evaluated and the host where this command was executed should be investigated for signs of compromise.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1180",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "160",
              "left": "1472",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "1fdacbb5-5a3e-4ff7-9370-c30ffe35f54a",
              "id": 675
            },
            {
              "@type": "WorkflowStep",
              "name": "Copy  of Deduplicate Comments",
              "description": null,
              "arguments": {
                "arguments": {
                  "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
              },
              "status": null,
              "top": "420",
              "left": "1740",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "5a5d5695-abb5-494a-bcb5-9004e04b94e3",
              "id": 676
            },
            {
              "@type": "WorkflowStep",
              "name": "Deduplicate Comments",
              "description": null,
              "arguments": {
                "arguments": {
                  "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
              },
              "status": null,
              "top": "160",
              "left": "1766",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "38a84c80-eb2a-4cac-a9c4-3b1742a90ee1",
              "id": 677
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert1",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.get_results_powershell.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM queried for Sysmon logs indicating the scrnsave.exe Registry key was modified using Powershell on host {{vars.item.host}} at {{vars.item.UtcTime}} and generated Alerts from the search results.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-Screensaver-{{vars.item.process_exec}} modified screensaver Registry key",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "Screensaver-Registry Key Modification for Persistence",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.vendor_product}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "An attempt to modify the scrnsave.exe Registry key using Powershell was observed. This is potentially indicative of an adversary establishing persistence by setting the screensaver to execute malware after a user or device has been inactive for a set period of time. The contents of the command line arguments should be evaluated and the host where this command was executed should be investigated for signs of compromise.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1180",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "80",
              "left": "1470",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "5f4bff5f-09e8-4ed9-84cf-18c7e7e703bd",
              "id": 686
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "1795cad1-8269-419f-b5ff-b1019ef3919e",
                "title": "T1546.002 - Hunt for Screensaver",
                "resources": [
                  "hunt"
                ],
                "inputVariables": [
                  {
                    "name": "siem",
                    "type": "picklists",
                    "label": "SIEM",
                    "title": "Picklist",
                    "usable": true,
                    "_ignore": false,
                    "tooltip": "Choose your SIEM",
                    "dataType": "picklist",
                    "formType": "picklist",
                    "required": true,
                    "_expanded": true,
                    "collection": false,
                    "dataSource": {
                      "model": "picklists",
                      "query": {
                        "sort": [
                          {
                            "field": "orderIndex",
                            "direction": "ASC"
                          }
                        ],
                        "logic": "AND",
                        "filters": [
                          {
                            "field": "listName__name",
                            "value": "SIEMs",
                            "operator": "eq"
                          }
                        ]
                      },
                      "displayConditions": {
                        "876c1483-416b-4d2f-8138-15769ae16d5c": {
                          "conditions": null,
                          "visibility": "visible"
                        },
                        "bcebcab1-3f93-468a-9f3f-91e5c511a0b5": {
                          "conditions": null,
                          "visibility": "visible"
                        }
                      }
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "_nameTouched": true,
                    "defaultValue": {
                      "id": 280,
                      "@id": "/api/3/picklists/876c1483-416b-4d2f-8138-15769ae16d5c",
                      "icon": null,
                      "@type": "Picklist",
                      "color": null,
                      "display": "Elastic",
                      "listName": "/api/3/picklist_names/98830189-afff-40e6-bed1-94012551dc67",
                      "itemValue": "Elastic",
                      "orderIndex": 1
                    },
                    "useModuleField": false,
                    "displayTemplate": "{{ itemValue }}",
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "siem": "{{vars.request.data[\"siem\"]}}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "hunt": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "300",
              "left": "72",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "16f56c2e-9ce3-41ec-a00d-da3833ef0afb",
              "id": 678
            },
            {
              "@type": "WorkflowStep",
              "name": "get results powershell",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Query_for_modification_of_scrnsave_exe_registry_key_using_powershell.data.sid}}\"}",
                  "additional_args": "{\"A\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "80",
              "left": "1200",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "455ca1d9-8244-4c0b-9f8b-6c166dc81aca",
              "id": 679
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Splunk hunt times",
              "description": null,
              "arguments": {
                "splunkHuntEnd": "{% if vars.input.records[0].huntEnd %}latest={{vars.input.records[0].huntEnd}}{% endif %}",
                "splunkHuntStart": "earliest={{vars.input.records[0].huntStart}}"
              },
              "status": null,
              "top": "160",
              "left": "633",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "604def40-cd56-40c2-bfaa-4d4ff441ae08",
              "id": 680
            },
            {
              "@type": "WorkflowStep",
              "name": "get results scr",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Query_for_scr_file_executed_outside_of_system32_or_syswow64.data.sid}}\"}",
                  "additional_args": "{\"A\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "240",
              "left": "1200",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "c5486359-1780-4044-9e33-a70f17c323de",
              "id": 681
            },
            {
              "@type": "WorkflowStep",
              "name": "get results reg",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Query_for_modification_of_scrnsave_exe_registry_key_using_reg_exe.data.sid}}\"}",
                  "additional_args": "{\"A\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "160",
              "left": "1200",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "03baaa3f-0211-4ad5-8865-81953841883f",
              "id": 682
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic Query for scr file executed outside of system32 or syswow64",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:\"1\" AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND image_path:\"*.scr\" NOT(image_path:\"C:\\\\Windows\\\\System32\\\\*\" OR image_path:\"C:\\\\Windows\\\\SysWOW64\\\\*\")",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "520",
              "left": "929",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "b8966027-023d-4e8c-95ce-3100548c1af3",
              "id": 683
            },
            {
              "@type": "WorkflowStep",
              "name": "Copy  of Create and Link Alert3",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_Query_for_scr_file_executed_outside_of_system32_or_syswow64.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM queried for Sysmon logs indicating an .scr file was executed from a nonstandard directory on host {{vars.item._source.beat.hostname}} at {{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-Screensaver-{{vars.item._source.image_path.split(\"\\\\\")[-1] }} executed as an .SCR file by {{vars.item._source.parent_image_path.split(\"\\\\\")[-1] }}",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "Screensaver-.scr File Executed",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "An attempt to execute a screensaver file (.scr) from a nonstandard directory was observed. Screensaver files are portable executables that are stored in specific directories in a traditional Windows environment. Execution of a .scr file from outside those directories is suspicious and the host that generated this alert should be investigated for signs of compromise.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1180",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "520",
              "left": "1208",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "39228db9-d01e-4593-a26c-81f8447cf60a",
              "id": 684
            },
            {
              "@type": "WorkflowStep",
              "name": "Query for scr file executed outside of system32 or syswow64",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=sysmon EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} Image=\"*.scr\" Image!=\"C:\\\\Windows\\\\System32\\\\*.scr\" Image!=\"C:\\\\Windows\\\\SysWOW64\\\\*.scr\"  | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "240",
              "left": "929",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "53e05105-fb46-4bd9-a9cb-c1fc448d29a3",
              "id": 685
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert3",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.get_results_scr.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM queried for Sysmon logs indicating an .scr file was executed from a nonstandard directory on host {{vars.item.host}} at {{vars.item.UtcTime}} and generated Alerts from the search results.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-Screensaver-{{vars.item.process_exec}} executed as an .SCR file by {{vars.item.ParentImage.split(\"\\\\\")[-1]}}",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "Screensaver-.scr File Executed",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.vendor_product}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "An attempt to execute a screensaver file (.scr) from a nonstandard directory was observed. Screensaver files are portable executables that are stored in specific directories in a traditional Windows environment. Execution of a .scr file from outside those directories is suspicious and the host that generated this alert should be investigated for signs of compromise.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1180",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "240",
              "left": "1471",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "92ce3cb4-7454-402a-9260-ac22c8c2b6c4",
              "id": 687
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Elasticsearch hunt times",
              "description": null,
              "arguments": {
                "elasticHuntEnd": "{% if vars.input.records[0].huntEnd %} {{ arrow.get(vars.input.records[0].huntEnd).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }} {% else %} now {% endif %}",
                "elasticHuntStart": "{{ arrow.get(vars.input.records[0].huntStart).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }}"
              },
              "status": null,
              "top": "430",
              "left": "630",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "21ef595e-cc86-4202-9216-601231e78189",
              "id": 688
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Select SIEM",
              "targetStep": "/api/3/workflow_steps/3be12990-10f6-4244-9298-600f597aeaa0",
              "sourceStep": "/api/3/workflow_steps/16f56c2e-9ce3-41ec-a00d-da3833ef0afb",
              "label": null,
              "isExecuted": false,
              "uuid": "a67aad1d-6a3b-4fc2-bb32-ab500c9c633b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert1 -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/38a84c80-eb2a-4cac-a9c4-3b1742a90ee1",
              "sourceStep": "/api/3/workflow_steps/5f4bff5f-09e8-4ed9-84cf-18c7e7e703bd",
              "label": null,
              "isExecuted": false,
              "uuid": "e2294f36-1012-41f5-b1aa-f3ada411bc0c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Query for modification of scrnsave_exe registry key using reg_exe -> get results reg",
              "targetStep": "/api/3/workflow_steps/03baaa3f-0211-4ad5-8865-81953841883f",
              "sourceStep": "/api/3/workflow_steps/221d4819-2352-43c2-aafa-9bf6e968c723",
              "label": null,
              "isExecuted": false,
              "uuid": "97d9a2c6-9b08-4c67-98b1-1ae417af0cec"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic Query for modification of scrnsave_exe registry key using powershell -> Copy  of Create and Link Alert1",
              "targetStep": "/api/3/workflow_steps/4491e7b1-4eb2-4838-aa6f-bf332e27fe34",
              "sourceStep": "/api/3/workflow_steps/ae2b6fa9-922c-416d-af4b-1b7da63843da",
              "label": null,
              "isExecuted": false,
              "uuid": "8930d031-ab58-42b1-ba30-a2a0bc648843"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert2 -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/38a84c80-eb2a-4cac-a9c4-3b1742a90ee1",
              "sourceStep": "/api/3/workflow_steps/1fdacbb5-5a3e-4ff7-9370-c30ffe35f54a",
              "label": null,
              "isExecuted": false,
              "uuid": "05693c1c-dabc-4b31-8bbd-73982035eec9"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic Query for modification of scrnsave_exe registry key using reg_exe -> Copy  of Create and Link Alert2",
              "targetStep": "/api/3/workflow_steps/1182e350-8f56-4899-9dd3-9e51cc5a18f2",
              "sourceStep": "/api/3/workflow_steps/3601bd56-895b-4db3-8f02-f8c64891aac0",
              "label": null,
              "isExecuted": false,
              "uuid": "6c7317da-5ab9-4d6e-9227-bfee1bdab1ae"
            },
            {
              "@type": "WorkflowRoute",
              "name": "get results powershell -> Create Splunk Alert",
              "targetStep": "/api/3/workflow_steps/5f4bff5f-09e8-4ed9-84cf-18c7e7e703bd",
              "sourceStep": "/api/3/workflow_steps/455ca1d9-8244-4c0b-9f8b-6c166dc81aca",
              "label": null,
              "isExecuted": false,
              "uuid": "8aa5c748-12f4-488f-9fb0-03623028120c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy of Create and Link Alert1 -> Copy  of Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/5a5d5695-abb5-494a-bcb5-9004e04b94e3",
              "sourceStep": "/api/3/workflow_steps/4491e7b1-4eb2-4838-aa6f-bf332e27fe34",
              "label": null,
              "isExecuted": false,
              "uuid": "c7348237-d94d-4ec1-9ac2-db2df57cee9b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Select SIEM -> Set Elasticsearch hunt times",
              "targetStep": "/api/3/workflow_steps/21ef595e-cc86-4202-9216-601231e78189",
              "sourceStep": "/api/3/workflow_steps/3be12990-10f6-4244-9298-600f597aeaa0",
              "label": "Elastic",
              "isExecuted": false,
              "uuid": "06665bbe-0f1c-4f9e-a247-14e55d83ba40"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create and Link Alert2 -> Copy  of Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/5a5d5695-abb5-494a-bcb5-9004e04b94e3",
              "sourceStep": "/api/3/workflow_steps/1182e350-8f56-4899-9dd3-9e51cc5a18f2",
              "label": null,
              "isExecuted": false,
              "uuid": "5092350f-13ec-4aff-83a0-52ca1b71acd3"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Query for modification of scrnsave_exe registry key using powershell -> a",
              "targetStep": "/api/3/workflow_steps/455ca1d9-8244-4c0b-9f8b-6c166dc81aca",
              "sourceStep": "/api/3/workflow_steps/ae54984e-aac2-4229-8114-0f646031e6cd",
              "label": null,
              "isExecuted": false,
              "uuid": "8447672a-7530-4ec2-aa4a-a35956f26a70"
            },
            {
              "@type": "WorkflowRoute",
              "name": "get results scr -> Copy 1 of Create Splunk Alert Powershell",
              "targetStep": "/api/3/workflow_steps/92ce3cb4-7454-402a-9260-ac22c8c2b6c4",
              "sourceStep": "/api/3/workflow_steps/c5486359-1780-4044-9e33-a70f17c323de",
              "label": null,
              "isExecuted": false,
              "uuid": "f869facb-9452-4ba4-bd42-5fe45fda8d79"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Query for scr file executed outside of system32 or syswow64 -> Copy  of get results reg",
              "targetStep": "/api/3/workflow_steps/c5486359-1780-4044-9e33-a70f17c323de",
              "sourceStep": "/api/3/workflow_steps/53e05105-fb46-4bd9-a9cb-c1fc448d29a3",
              "label": null,
              "isExecuted": false,
              "uuid": "c33d7576-4152-4eaf-a79e-7cd64587bb44"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Query for modification of scrnsave_exe registry key using powershell",
              "targetStep": "/api/3/workflow_steps/ae54984e-aac2-4229-8114-0f646031e6cd",
              "sourceStep": "/api/3/workflow_steps/604def40-cd56-40c2-bfaa-4d4ff441ae08",
              "label": null,
              "isExecuted": false,
              "uuid": "094a3582-42f6-45a4-a721-79235fe7ec9f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elasticsearch hunt times -> Elastic Query for modification of scrnsave_exe registry key using reg_exe",
              "targetStep": "/api/3/workflow_steps/3601bd56-895b-4db3-8f02-f8c64891aac0",
              "sourceStep": "/api/3/workflow_steps/21ef595e-cc86-4202-9216-601231e78189",
              "label": null,
              "isExecuted": false,
              "uuid": "9dfc7127-4197-4d56-90db-5742d18a5c4b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Query for modification of scrnsave_exe registry key using reg_exe",
              "targetStep": "/api/3/workflow_steps/221d4819-2352-43c2-aafa-9bf6e968c723",
              "sourceStep": "/api/3/workflow_steps/604def40-cd56-40c2-bfaa-4d4ff441ae08",
              "label": null,
              "isExecuted": false,
              "uuid": "1aca5e90-957e-429b-86d9-a2079eae2233"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create and Link Alert3 -> Copy  of Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/5a5d5695-abb5-494a-bcb5-9004e04b94e3",
              "sourceStep": "/api/3/workflow_steps/39228db9-d01e-4593-a26c-81f8447cf60a",
              "label": null,
              "isExecuted": false,
              "uuid": "3098c86b-def9-4aa4-a70a-2160d557e48a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "get results reg -> Copy  of Create Splunk Alert Reg",
              "targetStep": "/api/3/workflow_steps/1fdacbb5-5a3e-4ff7-9370-c30ffe35f54a",
              "sourceStep": "/api/3/workflow_steps/03baaa3f-0211-4ad5-8865-81953841883f",
              "label": null,
              "isExecuted": false,
              "uuid": "1997ad3f-14a7-44c6-9d55-71eb149a94bc"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elasticsearch hunt times -> Elastic Query for scr file executed outside of system32 or syswow64",
              "targetStep": "/api/3/workflow_steps/b8966027-023d-4e8c-95ce-3100548c1af3",
              "sourceStep": "/api/3/workflow_steps/21ef595e-cc86-4202-9216-601231e78189",
              "label": null,
              "isExecuted": false,
              "uuid": "ebc5cad9-f753-4314-8cfc-49449c2c6523"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert3 -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/38a84c80-eb2a-4cac-a9c4-3b1742a90ee1",
              "sourceStep": "/api/3/workflow_steps/92ce3cb4-7454-402a-9260-ac22c8c2b6c4",
              "label": null,
              "isExecuted": false,
              "uuid": "a2819326-68be-4951-b02b-98f8f47dfdd5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic Query for scr file executed outside of system32 or syswow64 -> Copy  of Create and Link Alert3",
              "targetStep": "/api/3/workflow_steps/39228db9-d01e-4593-a26c-81f8447cf60a",
              "sourceStep": "/api/3/workflow_steps/b8966027-023d-4e8c-95ce-3100548c1af3",
              "label": null,
              "isExecuted": false,
              "uuid": "bedca8d6-46ab-47fc-b4ec-dcc590d1af64"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elasticsearch hunt times -> Elastic Query for modification of scrnsave_exe registry key using powershell",
              "targetStep": "/api/3/workflow_steps/ae2b6fa9-922c-416d-af4b-1b7da63843da",
              "sourceStep": "/api/3/workflow_steps/21ef595e-cc86-4202-9216-601231e78189",
              "label": null,
              "isExecuted": false,
              "uuid": "2ef21734-5ab7-4877-ac52-0916ca855deb"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Select SIEM -> Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/604def40-cd56-40c2-bfaa-4d4ff441ae08",
              "sourceStep": "/api/3/workflow_steps/3be12990-10f6-4244-9298-600f597aeaa0",
              "label": "Splunk",
              "isExecuted": false,
              "uuid": "72c6c9de-7350-41cc-9934-8a2ab7653ba1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Query for scr file executed outside of system32 or syswow64",
              "targetStep": "/api/3/workflow_steps/53e05105-fb46-4bd9-a9cb-c1fc448d29a3",
              "sourceStep": "/api/3/workflow_steps/604def40-cd56-40c2-bfaa-4d4ff441ae08",
              "label": null,
              "isExecuted": false,
              "uuid": "421b778a-3204-4906-864e-e1e51598f101"
            }
          ],
          "priority": null,
          "uuid": "b299808a-71e2-4ba3-ab82-673f0844cf98",
          "recordTags": [],
          "id": 119,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214963,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215024,
          "owners": [],
          "isPrivate": false
        }
      ]
    },
    {
      "@type": "WorkflowCollection",
      "name": "13 - MITRE ATT&CK™ - Signed Binary Proxy Execution",
      "description": "Playbooks designed to hunt Signed Binary Proxy Execution Techniques identified in the MITRE ATT&CK Framework",
      "visible": true,
      "image": null,
      "uuid": "c3d3d88b-9ca9-4dfb-aa62-4b8685eec3b8",
      "id": 31,
      "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "createDate": 1629214964,
      "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "modifyDate": 1629214964,
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "HUNTS - Compiled HTML File (T1218.001)",
          "aliasName": null,
          "tag": "ATT&CK, Defense_Evasion, Execution, Compiled_HTML",
          "description": "Identifies processes spawned by hh.exe",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/c3d3d88b-9ca9-4dfb-aa62-4b8685eec3b8",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/73408675-3eb2-4bcc-83a1-777f95aadc90",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Set Splunk hunt times",
              "description": null,
              "arguments": {
                "splunkHuntEnd": "{% if vars.input.records[0].huntEnd %}latest={{vars.input.records[0].huntEnd}}{% endif %}",
                "splunkHuntStart": "earliest={{vars.input.records[0].huntStart}}"
              },
              "status": null,
              "top": "208",
              "left": "590",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "f6df5fcf-a8be-47a5-9baf-00d2d1ca2c93",
              "id": 740
            },
            {
              "@type": "WorkflowStep",
              "name": "Deduplicate Comments",
              "description": null,
              "arguments": {
                "arguments": {
                  "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
              },
              "status": null,
              "top": "260",
              "left": "1712",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "f98c8371-3887-4f77-8679-8488a312ae75",
              "id": 741
            },
            {
              "@type": "WorkflowStep",
              "name": "Which SIEM",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "step_iri": "/api/3/workflow_steps/87d570a0-522b-428e-9765-ea297adcf482",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Elastic\" }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/f6df5fcf-a8be-47a5-9baf-00d2d1ca2c93",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Splunk\" }}"
                  }
                ]
              },
              "status": null,
              "top": "253",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "ad5a1ba0-8197-4b16-be2a-b671fe0f9418",
              "id": 742
            },
            {
              "@type": "WorkflowStep",
              "name": "Splunk Query for Sysmon Compiled HTML",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=\"sysmon\" EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} ParentImage=\"C:\\\\windows\\\\hh.exe\" | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "209",
              "left": "869",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "80d24548-dadc-4432-9168-5c2a847f619f",
              "id": 743
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic Query for Sysmon Compiled HTML",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:\"1\" AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND parent_image_path:\"C:\\\\windows\\\\hh.exe\"",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "869",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "be1e890c-7892-43a1-9991-f9f58c38b608",
              "id": 744
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Splunk Alerts",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Results_for_Sysmon_Compiled_HTML.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query identified a Compiled HTML file spawning child process {{vars.item.process_exec}} on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-Compiled HTML-{{vars.item.process_exec}} spawned",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "Compiled HTML",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.EventChannel}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "An attempt by hh.exe to spawn a process was observed. Hh.exe can be used to execute compiled HTML (.chm) files. An adversary could craft a custom malicious .chm file and trick a user into executing it, potentially infecting the host. Any process spawned by hh.exe should be analyzed for malicious activity.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1223",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "209",
              "left": "1420",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "bf3fb1f4-443e-48b0-be3c-749ed2b30cd3",
              "id": 745
            },
            {
              "@type": "WorkflowStep",
              "name": "Hunt for Compiled HTML File",
              "description": null,
              "arguments": {
                "route": "73fbda06-27d6-4927-a766-b9e449f06163",
                "title": "T1218.001 - Hunt for Compiled HTML File",
                "resources": [
                  "hunt"
                ],
                "inputVariables": [
                  {
                    "name": "siem",
                    "type": "picklists",
                    "label": "SIEM",
                    "title": "Picklist",
                    "usable": true,
                    "tooltip": "Choose your SIEM",
                    "dataType": "picklist",
                    "formType": "picklist",
                    "required": true,
                    "_expanded": true,
                    "mmdUpdate": true,
                    "collection": false,
                    "dataSource": {
                      "model": "picklists",
                      "query": {
                        "sort": [
                          {
                            "field": "orderIndex",
                            "direction": "ASC"
                          }
                        ],
                        "logic": "AND",
                        "filters": [
                          {
                            "field": "listName__name",
                            "value": "SIEMs",
                            "operator": "eq"
                          }
                        ]
                      },
                      "displayConditions": {
                        "876c1483-416b-4d2f-8138-15769ae16d5c": {
                          "conditions": null,
                          "visibility": "visible"
                        },
                        "bcebcab1-3f93-468a-9f3f-91e5c511a0b5": {
                          "conditions": null,
                          "visibility": "visible"
                        }
                      }
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "_nameTouched": true,
                    "defaultValue": {
                      "id": 280,
                      "@id": "/api/3/picklists/876c1483-416b-4d2f-8138-15769ae16d5c",
                      "icon": null,
                      "@type": "Picklist",
                      "color": null,
                      "display": "Elastic",
                      "listName": "/api/3/picklist_names/98830189-afff-40e6-bed1-94012551dc67",
                      "itemValue": "Elastic",
                      "orderIndex": 1
                    },
                    "displayTemplate": "{{ itemValue }}",
                    "lengthConstraint": false,
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "siem": "{{vars.request.data[\"siem\"]}}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "hunt": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "252",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "73408675-3eb2-4bcc-83a1-777f95aadc90",
              "id": 746
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Elastic Alerts",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_Query_for_Sysmon_Compiled_HTML.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query identified a Compiled HTML file spawning child process {{vars.item._source.image_path.split(\"\\\\\")[-1] }} on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-Compiled HTML-{{vars.item._source.image_path.split(\"\\\\\")[-1]}} spawned",
                  "epochTime": "{{arrow.get(vars.item._source.event_data.UtcTime).timestamp}}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "Compiled HTML",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "An attempt by hh.exe to spawn a process was observed. Hh.exe can be used to execute compiled HTML (.chm) files. An adversary could craft a custom malicious .chm file and trick a user into executing it, potentially infecting the host. Any process spawned by hh.exe should be analyzed for malicious activity.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1223",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "300",
              "left": "1420",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "e984ab2a-6e9f-40d2-a76e-e631642ebb26",
              "id": 747
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Elastic hunt times",
              "description": null,
              "arguments": {
                "elasticHuntEnd": "{% if vars.input.records[0].huntEnd %} {{ arrow.get(vars.input.records[0].huntEnd).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }} {% else %} now {% endif %}",
                "elasticHuntStart": "{{ arrow.get(vars.input.records[0].huntStart).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }}"
              },
              "status": null,
              "top": "300",
              "left": "592",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "87d570a0-522b-428e-9765-ea297adcf482",
              "id": 748
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Results for Sysmon Compiled HTML",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{\"value\": \"{{vars.steps.Splunk_Query_for_Sysmon_Compiled_HTML.data.sid}}\"}",
                  "additional_args": "{\"a\":\"b\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "209",
              "left": "1147",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "785194cd-1dd5-4a8c-bac1-341d0f1b051e",
              "id": 749
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Splunk Query for Sysmon Compiled HTML",
              "targetStep": "/api/3/workflow_steps/80d24548-dadc-4432-9168-5c2a847f619f",
              "sourceStep": "/api/3/workflow_steps/f6df5fcf-a8be-47a5-9baf-00d2d1ca2c93",
              "label": null,
              "isExecuted": false,
              "uuid": "4c5aeb3c-5b95-40a8-9fa0-f793dd0a709c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Splunk Alerts -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/f98c8371-3887-4f77-8679-8488a312ae75",
              "sourceStep": "/api/3/workflow_steps/bf3fb1f4-443e-48b0-be3c-749ed2b30cd3",
              "label": null,
              "isExecuted": false,
              "uuid": "00e16fb8-4040-44ad-95e1-9978d43ef596"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Hunt for Compiled HTML -> Which SIEM",
              "targetStep": "/api/3/workflow_steps/ad5a1ba0-8197-4b16-be2a-b671fe0f9418",
              "sourceStep": "/api/3/workflow_steps/73408675-3eb2-4bcc-83a1-777f95aadc90",
              "label": null,
              "isExecuted": false,
              "uuid": "529218d5-dc47-40a8-bcec-78e5c07d620f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Copy  of Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/87d570a0-522b-428e-9765-ea297adcf482",
              "sourceStep": "/api/3/workflow_steps/ad5a1ba0-8197-4b16-be2a-b671fe0f9418",
              "label": "",
              "isExecuted": false,
              "uuid": "3c053589-ceec-4e58-aa01-63f256832ef0"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Results for Sysmon Compiled HTML -> Create Splunk Alerts",
              "targetStep": "/api/3/workflow_steps/bf3fb1f4-443e-48b0-be3c-749ed2b30cd3",
              "sourceStep": "/api/3/workflow_steps/785194cd-1dd5-4a8c-bac1-341d0f1b051e",
              "label": null,
              "isExecuted": false,
              "uuid": "6e530b89-098b-4418-9ed7-cbc7b1d97da3"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> Elastic Query for Sysmon Compiled HTML",
              "targetStep": "/api/3/workflow_steps/be1e890c-7892-43a1-9991-f9f58c38b608",
              "sourceStep": "/api/3/workflow_steps/87d570a0-522b-428e-9765-ea297adcf482",
              "label": null,
              "isExecuted": false,
              "uuid": "a12a6aed-e900-4119-a01b-1b1b87f7e38c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create Splunk Alerts -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/f98c8371-3887-4f77-8679-8488a312ae75",
              "sourceStep": "/api/3/workflow_steps/e984ab2a-6e9f-40d2-a76e-e631642ebb26",
              "label": null,
              "isExecuted": false,
              "uuid": "91967d61-2f3c-4238-bf00-1d0e509c5cbc"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Splunk Query for Sysmon Compiled HTML -> Get Results for Sysmon Compiled HTML",
              "targetStep": "/api/3/workflow_steps/785194cd-1dd5-4a8c-bac1-341d0f1b051e",
              "sourceStep": "/api/3/workflow_steps/80d24548-dadc-4432-9168-5c2a847f619f",
              "label": null,
              "isExecuted": false,
              "uuid": "f81c9ccb-8891-49f5-8a74-9fadd31eaad2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic Query for Sysmon Compiled HTML -> Copy  of Create Splunk Alerts",
              "targetStep": "/api/3/workflow_steps/e984ab2a-6e9f-40d2-a76e-e631642ebb26",
              "sourceStep": "/api/3/workflow_steps/be1e890c-7892-43a1-9991-f9f58c38b608",
              "label": null,
              "isExecuted": false,
              "uuid": "bd362695-db67-4136-b872-1841f3e3ac1b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/f6df5fcf-a8be-47a5-9baf-00d2d1ca2c93",
              "sourceStep": "/api/3/workflow_steps/ad5a1ba0-8197-4b16-be2a-b671fe0f9418",
              "label": "",
              "isExecuted": false,
              "uuid": "a270e866-7f0b-4e41-90d9-9803db5db680"
            }
          ],
          "priority": null,
          "uuid": "210b92ea-4286-429a-8bf2-9c55ac1e2999",
          "recordTags": [],
          "id": 124,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214964,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215041,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "HUNTS - Rundll32 (T1218.011)",
          "aliasName": null,
          "tag": "ATT&CK, Execution, Defense_Evasion, Rundll32",
          "description": "Identifies Processes spawned by rundll32.exe where the DLL loaded exists outside of System32/SysWOW64 or Program Files. This playbook may require additional tuning to reduce false positives.",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "sourceIP",
            "destinationIP",
            "processname",
            "processID",
            "processGUID",
            "parentprocessname",
            "parentprocessGUID",
            "accountname",
            "computername",
            "commandline",
            "sourcetool"
          ],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/c3d3d88b-9ca9-4dfb-aa62-4b8685eec3b8",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/d57164d0-0f07-435e-aa39-aca4ebc6d6ee",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Splunk query for Sysmon Rundll32",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=sysmon EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} ParentImage=\"C:\\\\Windows\\\\System32\\\\rundll32.exe\" OR ParentImage=\"C:\\\\Windows\\\\SysWOW64\\\\rundll32.exe\" Image!=\"C:\\\\Windows\\\\System32\\\\*\" Image!=\"C:\\\\Windows\\\\SysWOW64\\\\*\" Image!=\"C:\\\\Program Files \\(x86\\)\\\\*\" Image!=\"C:\\\\Program Files\\\\*\" | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "180",
              "left": "987",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "9363d125-856a-4092-9adf-6f3776b5e02f",
              "id": 750
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Results for Sysmon Rundll32",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Splunk_query_for_Sysmon_Rundll32.data.sid}}\"}",
                  "additional_args": "{\"a\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "180",
              "left": "1260",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "865cc7ca-f625-4457-9e7d-9ab8a090b959",
              "id": 751
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Splunk hunt times",
              "description": null,
              "arguments": {
                "splunkHuntEnd": "{% if vars.input.records[0].huntEnd %}latest={{vars.input.records[0].huntEnd}}{% endif %}",
                "splunkHuntStart": "earliest={{vars.input.records[0].huntStart}}"
              },
              "status": null,
              "top": "180",
              "left": "710",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "d8610806-64dd-453d-b2b8-9749e0a145d7",
              "id": 752
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic query for Sysmon Rundll32",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:\"1\" AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND (parent_image_path:\"C:\\\\Windows\\\\System32\\\\rundll32.exe\" OR parent_image_path:\"C:\\\\Windows\\\\SysWOW64\\\\rundll32.exe\") NOT (parent_image_path:\"C:\\\\Windows\\\\SysWOW64\\\\*\" OR parent_image_path:\"C:\\\\Program Files \\(x86\\)\\\\*\" OR parent_image_path:\"C:\\\\Program Files\\\\*\")",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "360",
              "left": "989",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "d23fa0c5-6eb8-47ff-a4fc-364e20c9a094",
              "id": 753
            },
            {
              "@type": "WorkflowStep",
              "name": "Which SIEM",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Elasticsearch",
                    "step_iri": "/api/3/workflow_steps/09956202-c25e-461a-97b9-729b622252e1",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Elastic\" }}"
                  },
                  {
                    "option": "Splunk",
                    "step_iri": "/api/3/workflow_steps/d8610806-64dd-453d-b2b8-9749e0a145d7",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Splunk\" }}"
                  }
                ]
              },
              "status": null,
              "top": "300",
              "left": "320",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "399f6037-8ac1-4d33-aa63-0a9973d13831",
              "id": 754
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Elastic hunt times",
              "description": null,
              "arguments": {
                "elasticHuntEnd": "{% if vars.input.records[0].huntEnd %} {{ arrow.get(vars.input.records[0].huntEnd).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }} {% else %} now {% endif %}",
                "elasticHuntStart": "{{ arrow.get(vars.input.records[0].huntStart).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }}"
              },
              "status": null,
              "top": "360",
              "left": "714",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "09956202-c25e-461a-97b9-729b622252e1",
              "id": 755
            },
            {
              "@type": "WorkflowStep",
              "name": "Copy  of Create and Link Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_query_for_Sysmon_Rundll32.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query identified rundll32.exe spawned child process {{vars.item._source.image_path.split(\"\\\\\")[-1] }} from a nonstandard directory on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-Rundll32-{{vars.item._source.image_path.split(\"\\\\\")[-1] }} executed by Rundll32.exe",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "Rundll32",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "An attempt to invoke Rundll32.exe was observed. Rundll32 can be used to load arbitrary DLL files. Use of this technique may bypass application whitelisting and allow an attacker to bypass other defenses. Attention should be paid to the commands passed to Rundll32 as well as processes spawned.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1085",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "360",
              "left": "1534",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "97249cbb-c85a-4a17-b395-cfa78a72f83e",
              "id": 756
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Results_for_Sysmon_Rundll32.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query identified rundll32.exe spawned child process {{vars.item.process_exec}} from a nonstandard directory on {{vars.item.host}} at {{vars.item.TimeCreated}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-Rundll32-{{vars.item.Image}} executed by Rundll32.exe",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "Rundll32",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.vendor_product}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "An attempt to invoke Rundll32.exe was observed. Rundll32 can be used to load arbitrary DLL files. Use of this technique may bypass application whitelisting and allow an attacker to bypass other defenses. Attention should be paid to the commands passed to Rundll32 as well as processes spawned.",
                  "processGUID": "",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1085",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "180",
              "left": "1531",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "2b6f977c-a912-4c84-b4ec-8f704c7e689a",
              "id": 757
            },
            {
              "@type": "WorkflowStep",
              "name": "Deduplicate Comments",
              "description": null,
              "arguments": {
                "arguments": {
                  "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
              },
              "status": null,
              "top": "350",
              "left": "1840",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "d3051582-e4c7-45c3-976c-0e6db8552d99",
              "id": 758
            },
            {
              "@type": "WorkflowStep",
              "name": "Hunt for Rundll32",
              "description": null,
              "arguments": {
                "route": "cad62b12-f607-4aab-af56-21fcd6908e89",
                "title": "T1218.011 - Hunt for Rundll32",
                "resources": [
                  "hunt"
                ],
                "inputVariables": [
                  {
                    "name": "siem",
                    "type": "picklists",
                    "label": "SIEM",
                    "title": "Picklist",
                    "usable": true,
                    "tooltip": "Choose your SIEM",
                    "dataType": "picklist",
                    "formType": "picklist",
                    "required": true,
                    "_expanded": true,
                    "collection": false,
                    "dataSource": {
                      "model": "picklists",
                      "query": {
                        "sort": [
                          {
                            "field": "orderIndex",
                            "direction": "ASC"
                          }
                        ],
                        "logic": "AND",
                        "filters": [
                          {
                            "field": "listName__name",
                            "value": "SIEMs",
                            "operator": "eq"
                          }
                        ]
                      },
                      "displayConditions": {
                        "876c1483-416b-4d2f-8138-15769ae16d5c": {
                          "conditions": null,
                          "visibility": "visible"
                        },
                        "bcebcab1-3f93-468a-9f3f-91e5c511a0b5": {
                          "conditions": null,
                          "visibility": "visible"
                        }
                      }
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "_nameTouched": true,
                    "defaultValue": {
                      "id": 280,
                      "@id": "/api/3/picklists/876c1483-416b-4d2f-8138-15769ae16d5c",
                      "icon": null,
                      "@type": "Picklist",
                      "color": null,
                      "display": "Elastic",
                      "listName": "/api/3/picklist_names/98830189-afff-40e6-bed1-94012551dc67",
                      "itemValue": "Elastic",
                      "orderIndex": 1
                    },
                    "useModuleField": false,
                    "displayTemplate": "{{ itemValue }}",
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "siem": "{{vars.request.data[\"siem\"]}}",
                      "sourceIP": "{{ vars.sourceIP }}",
                      "processID": "{{ vars.processID }}",
                      "sourcetool": "{{ vars.sourcetool }}",
                      "accountname": "{{ vars.accountname }}",
                      "commandline": "{{ vars.commandline }}",
                      "processGUID": "{{ vars.processGUID }}",
                      "processname": "{{ vars.processname }}",
                      "computername": "{{ vars.computername }}",
                      "destinationIP": "{{ vars.destinationIP }}",
                      "parentprocessGUID": "{{ vars.parentprocessGUID }}",
                      "parentprocessname": "{{ vars.parentprocessname }}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "hunt": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "300",
              "left": "30",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "d57164d0-0f07-435e-aa39-aca4ebc6d6ee",
              "id": 759
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/d3051582-e4c7-45c3-976c-0e6db8552d99",
              "sourceStep": "/api/3/workflow_steps/2b6f977c-a912-4c84-b4ec-8f704c7e689a",
              "label": null,
              "isExecuted": false,
              "uuid": "9e910746-e503-4063-813d-f2e6ebc40d53"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create and Link Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/d3051582-e4c7-45c3-976c-0e6db8552d99",
              "sourceStep": "/api/3/workflow_steps/97249cbb-c85a-4a17-b395-cfa78a72f83e",
              "label": null,
              "isExecuted": false,
              "uuid": "9744974a-990d-426e-999b-3eb89b81335c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Splunk query for Sysmon CMSTP -> Get Results for Sysmon CMSTP",
              "targetStep": "/api/3/workflow_steps/865cc7ca-f625-4457-9e7d-9ab8a090b959",
              "sourceStep": "/api/3/workflow_steps/9363d125-856a-4092-9adf-6f3776b5e02f",
              "label": null,
              "isExecuted": false,
              "uuid": "6b18aa2f-9a5f-47e5-9a8d-ec7364820498"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/d8610806-64dd-453d-b2b8-9749e0a145d7",
              "sourceStep": "/api/3/workflow_steps/399f6037-8ac1-4d33-aa63-0a9973d13831",
              "label": "Splunk",
              "isExecuted": false,
              "uuid": "915e1ad8-914d-49f2-ae80-1bb205501258"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Set Elastic hunt times",
              "targetStep": "/api/3/workflow_steps/09956202-c25e-461a-97b9-729b622252e1",
              "sourceStep": "/api/3/workflow_steps/399f6037-8ac1-4d33-aa63-0a9973d13831",
              "label": "Elasticsearch",
              "isExecuted": false,
              "uuid": "19f04e5d-9817-4702-842f-d58e2cefb9dd"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic query for Sysmon Rundll32 -> Copy  of Create and Link Alert",
              "targetStep": "/api/3/workflow_steps/97249cbb-c85a-4a17-b395-cfa78a72f83e",
              "sourceStep": "/api/3/workflow_steps/d23fa0c5-6eb8-47ff-a4fc-364e20c9a094",
              "label": null,
              "isExecuted": false,
              "uuid": "988a9fca-0d9f-42c5-b953-9ab52ca94609"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> elalstic",
              "targetStep": "/api/3/workflow_steps/d23fa0c5-6eb8-47ff-a4fc-364e20c9a094",
              "sourceStep": "/api/3/workflow_steps/09956202-c25e-461a-97b9-729b622252e1",
              "label": null,
              "isExecuted": false,
              "uuid": "866fbd94-b9bb-4123-aa9f-1b52a370eac8"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Hunt for Rundll32 -> Which SIEM",
              "targetStep": "/api/3/workflow_steps/399f6037-8ac1-4d33-aa63-0a9973d13831",
              "sourceStep": "/api/3/workflow_steps/d57164d0-0f07-435e-aa39-aca4ebc6d6ee",
              "label": null,
              "isExecuted": false,
              "uuid": "b27a5a79-1afb-4560-9700-314dc92216b6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Results for Sysmon CMSTP -> Create Splunk Alert",
              "targetStep": "/api/3/workflow_steps/2b6f977c-a912-4c84-b4ec-8f704c7e689a",
              "sourceStep": "/api/3/workflow_steps/865cc7ca-f625-4457-9e7d-9ab8a090b959",
              "label": null,
              "isExecuted": false,
              "uuid": "30c228bc-24ed-401c-8db4-b9417042ddb5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Splunk query for Sysmon Rundll32",
              "targetStep": "/api/3/workflow_steps/9363d125-856a-4092-9adf-6f3776b5e02f",
              "sourceStep": "/api/3/workflow_steps/d8610806-64dd-453d-b2b8-9749e0a145d7",
              "label": null,
              "isExecuted": false,
              "uuid": "3de1be9c-f471-4a9b-b2b2-bf9bba5d4ffb"
            }
          ],
          "priority": null,
          "uuid": "38f9b332-8f68-4cae-99d0-e7b01bdf6d90",
          "recordTags": [],
          "id": 125,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214964,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215041,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "HUNTS - InstallUtil (T1218.004)",
          "aliasName": null,
          "tag": "ATT&CK, InstallUtil, Execution",
          "description": "Identifies process execution via InstallUtil and Installutil being passed via the command line (CMD,PS.WMIC)",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "sourceIP",
            "destinationIP",
            "processname",
            "processID",
            "processGUID",
            "parentprocessname",
            "parentprocessGUID",
            "accountname",
            "computername",
            "commandline",
            "sourcetool"
          ],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/c3d3d88b-9ca9-4dfb-aa62-4b8685eec3b8",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/a05c019d-9587-4b7c-8076-87902d12db4d",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert1",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Results_1.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query identified InstallUtil.exe spawned child process {{vars.item.process_exec}} on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-InstallUtil-{{vars.item.process_exec}} spawned",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "InstallUtil-Child Process",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.EventChannel}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "An attempt by installutil.exe to spawn a process was observed. InstallUtil.exe is digitally signed by Microsoft and can be used to execute a malicious binary on a host while bypassing processes whitelisting. Special attention should be paid to command line arguments passed with the InstallUtil.exe command and any child processes of InstallUtil.exe.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1118",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "280",
              "left": "1420",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "c9b1f4f4-50a6-4518-bff0-a6015a1671c0",
              "id": 760
            },
            {
              "@type": "WorkflowStep",
              "name": "Deduplicate Comments",
              "description": null,
              "arguments": {
                "arguments": {
                  "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
              },
              "status": null,
              "top": "326",
              "left": "1720",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "aa03a1ff-2efc-4110-9549-c0d7ae1fdebd",
              "id": 761
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Splunk hunt times",
              "description": null,
              "arguments": {
                "splunkHuntEnd": "{% if vars.input.records[0].huntEnd %}latest={{vars.input.records[0].huntEnd}}{% endif %}",
                "splunkHuntStart": "earliest={{vars.input.records[0].huntStart}}"
              },
              "status": null,
              "top": "240",
              "left": "571",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "5f60d93c-349a-4f17-bb48-0909cad00618",
              "id": 762
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic query for Sysmon InstallUtil Child",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:\"1\" AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND (parent_image_path.keyword:C\\:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v*\\\\InstallUtil.exe OR parent_image_path.keyword:C\\:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v*\\\\InstallUtil.exe)",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "460",
              "left": "867",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "08299472-f1be-46b6-aecb-74c77d83e4a7",
              "id": 763
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Elastic hunt times",
              "description": null,
              "arguments": {
                "elasticHuntEnd": "{% if vars.input.records[0].huntEnd %} {{ arrow.get(vars.input.records[0].huntEnd).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }} {% else %} now {% endif %}",
                "elasticHuntStart": "{{ arrow.get(vars.input.records[0].huntStart).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }}"
              },
              "status": null,
              "top": "420",
              "left": "573",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "02388ef7-a626-4212-a6fe-5c1a6f4f5179",
              "id": 764
            },
            {
              "@type": "WorkflowStep",
              "name": "Splunk query for Sysmon InstallUtil Child",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=sysmon EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} (ParentImage=\"C:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v*\\\\installutil.exe\" OR ParentImage=\"C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v*\\\\*installutil.exe\") | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "280",
              "left": "866",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "436376f1-6dc1-471e-8295-b1c8032e6662",
              "id": 765
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert2",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Results_2.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query identified InstallUtil.exe was executed via command line on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-InstallUtil-Command line with InstallUtil detected",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "InstallUtil-Commandline",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.EventChannel}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "An attempt to invoke installutil.exe via command line was observed. InstallUtil.exe is digitally signed by Microsoft and can be used to execute a malicious binary on a host while bypassing processes whitelisting. Special attention should be paid to command line arguments passed with the InstallUtil.exe command and any child processes of InstallUtil.exe.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1118",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "200",
              "left": "1420",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "c7849617-875c-4cb6-9605-7ffcac20dd08",
              "id": 766
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Elastic Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_query_for_InstallUtil_Via_Command_Line.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query identified InstallUtil.exe was executed via command line on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-InstallUtil-Command line with InstallUtil detected",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "InstallUtil-Commandline",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "An attempt to invoke installutil.exe via command line was observed. InstallUtil.exe is digitally signed by Microsoft and can be used to execute a malicious binary on a host while bypassing processes whitelisting. Special attention should be paid to command line arguments passed with the InstallUtil.exe command and any child processes of InstallUtil.exe.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1118",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "380",
              "left": "1420",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "47562cf0-f555-4370-afec-715e03aa8ce8",
              "id": 767
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Results 1",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Splunk_query_for_Sysmon_InstallUtil_Child.data.sid}}\"}",
                  "additional_args": "{\"a\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "280",
              "left": "1140",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "b72bcfc3-66d2-4bde-a4d4-937662d52c4f",
              "id": 768
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic query for InstallUtil Via Command Line",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:\"1\" AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND (parent_image_path:C\\:\\\\Windows\\\\System32\\\\wmic.exe OR parent_image_path:C\\:\\\\Windows\\\\System32\\\\cmd.exe OR parent_image_path:C\\:\\\\Windows\\\\SysWOW64\\\\wmic.exe OR parent_image_path:C\\:\\\\Windows\\\\SysWOW64\\\\cmd.exe OR parent_image_path:C\\:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe OR parent_image_path:C\\:\\\\Windows\\\\SysWOW64\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe) AND event_data.CommandLine:*InstallUtil*",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "380",
              "left": "867",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "ee097a5c-f226-4fd3-973f-0c70217d2725",
              "id": 769
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Elastic Alert2",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_query_for_Sysmon_InstallUtil_Child.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query identified InstallUtil.exe spawned child process {{vars.item._source.image_path.split(\"\\\\\")[-1] }} on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-InstallUtil-{{vars.item._source.image_path.split(\"\\\\\")[-1] }} spawned",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "InstallUtil-Commandline",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "An attempt by installutil.exe to spawn a process was observed. InstallUtil.exe is digitally signed by Microsoft and can be used to execute a malicious binary on a host while bypassing processes whitelisting. Special attention should be paid to command line arguments passed with the InstallUtil.exe command and any child processes of InstallUtil.exe.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1118",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "460",
              "left": "1420",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "c8344cc2-a562-4109-8d8d-91f2de0979b5",
              "id": 770
            },
            {
              "@type": "WorkflowStep",
              "name": "Splunk query for InstallUtil Via Command Line",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=sysmon EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} (ParentImage=\"C:\\\\Windows\\\\System32\\\\wmic.exe\" OR ParentImage=\"C:\\\\Windows\\\\System32\\\\cmd.exe\" OR ParentImage=\"C:\\\\Windows\\\\SysWOW64\\\\wmic.exe\" OR ParentImage=\"C:\\\\Windows\\\\SysWOW64\\\\cmd.exe\" OR ParentImage=\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\" OR ParentImage=\"C:\\\\Windows\\\\SysWOW64\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\") AND CommandLine=\"*installutil*\" | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "200",
              "left": "866",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "b09f984c-3110-4e48-9552-3ad4a280ca94",
              "id": 771
            },
            {
              "@type": "WorkflowStep",
              "name": "Hunt for InstallUtil",
              "description": null,
              "arguments": {
                "route": "940d0bfc-9866-4797-aa0d-b761d28c447d",
                "title": "T1218.004 - Hunt for InstallUtil",
                "resources": [
                  "hunt"
                ],
                "inputVariables": [
                  {
                    "name": "siem",
                    "type": "picklists",
                    "label": "SIEM",
                    "title": "Picklist",
                    "usable": true,
                    "tooltip": "Choose your SIEM",
                    "dataType": "picklist",
                    "formType": "picklist",
                    "required": true,
                    "_expanded": true,
                    "mmdUpdate": true,
                    "collection": false,
                    "dataSource": {
                      "model": "picklists",
                      "query": {
                        "sort": [
                          {
                            "field": "orderIndex",
                            "direction": "ASC"
                          }
                        ],
                        "logic": "AND",
                        "filters": [
                          {
                            "field": "listName__name",
                            "value": "SIEMs",
                            "operator": "eq"
                          }
                        ]
                      },
                      "displayConditions": {
                        "876c1483-416b-4d2f-8138-15769ae16d5c": {
                          "conditions": null,
                          "visibility": "visible"
                        },
                        "bcebcab1-3f93-468a-9f3f-91e5c511a0b5": {
                          "conditions": null,
                          "visibility": "visible"
                        }
                      }
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "_nameTouched": true,
                    "defaultValue": {
                      "id": 280,
                      "@id": "/api/3/picklists/876c1483-416b-4d2f-8138-15769ae16d5c",
                      "icon": null,
                      "@type": "Picklist",
                      "color": null,
                      "display": "Elastic",
                      "listName": "/api/3/picklist_names/98830189-afff-40e6-bed1-94012551dc67",
                      "itemValue": "Elastic",
                      "orderIndex": 1
                    },
                    "displayTemplate": "{{ itemValue }}",
                    "lengthConstraint": false,
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "siem": "{{vars.request.data[\"siem\"]}}",
                      "sourceIP": "{{ vars.sourceIP }}",
                      "processID": "{{ vars.processID }}",
                      "sourcetool": "{{ vars.sourcetool }}",
                      "accountname": "{{ vars.accountname }}",
                      "commandline": "{{ vars.commandline }}",
                      "processGUID": "{{ vars.processGUID }}",
                      "processname": "{{ vars.processname }}",
                      "computername": "{{ vars.computername }}",
                      "destinationIP": "{{ vars.destinationIP }}",
                      "parentprocessGUID": "{{ vars.parentprocessGUID }}",
                      "parentprocessname": "{{ vars.parentprocessname }}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "hunt": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "320",
              "left": "0",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "a05c019d-9587-4b7c-8076-87902d12db4d",
              "id": 772
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Results 2",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Splunk_query_for_InstallUtil_Via_Command_Line.data.sid}}\"}",
                  "additional_args": "{\"a\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "200",
              "left": "1140",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "9e83818f-f54f-406c-a502-37ee8e51d67d",
              "id": 773
            },
            {
              "@type": "WorkflowStep",
              "name": "Which SIEM",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "step_iri": "/api/3/workflow_steps/5f60d93c-349a-4f17-bb48-0909cad00618",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Splunk\" }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/02388ef7-a626-4212-a6fe-5c1a6f4f5179",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Elastic\" }}"
                  }
                ]
              },
              "status": null,
              "top": "320",
              "left": "280",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "ebb60744-cd56-427e-911a-b5c8758dc3f0",
              "id": 774
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/5f60d93c-349a-4f17-bb48-0909cad00618",
              "sourceStep": "/api/3/workflow_steps/ebb60744-cd56-427e-911a-b5c8758dc3f0",
              "label": "",
              "isExecuted": false,
              "uuid": "c8451e3c-bbc9-4417-8a15-b0b81916e935"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Hunt for InstallUtil Start -> Which SIEM",
              "targetStep": "/api/3/workflow_steps/ebb60744-cd56-427e-911a-b5c8758dc3f0",
              "sourceStep": "/api/3/workflow_steps/a05c019d-9587-4b7c-8076-87902d12db4d",
              "label": null,
              "isExecuted": false,
              "uuid": "c7003540-d3e1-4eff-b5f1-305b450bd5b5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Copy  of Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/02388ef7-a626-4212-a6fe-5c1a6f4f5179",
              "sourceStep": "/api/3/workflow_steps/ebb60744-cd56-427e-911a-b5c8758dc3f0",
              "label": "",
              "isExecuted": false,
              "uuid": "29dd96ac-8af8-4e53-bf0e-851e6684c9ff"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Splunk query for Sysmon CMSTP -> Get Results for Sysmon CMSTP",
              "targetStep": "/api/3/workflow_steps/b72bcfc3-66d2-4bde-a4d4-937662d52c4f",
              "sourceStep": "/api/3/workflow_steps/436376f1-6dc1-471e-8295-b1c8032e6662",
              "label": null,
              "isExecuted": false,
              "uuid": "861db5c0-8bfa-4a05-a27b-7f6e4b72fdc1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert1 -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/aa03a1ff-2efc-4110-9549-c0d7ae1fdebd",
              "sourceStep": "/api/3/workflow_steps/c9b1f4f4-50a6-4518-bff0-a6015a1671c0",
              "label": null,
              "isExecuted": false,
              "uuid": "c5165882-9f1d-40a3-9fff-8f818feb9f0e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Splunk query for Regsvr32 DLL Load -> Copy  of Get Results for Sysmon Regsvr32 Child",
              "targetStep": "/api/3/workflow_steps/9e83818f-f54f-406c-a502-37ee8e51d67d",
              "sourceStep": "/api/3/workflow_steps/b09f984c-3110-4e48-9552-3ad4a280ca94",
              "label": null,
              "isExecuted": false,
              "uuid": "1926027c-adbf-41a8-bbed-703e66bcb42b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Results for Sysmon Regsvr32 Child -> Create Splunk Alert",
              "targetStep": "/api/3/workflow_steps/c9b1f4f4-50a6-4518-bff0-a6015a1671c0",
              "sourceStep": "/api/3/workflow_steps/b72bcfc3-66d2-4bde-a4d4-937662d52c4f",
              "label": null,
              "isExecuted": false,
              "uuid": "cc5ecae9-4951-4d70-a2e6-e5e03188f589"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Splunk query for Sysmon InstallUtil Child",
              "targetStep": "/api/3/workflow_steps/436376f1-6dc1-471e-8295-b1c8032e6662",
              "sourceStep": "/api/3/workflow_steps/5f60d93c-349a-4f17-bb48-0909cad00618",
              "label": null,
              "isExecuted": false,
              "uuid": "622eacfa-3a2d-4846-9ebc-25850df6eb9c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create and Link Alert2 -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/aa03a1ff-2efc-4110-9549-c0d7ae1fdebd",
              "sourceStep": "/api/3/workflow_steps/47562cf0-f555-4370-afec-715e03aa8ce8",
              "label": null,
              "isExecuted": false,
              "uuid": "05dc83a6-a367-4e2f-8b5d-2383d928b6a4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Results for Sysmon Regsvr32 DLL Load -> Copy  of Create Splunk Alert",
              "targetStep": "/api/3/workflow_steps/c7849617-875c-4cb6-9605-7ffcac20dd08",
              "sourceStep": "/api/3/workflow_steps/9e83818f-f54f-406c-a502-37ee8e51d67d",
              "label": null,
              "isExecuted": false,
              "uuid": "3aedf203-0d20-4e0a-914c-3862d83ffc7e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert2 -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/aa03a1ff-2efc-4110-9549-c0d7ae1fdebd",
              "sourceStep": "/api/3/workflow_steps/c7849617-875c-4cb6-9605-7ffcac20dd08",
              "label": null,
              "isExecuted": false,
              "uuid": "b1d239f1-12b3-4764-b04a-95cbccd98b00"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> Copy  of a",
              "targetStep": "/api/3/workflow_steps/08299472-f1be-46b6-aecb-74c77d83e4a7",
              "sourceStep": "/api/3/workflow_steps/02388ef7-a626-4212-a6fe-5c1a6f4f5179",
              "label": null,
              "isExecuted": false,
              "uuid": "9d5c921b-a47a-4d05-98d5-9899b1412b11"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> a",
              "targetStep": "/api/3/workflow_steps/ee097a5c-f226-4fd3-973f-0c70217d2725",
              "sourceStep": "/api/3/workflow_steps/02388ef7-a626-4212-a6fe-5c1a6f4f5179",
              "label": null,
              "isExecuted": false,
              "uuid": "7f50908d-6688-4393-8118-4c464451bb6f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Splunk query for InstallUtil Via Command Line",
              "targetStep": "/api/3/workflow_steps/b09f984c-3110-4e48-9552-3ad4a280ca94",
              "sourceStep": "/api/3/workflow_steps/5f60d93c-349a-4f17-bb48-0909cad00618",
              "label": null,
              "isExecuted": false,
              "uuid": "d93d61c3-0b84-4ba4-a09e-d5d6bb98cbda"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create and Link Elastic Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/aa03a1ff-2efc-4110-9549-c0d7ae1fdebd",
              "sourceStep": "/api/3/workflow_steps/c8344cc2-a562-4109-8d8d-91f2de0979b5",
              "label": null,
              "isExecuted": false,
              "uuid": "02f076d1-d0fb-4617-9d0a-0d52c3993a70"
            },
            {
              "@type": "WorkflowRoute",
              "name": "a -> Copy  of Create and Link Alert2",
              "targetStep": "/api/3/workflow_steps/47562cf0-f555-4370-afec-715e03aa8ce8",
              "sourceStep": "/api/3/workflow_steps/ee097a5c-f226-4fd3-973f-0c70217d2725",
              "label": null,
              "isExecuted": false,
              "uuid": "a29d7790-f864-4a40-a32d-a2df76c7d921"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic query for Sysmon InstallUtil Child -> Copy  of Create and Link Elastic Alert",
              "targetStep": "/api/3/workflow_steps/c8344cc2-a562-4109-8d8d-91f2de0979b5",
              "sourceStep": "/api/3/workflow_steps/08299472-f1be-46b6-aecb-74c77d83e4a7",
              "label": null,
              "isExecuted": false,
              "uuid": "4f9cd36d-86d2-4bb9-a742-55b3521a16af"
            }
          ],
          "priority": null,
          "uuid": "3f61a4b1-08a5-450b-9706-b2966d9b2b2b",
          "recordTags": [],
          "id": 126,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214964,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215041,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "HUNTS - CMSTP (T1218.003)",
          "aliasName": null,
          "tag": "ATT&CK, CMSTP, Execution",
          "description": "Identifies processes spawned by CMSTP.exe",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "sourceIP",
            "destinationIP",
            "processname",
            "processID",
            "processGUID",
            "parentprocessname",
            "parentprocessGUID",
            "accountname",
            "computername",
            "commandline",
            "sourcetool"
          ],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/c3d3d88b-9ca9-4dfb-aa62-4b8685eec3b8",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/fbb8d050-0d4d-454b-8869-c075e6680aad",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Set Splunk hunt times",
              "description": null,
              "arguments": {
                "splunkHuntEnd": "{% if vars.input.records[0].huntEnd %}latest={{vars.input.records[0].huntEnd}}{% endif %}",
                "splunkHuntStart": "earliest={{vars.input.records[0].huntStart}}"
              },
              "status": null,
              "top": "160",
              "left": "600",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "ca2c3dea-1d2a-4060-968e-e0d060a96780",
              "id": 775
            },
            {
              "@type": "WorkflowStep",
              "name": "Splunk query for Sysmon CMSTP",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=\"sysmon\" EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} (ParentImage=\"C:\\\\Windows\\\\System32\\\\cmstp.exe\" OR ParentImage=\"C:\\\\Windows\\\\SysWOW64\\\\cmstp.exe\") | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "160",
              "left": "880",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "6fd0e35f-6ecc-4069-8922-32f56d7ddf5c",
              "id": 776
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Results for Sysmon CMSTP",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Splunk_query_for_Sysmon_CMSTP.data.sid}}\"}",
                  "additional_args": "{\"a\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "160",
              "left": "1160",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "4f56591a-aeed-4285-8d24-8150f505b790",
              "id": 777
            },
            {
              "@type": "WorkflowStep",
              "name": "Which SIEM",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Splunk",
                    "step_iri": "/api/3/workflow_steps/ca2c3dea-1d2a-4060-968e-e0d060a96780",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Splunk\" }}"
                  },
                  {
                    "option": "Elasticsearch",
                    "step_iri": "/api/3/workflow_steps/c2be6edd-335e-4779-ae1d-f72668536cd1",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Elastic\" }}"
                  }
                ]
              },
              "status": null,
              "top": "307",
              "left": "306",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "968dea35-5f2e-49a5-98df-2943c898246b",
              "id": 778
            },
            {
              "@type": "WorkflowStep",
              "name": "Hunt for CMSTP",
              "description": null,
              "arguments": {
                "route": "8553855b-002d-4324-a34e-3b8a358216e6",
                "title": "T1218.003 - Hunt for CMSTP",
                "resources": [
                  "hunt"
                ],
                "inputVariables": [
                  {
                    "name": "siem",
                    "type": "picklists",
                    "label": "SIEM",
                    "title": "Picklist",
                    "usable": true,
                    "tooltip": "Choose your SIEM",
                    "dataType": "picklist",
                    "formType": "picklist",
                    "required": true,
                    "_expanded": true,
                    "mmdUpdate": true,
                    "collection": false,
                    "dataSource": {
                      "model": "picklists",
                      "query": {
                        "sort": [
                          {
                            "field": "orderIndex",
                            "direction": "ASC"
                          }
                        ],
                        "logic": "AND",
                        "filters": [
                          {
                            "field": "listName__name",
                            "value": "SIEMs",
                            "operator": "eq"
                          }
                        ]
                      },
                      "displayConditions": {
                        "876c1483-416b-4d2f-8138-15769ae16d5c": {
                          "conditions": null,
                          "visibility": "visible"
                        },
                        "bcebcab1-3f93-468a-9f3f-91e5c511a0b5": {
                          "conditions": null,
                          "visibility": "visible"
                        }
                      }
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "_nameTouched": true,
                    "defaultValue": {
                      "id": 280,
                      "@id": "/api/3/picklists/876c1483-416b-4d2f-8138-15769ae16d5c",
                      "icon": null,
                      "@type": "Picklist",
                      "color": null,
                      "display": "Elastic",
                      "listName": "/api/3/picklist_names/98830189-afff-40e6-bed1-94012551dc67",
                      "itemValue": "Elastic",
                      "orderIndex": 1
                    },
                    "displayTemplate": "{{ itemValue }}",
                    "lengthConstraint": false,
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "siem": "{{vars.request.data[\"siem\"]}}",
                      "sourceIP": "{{ vars.sourceIP }}",
                      "processID": "{{ vars.processID }}",
                      "sourcetool": "{{ vars.sourcetool }}",
                      "accountname": "{{ vars.accountname }}",
                      "commandline": "{{ vars.commandline }}",
                      "processGUID": "{{ vars.processGUID }}",
                      "processname": "{{ vars.processname }}",
                      "computername": "{{ vars.computername }}",
                      "destinationIP": "{{ vars.destinationIP }}",
                      "parentprocessGUID": "{{ vars.parentprocessGUID }}",
                      "parentprocessname": "{{ vars.parentprocessname }}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "hunt": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "308",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "fbb8d050-0d4d-454b-8869-c075e6680aad",
              "id": 779
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Elastic Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_Query_for_Sysmon_CMSTP.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query identified CMSTP.exe spawning potentially non-standard child process {{vars.item._source.image_path.split(\"\\\\\")[-1] }}  on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-CMSTP-{{vars.item._source.image_path.split(\"\\\\\")[-1]}} spawned",
                  "epochTime": "{{arrow.get(vars.item._source.event_data.UtcTime).timestamp}}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "CMSTP",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "An attempt to invoke cmstp.exe was observed. CMSTP has been used to load malicious .inf files, enabling an attacker to force a host to download and execute DLLs or SCT files from a remote server. In many networks, an instance of a host executing cmstp.exe is uncommon and should investigated for additional signs of compromise.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1191",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "460",
              "left": "1440",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "abb778ef-0191-4dcc-9a09-1d28234667e6",
              "id": 780
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Splunk Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Results_for_Sysmon_CMSTP.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query identified CMSTP.exe spawning potentially non-standard child process {{vars.item.process_exec}} on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-CMSTP-{{vars.item.process_exec}} spawned",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "CMSTP",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.EventChannel}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "An attempt to invoke cmstp.exe was observed. CMSTP has been used to load malicious .inf files, enabling an attacker to force a host to download and execute DLLs or SCT files from a remote server. In many networks, an instance of a host executing cmstp.exe is uncommon and should investigated for additional signs of compromise.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1191",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "160",
              "left": "1448",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "3865456d-2a32-497e-9b08-70ae76ad1226",
              "id": 781
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic Query for Sysmon CMSTP",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:\"1\" AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND (parent_image_path:\"C:\\\\Windows\\\\System32\\\\cmstp.exe\" OR parent_image_path:\"C:\\\\Windows\\\\SysWOW64\\\\cmstp.exe\")",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "460",
              "left": "888",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "8a4b53d6-6994-45f8-a658-4830b8c98584",
              "id": 782
            },
            {
              "@type": "WorkflowStep",
              "name": "Deduplicate Comments",
              "description": null,
              "arguments": {
                "arguments": {
                  "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
              },
              "status": null,
              "top": "300",
              "left": "1740",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "f0d093d7-9d7e-4bf6-b795-3a15d3480fee",
              "id": 783
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Elastic hunt times",
              "description": null,
              "arguments": {
                "elasticHuntEnd": "{% if vars.input.records[0].huntEnd %} {{ arrow.get(vars.input.records[0].huntEnd).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }} {% else %} now {% endif %}",
                "elasticHuntStart": "{{ arrow.get(vars.input.records[0].huntStart).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }}"
              },
              "status": null,
              "top": "460",
              "left": "600",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "c2be6edd-335e-4779-ae1d-f72668536cd1",
              "id": 784
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Splunk query for Sysmon CMSTP",
              "targetStep": "/api/3/workflow_steps/6fd0e35f-6ecc-4069-8922-32f56d7ddf5c",
              "sourceStep": "/api/3/workflow_steps/ca2c3dea-1d2a-4060-968e-e0d060a96780",
              "label": null,
              "isExecuted": false,
              "uuid": "a6b8c473-317a-4f54-9415-413353330cea"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> Elastic Query for Sysmon CMSTP",
              "targetStep": "/api/3/workflow_steps/8a4b53d6-6994-45f8-a658-4830b8c98584",
              "sourceStep": "/api/3/workflow_steps/c2be6edd-335e-4779-ae1d-f72668536cd1",
              "label": null,
              "isExecuted": false,
              "uuid": "66061342-fea0-4ab4-9e43-48662b002c30"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Set Elastic hunt times",
              "targetStep": "/api/3/workflow_steps/c2be6edd-335e-4779-ae1d-f72668536cd1",
              "sourceStep": "/api/3/workflow_steps/968dea35-5f2e-49a5-98df-2943c898246b",
              "label": "Elasticsearch",
              "isExecuted": false,
              "uuid": "bd1f969c-c7ab-4d9f-835d-d1e6492fd024"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create and Link Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/f0d093d7-9d7e-4bf6-b795-3a15d3480fee",
              "sourceStep": "/api/3/workflow_steps/abb778ef-0191-4dcc-9a09-1d28234667e6",
              "label": null,
              "isExecuted": false,
              "uuid": "54fd14c2-f3b3-46f9-8af3-d19b128cbfb1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/f0d093d7-9d7e-4bf6-b795-3a15d3480fee",
              "sourceStep": "/api/3/workflow_steps/3865456d-2a32-497e-9b08-70ae76ad1226",
              "label": null,
              "isExecuted": false,
              "uuid": "3867dff1-8654-4a39-9532-aead4c0968b8"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Results for Sysmon CMSTP -> Create and Link Splunk Alert",
              "targetStep": "/api/3/workflow_steps/3865456d-2a32-497e-9b08-70ae76ad1226",
              "sourceStep": "/api/3/workflow_steps/4f56591a-aeed-4285-8d24-8150f505b790",
              "label": null,
              "isExecuted": false,
              "uuid": "a93ea89f-e28c-42fe-b0fa-a70a2016b57c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic Query for Sysmon CMSTP -> Copy  of Create and Link Alert",
              "targetStep": "/api/3/workflow_steps/abb778ef-0191-4dcc-9a09-1d28234667e6",
              "sourceStep": "/api/3/workflow_steps/8a4b53d6-6994-45f8-a658-4830b8c98584",
              "label": null,
              "isExecuted": false,
              "uuid": "04b8b719-90e0-47cc-94f4-afb3535e6c9f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Splunk query for Sysmon CMSTP -> Get Results for Sysmon CMSTP",
              "targetStep": "/api/3/workflow_steps/4f56591a-aeed-4285-8d24-8150f505b790",
              "sourceStep": "/api/3/workflow_steps/6fd0e35f-6ecc-4069-8922-32f56d7ddf5c",
              "label": null,
              "isExecuted": false,
              "uuid": "80691880-0aee-47b2-bbc2-a7f009d32f43"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Hunt for CMSTP -> Which SIEM",
              "targetStep": "/api/3/workflow_steps/968dea35-5f2e-49a5-98df-2943c898246b",
              "sourceStep": "/api/3/workflow_steps/fbb8d050-0d4d-454b-8869-c075e6680aad",
              "label": null,
              "isExecuted": false,
              "uuid": "44e538d0-ea7d-4321-ab14-0ff7044ce7c0"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Copy  of Set Elastic hunt times",
              "targetStep": "/api/3/workflow_steps/ca2c3dea-1d2a-4060-968e-e0d060a96780",
              "sourceStep": "/api/3/workflow_steps/968dea35-5f2e-49a5-98df-2943c898246b",
              "label": "Splunk",
              "isExecuted": false,
              "uuid": "5c32d974-cb45-40b6-99af-b90d8e881e2e"
            }
          ],
          "priority": null,
          "uuid": "82227e26-769e-4518-bb94-cc038d0c615d",
          "recordTags": [],
          "id": 127,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214964,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215041,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "HUNTS - Regsvcs/Regasm (T1218.009)",
          "aliasName": null,
          "tag": "ATT&CK, Regsvcs/Regasm, Defense_Evasion, Execution",
          "description": "Identifies processes spawned by Regsvcs and Regasm.",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/c3d3d88b-9ca9-4dfb-aa62-4b8685eec3b8",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/6db0f7c2-9eb7-47e1-9423-9464a9a81a32",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get processes spawned query results",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "9ab494b3-68d1-424f-9f76-0693bd787483",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Query_for_processes_spawned_by_Regsvcs_and_Regasm.data.sid}}\"}",
                  "additional_args": "{\"A\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "140",
              "left": "1147",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "96b4d542-beb2-4ac3-848a-402de5cf8ac9",
              "id": 789
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Elastic hunt times",
              "description": null,
              "arguments": {
                "elasticHuntEnd": "{% if vars.input.records[0].huntEnd %} {{ arrow.get(vars.input.records[0].huntEnd).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }} {% else %} now {% endif %}",
                "elasticHuntStart": "{{ arrow.get(vars.input.records[0].huntStart).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }}"
              },
              "status": null,
              "top": "350",
              "left": "572",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "9385d06c-e252-42d5-9e0d-ccaff33b5e47",
              "id": 785
            },
            {
              "@type": "WorkflowStep",
              "name": "Deduplicate comments",
              "description": null,
              "arguments": {
                "arguments": {
                  "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
              },
              "status": null,
              "top": "260",
              "left": "1734",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "7361c646-a955-4df7-a578-73e987d91e46",
              "id": 786
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Splunk hunt times",
              "description": null,
              "arguments": {
                "splunkHuntEnd": "{% if vars.input.records[0].huntEnd %}latest={{vars.input.records[0].huntEnd}}{% endif %}",
                "splunkHuntStart": "earliest={{vars.input.records[0].huntStart}}"
              },
              "status": null,
              "top": "180",
              "left": "572",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "5877adac-02f8-4ca4-a89c-5b429882c1a4",
              "id": 787
            },
            {
              "@type": "WorkflowStep",
              "name": "Query for processes spawned by Regsvcs and Regasm",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "9ab494b3-68d1-424f-9f76-0693bd787483",
                "params": {
                  "query": "index=sysmon EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} (ParentImage=\"C:\\\\Windows\\\\Microsoft.NET\\\\Framework*\\\\*\\\\RegSvcs.exe\"  OR ParentImage=\"C:\\\\Windows\\\\Microsoft.NET\\\\Framework*\\\\*\\\\Regasm.exe\") | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"A\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "140",
              "left": "868",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "f1aaac95-0563-443e-8ff0-1f241a7fee6b",
              "id": 788
            },
            {
              "@type": "WorkflowStep",
              "name": "Query for Regsvcs and Regasm command line",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "9ab494b3-68d1-424f-9f76-0693bd787483",
                "params": {
                  "query": "index=sysmon EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} (cmdline=\"C:\\\\Windows\\\\Microsoft.NET\\\\Framework*\\\\*\\\\RegSvcs.exe*.dll*\"  OR cmdline=\"C:\\\\Windows\\\\Microsoft.NET\\\\Framework*\\\\*\\\\Regasm.exe*.dll*\") | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"A\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "220",
              "left": "868",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "36848ba0-6d35-4de2-b4ec-1ae64c2b6d3f",
              "id": 790
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Child Process Splunk Alerts",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_processes_spawned_query_results.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query identified regsvcs.exe or regasm.exe spawned child process {{vars.item.process_exec}} on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-Regsvcs/Regasm-{{vars.item.process_exec}} spawned",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "Regsvcs/Regasm",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.EventChannel}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "An instance of Regsvcs.exe or Regasm.exe spawning a child process was observed. Regsvcs.exe and Regasm.exe are signed by Microsoft and can be used to execute arbitrary code.  As such, they may be used by an adversary to execute malicious code. Command line arguments and child processes spawned by Regsvcs.exe or Regasm.exe should be examined for malicious content.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1121",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "140",
              "left": "1420",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "9f71e6d5-3b19-433e-9b73-b99afe9a41b9",
              "id": 791
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Command Line Splunk Alerts",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_command_line_query_results.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query identified regsvcs.exe or regasm.exe being invoked with a DLL file in the command line on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-Regsvcs/Regasm-DLL executed via commandline",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "Regsvcs/Regasm",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.EventChannel}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "An instance of Regsvcs.exe or Regasm.exe being invoked with a DLL in the command line was observed. Regsvcs.exe and Regasm.exe are signed by Microsoft and can be used to execute arbitrary code.  As such, they may be used by an adversary to execute malicious code. Command line arguments and child processes spawned by Regsvcs.exe or Regasm.exe should be examined for malicious content.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1121",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "220",
              "left": "1420",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "75498972-699c-473f-94e1-9ca6434fb8bc",
              "id": 792
            },
            {
              "@type": "WorkflowStep",
              "name": "Get command line query results",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "9ab494b3-68d1-424f-9f76-0693bd787483",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Query_for_Regsvcs_and_Regasm_command_line.data.sid}}\"}",
                  "additional_args": "{\"A\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "220",
              "left": "1147",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "5b5c1de2-4973-4a4c-bed6-da18abb5ee58",
              "id": 793
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic Query for Regsvcs and Regasm command line",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:\"1\" AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND  event_data.CommandLine:C\\:\\\\Windows\\\\Microsoft.NET\\\\Framework*\\\\*\\\\Reg*.exe*.dll*",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "389",
              "left": "868",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "c0c56e06-9d51-45d0-901d-8e69fa9548e8",
              "id": 794
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Child Process Elastic Alerts",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_Query_for_processes_spawned_by_Regsvcs_and_Regasm.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query identified regsvcs.exe or regasm.exe spawned child process {{vars.item._source.image_path.split(\"\\\\\")[-1] }} on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-Regsvcs/Regasm-{{vars.item._source.image_path.split(\"\\\\\")[-1] }} spawned",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "Regsvcs/Regasm",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "An instance of Regsvcs.exe or Regasm.exe spawning a child process was observed. Regsvcs.exe and Regasm.exe are signed by Microsoft and can be used to execute arbitrary code.  As such, they may be used by an adversary to execute malicious code. Command line arguments and child processes spawned by Regsvcs.exe or Regasm.exe should be examined for malicious content.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1121",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "306",
              "left": "1420",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "18a90ef7-b4c0-4d20-9ea9-5e9ac030d826",
              "id": 795
            },
            {
              "@type": "WorkflowStep",
              "name": "Copy  of Copy  of Create Child Process Splunk Alerts",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_Query_for_Regsvcs_and_Regasm_command_line.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query identified regsvcs.exe or regasm.exe being invoked with a DLL file in the command line on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-Regsvcs/Regasm-DLL executed via commandline",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "Regsvcs/Regasm",
                  "sourceData": "",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "An instance of Regsvcs.exe or Regasm.exe being invoked with a DLL in the command line was observed. Regsvcs.exe and Regasm.exe are signed by Microsoft and can be used to execute arbitrary code.  As such, they may be used by an adversary to execute malicious code. Command line arguments and child processes spawned by Regsvcs.exe or Regasm.exe should be examined for malicious content.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1121",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "389",
              "left": "1420",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "360fec5d-66c1-4817-9d5d-1c07f0515845",
              "id": 796
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic Query for processes spawned by Regsvcs and Regasm",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:\"1\" AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } event_type:sysmon AND event_id:1 AND parent_image_path.keyword:C\\:\\\\Windows\\\\Microsoft.NET\\\\Framework*\\\\*\\\\Reg*.exe",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "306",
              "left": "869",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "20c7fd0d-781c-4bb2-a09c-97937013a799",
              "id": 797
            },
            {
              "@type": "WorkflowStep",
              "name": "Which SIEM",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "",
                    "step_iri": "/api/3/workflow_steps/9385d06c-e252-42d5-9e0d-ccaff33b5e47",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Elastic\" }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/5877adac-02f8-4ca4-a89c-5b429882c1a4",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Splunk\" }}"
                  }
                ]
              },
              "status": null,
              "top": "280",
              "left": "280",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "c72d81f7-2442-4194-89ee-059166b49328",
              "id": 798
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": "Hunt for Regsvcs/Regasm",
              "arguments": {
                "route": "4a24ed98-dc6b-45cb-8312-3f666bc668aa",
                "title": "T1218.009 - Hunt for Regsvcs/Regasm",
                "resources": [
                  "hunt"
                ],
                "inputVariables": [
                  {
                    "name": "siem",
                    "type": "picklists",
                    "label": "SIEM",
                    "title": "Picklist",
                    "usable": true,
                    "tooltip": "Choose your SIEM",
                    "dataType": "picklist",
                    "formType": "picklist",
                    "required": true,
                    "_expanded": true,
                    "collection": false,
                    "dataSource": {
                      "model": "picklists",
                      "query": {
                        "sort": [
                          {
                            "field": "orderIndex",
                            "direction": "ASC"
                          }
                        ],
                        "logic": "AND",
                        "filters": [
                          {
                            "field": "listName__name",
                            "value": "SIEMs",
                            "operator": "eq"
                          }
                        ]
                      },
                      "displayConditions": {
                        "876c1483-416b-4d2f-8138-15769ae16d5c": {
                          "conditions": null,
                          "visibility": "visible"
                        },
                        "bcebcab1-3f93-468a-9f3f-91e5c511a0b5": {
                          "conditions": null,
                          "visibility": "visible"
                        }
                      }
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "_nameTouched": true,
                    "defaultValue": {
                      "id": 280,
                      "@id": "/api/3/picklists/876c1483-416b-4d2f-8138-15769ae16d5c",
                      "icon": null,
                      "@type": "Picklist",
                      "color": null,
                      "display": "Elastic",
                      "listName": "/api/3/picklist_names/98830189-afff-40e6-bed1-94012551dc67",
                      "itemValue": "Elastic",
                      "orderIndex": 1
                    },
                    "useModuleField": false,
                    "displayTemplate": "{{ itemValue }}",
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "siem": "{{vars.request.data[\"siem\"]}}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "hunt": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "280",
              "left": "9",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "6db0f7c2-9eb7-47e1-9423-9464a9a81a32",
              "id": 799
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Copy  of Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/9385d06c-e252-42d5-9e0d-ccaff33b5e47",
              "sourceStep": "/api/3/workflow_steps/c72d81f7-2442-4194-89ee-059166b49328",
              "label": "",
              "isExecuted": false,
              "uuid": "e19b7d02-2b73-401f-a677-412ce82e6da5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> a",
              "targetStep": "/api/3/workflow_steps/20c7fd0d-781c-4bb2-a09c-97937013a799",
              "sourceStep": "/api/3/workflow_steps/9385d06c-e252-42d5-9e0d-ccaff33b5e47",
              "label": null,
              "isExecuted": false,
              "uuid": "f004b56d-fc04-413c-84da-5e470845eb8b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> Copy  of a",
              "targetStep": "/api/3/workflow_steps/c0c56e06-9d51-45d0-901d-8e69fa9548e8",
              "sourceStep": "/api/3/workflow_steps/9385d06c-e252-42d5-9e0d-ccaff33b5e47",
              "label": null,
              "isExecuted": false,
              "uuid": "e9065547-ac86-4037-a766-bd5c3d070b8d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get processes spawned query results -> Create Alerts",
              "targetStep": "/api/3/workflow_steps/9f71e6d5-3b19-433e-9b73-b99afe9a41b9",
              "sourceStep": "/api/3/workflow_steps/96b4d542-beb2-4ac3-848a-402de5cf8ac9",
              "label": null,
              "isExecuted": false,
              "uuid": "06a6c251-efc6-46e2-944e-638e288f3733"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Copy  of Create Child Process Splunk Alerts -> Deduplicate comments",
              "targetStep": "/api/3/workflow_steps/7361c646-a955-4df7-a578-73e987d91e46",
              "sourceStep": "/api/3/workflow_steps/360fec5d-66c1-4817-9d5d-1c07f0515845",
              "label": null,
              "isExecuted": false,
              "uuid": "5785ee51-3a77-4fa9-8948-090bbfc88fbe"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Which SIEM",
              "targetStep": "/api/3/workflow_steps/c72d81f7-2442-4194-89ee-059166b49328",
              "sourceStep": "/api/3/workflow_steps/6db0f7c2-9eb7-47e1-9423-9464a9a81a32",
              "label": null,
              "isExecuted": false,
              "uuid": "b8a8f7d0-2f89-43f2-8693-ffc46a4caf2b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Command Line Alerts -> Deduplicate comments",
              "targetStep": "/api/3/workflow_steps/7361c646-a955-4df7-a578-73e987d91e46",
              "sourceStep": "/api/3/workflow_steps/75498972-699c-473f-94e1-9ca6434fb8bc",
              "label": null,
              "isExecuted": false,
              "uuid": "da33421d-0dc7-4c38-9e6c-92ca13474a1c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/5877adac-02f8-4ca4-a89c-5b429882c1a4",
              "sourceStep": "/api/3/workflow_steps/c72d81f7-2442-4194-89ee-059166b49328",
              "label": null,
              "isExecuted": false,
              "uuid": "1b8506df-37d0-4077-a008-780b3327f565"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic Query for Regsvcs and Regasm command line -> Copy  of Copy  of Create Child Process Splunk Alerts",
              "targetStep": "/api/3/workflow_steps/360fec5d-66c1-4817-9d5d-1c07f0515845",
              "sourceStep": "/api/3/workflow_steps/c0c56e06-9d51-45d0-901d-8e69fa9548e8",
              "label": null,
              "isExecuted": false,
              "uuid": "5914988d-b625-46b0-9fd9-08363dde5c3a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Query for Regsvcs and Regasm command line -> Get command line query results",
              "targetStep": "/api/3/workflow_steps/5b5c1de2-4973-4a4c-bed6-da18abb5ee58",
              "sourceStep": "/api/3/workflow_steps/36848ba0-6d35-4de2-b4ec-1ae64c2b6d3f",
              "label": null,
              "isExecuted": false,
              "uuid": "746eeeb2-436e-4996-bcf6-62d689f8531a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Query for processes spawned by Regsvcs and Regasm",
              "targetStep": "/api/3/workflow_steps/f1aaac95-0563-443e-8ff0-1f241a7fee6b",
              "sourceStep": "/api/3/workflow_steps/5877adac-02f8-4ca4-a89c-5b429882c1a4",
              "label": null,
              "isExecuted": false,
              "uuid": "0b508581-166b-47a9-aeef-4f1a9df7c9d9"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create Child Process Splunk Alerts -> Deduplicate comments",
              "targetStep": "/api/3/workflow_steps/7361c646-a955-4df7-a578-73e987d91e46",
              "sourceStep": "/api/3/workflow_steps/18a90ef7-b4c0-4d20-9ea9-5e9ac030d826",
              "label": null,
              "isExecuted": false,
              "uuid": "e61fa267-54b0-407f-afe4-d70ac0640d60"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Query for Regsvcs and Regasm command line",
              "targetStep": "/api/3/workflow_steps/36848ba0-6d35-4de2-b4ec-1ae64c2b6d3f",
              "sourceStep": "/api/3/workflow_steps/5877adac-02f8-4ca4-a89c-5b429882c1a4",
              "label": null,
              "isExecuted": false,
              "uuid": "05cb177f-3f55-49bf-abae-8cbd2cd105de"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Child Process Alerts -> Deduplicate comments",
              "targetStep": "/api/3/workflow_steps/7361c646-a955-4df7-a578-73e987d91e46",
              "sourceStep": "/api/3/workflow_steps/9f71e6d5-3b19-433e-9b73-b99afe9a41b9",
              "label": null,
              "isExecuted": false,
              "uuid": "3afd5577-7fcd-45f3-b425-70d88a700aa6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Query for processes spawned by Regsvcs and Regasm -> Copy  of Get command line query results",
              "targetStep": "/api/3/workflow_steps/96b4d542-beb2-4ac3-848a-402de5cf8ac9",
              "sourceStep": "/api/3/workflow_steps/f1aaac95-0563-443e-8ff0-1f241a7fee6b",
              "label": null,
              "isExecuted": false,
              "uuid": "bcb43f0a-e5e3-4c10-a082-076d4b328c4f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "a -> Copy  of Create Child Process Splunk Alerts",
              "targetStep": "/api/3/workflow_steps/18a90ef7-b4c0-4d20-9ea9-5e9ac030d826",
              "sourceStep": "/api/3/workflow_steps/20c7fd0d-781c-4bb2-a09c-97937013a799",
              "label": null,
              "isExecuted": false,
              "uuid": "7a79d80e-9c99-48d7-a439-0d86b09fdfbf"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get command line query results -> Copy  of Create Alerts",
              "targetStep": "/api/3/workflow_steps/75498972-699c-473f-94e1-9ca6434fb8bc",
              "sourceStep": "/api/3/workflow_steps/5b5c1de2-4973-4a4c-bed6-da18abb5ee58",
              "label": null,
              "isExecuted": false,
              "uuid": "ce2b5745-f709-4621-809b-d0b563b5ab8f"
            }
          ],
          "priority": null,
          "uuid": "9ac8dbc1-ea82-4d68-9ce7-13479354d159",
          "recordTags": [],
          "id": 128,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214964,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215041,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "HUNTS - Mshta (T1218.005)",
          "aliasName": null,
          "tag": "ATT&CK, MSHTA, Defense_Evasion, Execution",
          "description": "Identifies Processes spawned by Mshta.exe",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "sourceIP",
            "destinationIP",
            "processname",
            "processID",
            "processGUID",
            "parentprocessname",
            "parentprocessGUID",
            "accountname",
            "computername",
            "commandline",
            "sourcetool"
          ],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/c3d3d88b-9ca9-4dfb-aa62-4b8685eec3b8",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/f2e8e76d-1762-44a1-bd7c-64bb665ad696",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Set Elastic hunt times",
              "description": null,
              "arguments": {
                "elasticHuntEnd": "{% if vars.input.records[0].huntEnd %} {{ arrow.get(vars.input.records[0].huntEnd).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }} {% else %} now {% endif %}",
                "elasticHuntStart": "{{ arrow.get(vars.input.records[0].huntStart).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }}"
              },
              "status": null,
              "top": "368",
              "left": "600",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "cc991b1d-f41f-484c-a89c-632918ab2dd6",
              "id": 812
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Results for MSHTA Child",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Splunk_query_for_MSHTA_Child.data.sid}}\"}",
                  "additional_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "266",
              "left": "1160",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "46829715-d455-4d21-9f45-232090436b11",
              "id": 800
            },
            {
              "@type": "WorkflowStep",
              "name": "Copy  of Create and Link Splunk Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Results_for_MSHTA_Child.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query identified MSHTA.exe spawned child process {{vars.item.process_exec}} on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-Mshta-{{vars.item.process_exec}} spawned",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "MSHTA-Child Process",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.EventChannel}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "An attempt to invoke mshta.exe was observed. MSHTA can be used as an alternate method of executing local and remotely hosted executables. In most networks execution of MSHTA.exe is an uncommon occurrence and should be investigated as a potential sign of compromise.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1170",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "266",
              "left": "1440",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "ad5092e1-7db7-430b-947e-9c80472fecb8",
              "id": 801
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Splunk hunt times",
              "description": null,
              "arguments": {
                "splunkHuntEnd": "{% if vars.input.records[0].huntEnd %}latest={{vars.input.records[0].huntEnd}}{% endif %}",
                "splunkHuntStart": "earliest={{vars.input.records[0].huntStart}}"
              },
              "status": null,
              "top": "240",
              "left": "600",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "d1e0ef8c-d8f0-4135-8f08-f3524a623089",
              "id": 802
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic Query for MSHTA Child",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:\"1\" AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND (parent_image_path:\"C:\\\\Windows\\\\System32\\\\mshta.exe\" OR parent_image_path:\"C:\\\\Windows\\\\SysWOW64\\\\mshta.exe\")",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "460",
              "left": "890",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "3ae24add-a6be-46b8-8a4d-3f7f8a039474",
              "id": 803
            },
            {
              "@type": "WorkflowStep",
              "name": "Splunk query for Sysmon MSHTA",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=\"sysmon\" EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} (Image=\"C:\\\\Windows\\\\System32\\\\mshta.exe\" OR Image=\"C:\\\\Windows\\\\SysWOW64\\\\mshta.exe\") | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "180",
              "left": "892",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "1efaa5c4-9d0a-4b5f-97d3-fb88c64b9e6d",
              "id": 813
            },
            {
              "@type": "WorkflowStep",
              "name": "Hunt for MSHTA",
              "description": null,
              "arguments": {
                "route": "1be60c7a-2021-4e16-8f5e-20adfbcb5f22",
                "title": "T1218.005 - Hunt for Mshta",
                "resources": [
                  "hunt"
                ],
                "inputVariables": [
                  {
                    "name": "siem",
                    "type": "picklists",
                    "label": "SIEM",
                    "title": "Picklist",
                    "usable": true,
                    "tooltip": "Choose your SIEM",
                    "dataType": "picklist",
                    "formType": "picklist",
                    "required": true,
                    "_expanded": true,
                    "mmdUpdate": true,
                    "collection": false,
                    "dataSource": {
                      "model": "picklists",
                      "query": {
                        "sort": [
                          {
                            "field": "orderIndex",
                            "direction": "ASC"
                          }
                        ],
                        "logic": "AND",
                        "filters": [
                          {
                            "field": "listName__name",
                            "value": "SIEMs",
                            "operator": "eq"
                          }
                        ]
                      },
                      "displayConditions": {
                        "876c1483-416b-4d2f-8138-15769ae16d5c": {
                          "conditions": null,
                          "visibility": "visible"
                        },
                        "bcebcab1-3f93-468a-9f3f-91e5c511a0b5": {
                          "conditions": null,
                          "visibility": "visible"
                        }
                      }
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "_nameTouched": true,
                    "defaultValue": {
                      "id": 280,
                      "@id": "/api/3/picklists/876c1483-416b-4d2f-8138-15769ae16d5c",
                      "icon": null,
                      "@type": "Picklist",
                      "color": null,
                      "display": "Elastic",
                      "listName": "/api/3/picklist_names/98830189-afff-40e6-bed1-94012551dc67",
                      "itemValue": "Elastic",
                      "orderIndex": 1
                    },
                    "displayTemplate": "{{ itemValue }}",
                    "lengthConstraint": false,
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "siem": "{{vars.request.data[\"siem\"]}}",
                      "sourceIP": "{{ vars.sourceIP }}",
                      "processID": "{{ vars.processID }}",
                      "sourcetool": "{{ vars.sourcetool }}",
                      "accountname": "{{ vars.accountname }}",
                      "commandline": "{{ vars.commandline }}",
                      "processGUID": "{{ vars.processGUID }}",
                      "processname": "{{ vars.processname }}",
                      "computername": "{{ vars.computername }}",
                      "destinationIP": "{{ vars.destinationIP }}",
                      "parentprocessGUID": "{{ vars.parentprocessGUID }}",
                      "parentprocessname": "{{ vars.parentprocessname }}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "hunt": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "308",
              "left": "26",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "f2e8e76d-1762-44a1-bd7c-64bb665ad696",
              "id": 804
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Elastic Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_Query_for_Sysmon_MSHTA.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query identified MSHTA.exe was invoked on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-Mshta-{{vars.item._source.image_path.split(\"\\\\\")[-1] }} executed",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "MSHTA",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "An attempt to invoke mshta.exe was observed. MSHTA can be used as an alternate method of executing local and remotely hosted executables. In most networks execution of MSHTA.exe is an uncommon occurrence and should be investigated as a potential sign of compromise.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1170",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "366",
              "left": "1440",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "0c91c39e-2cf9-4c7e-be80-8367dcdb9f90",
              "id": 805
            },
            {
              "@type": "WorkflowStep",
              "name": "Deduplicate Comments",
              "description": null,
              "arguments": {
                "arguments": {
                  "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
              },
              "status": null,
              "top": "307",
              "left": "1740",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "180043eb-963c-42b6-9565-17d07c53df4e",
              "id": 806
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Splunk Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Results_for_Sysmon_MSHTA.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query identified MSHTA.exe was invoked on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-Mshta-{{vars.item.process_exec}} executed",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "MSHTA",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.EventChannel}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "An attempt to invoke mshta.exe was observed. MSHTA can be used as an alternate method of executing local and remotely hosted executables. In most networks execution of MSHTA.exe is an uncommon occurrence and should be investigated as a potential sign of compromise.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1170",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "180",
              "left": "1440",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "cedae91a-fe3c-4a0c-8ff2-235c6b5f07d2",
              "id": 807
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Results for Sysmon MSHTA",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Splunk_query_for_Sysmon_MSHTA.data.sid}}\"}",
                  "additional_args": "{\"a\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "180",
              "left": "1160",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "3bcb4c0b-9f25-49e4-9c99-0f3b391d3d06",
              "id": 808
            },
            {
              "@type": "WorkflowStep",
              "name": "Which SIEM",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "step_iri": "/api/3/workflow_steps/d1e0ef8c-d8f0-4135-8f08-f3524a623089",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Splunk\" }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/cc991b1d-f41f-484c-a89c-632918ab2dd6",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Elastic\" }}"
                  }
                ]
              },
              "status": null,
              "top": "307",
              "left": "306",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "a7b075d7-1e90-4876-b480-793df69bd215",
              "id": 809
            },
            {
              "@type": "WorkflowStep",
              "name": "Splunk query for MSHTA Child",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=\"sysmon\" EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} (ParentImage=\"C:\\\\Windows\\\\System32\\\\mshta.exe\" OR ParentImage=\"C:\\\\Windows\\\\SysWOW64\\\\mshta.exe\") | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "267",
              "left": "894",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "105c3f65-8938-415a-8a14-aa3f7a808fa2",
              "id": 810
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic Query for Sysmon MSHTA",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:\"1\" AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND (image_path:\"C:\\\\Windows\\\\System32\\\\mshta.exe\" OR image_path:\"C:\\\\Windows\\\\SysWOW64\\\\mshta.exe\")",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "366",
              "left": "880",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "514faa1c-dc2b-4738-aca9-e7c6b67e6b38",
              "id": 811
            },
            {
              "@type": "WorkflowStep",
              "name": "Copy  of Create and Link Elastic Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_Query_for_MSHTA_Child.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query identified MSHTA.exe spawned child process {{vars.item._source.image_path.split(\"\\\\\")[-1] }} on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-Mshta-{{vars.item._source.image_path.split(\"\\\\\")[-1] }} spawned",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "MSHTA-Child",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "An attempt to invoke mshta.exe was observed. MSHTA can be used as an alternate method of executing local and remotely hosted executables. In most networks execution of MSHTA.exe is an uncommon occurrence and should be investigated as a potential sign of compromise.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1170",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "460",
              "left": "1440",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "cd93ea39-0ce0-426e-9f49-3a2cadba3be6",
              "id": 814
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Set Elastic hunt times",
              "targetStep": "/api/3/workflow_steps/cc991b1d-f41f-484c-a89c-632918ab2dd6",
              "sourceStep": "/api/3/workflow_steps/a7b075d7-1e90-4876-b480-793df69bd215",
              "label": "",
              "isExecuted": false,
              "uuid": "b4cd9fe7-b0a1-4059-a0fa-835dc6e0b7ec"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Get Results for Sysmon MSHTA -> Copy  of Create and Link Splunk Alert",
              "targetStep": "/api/3/workflow_steps/ad5092e1-7db7-430b-947e-9c80472fecb8",
              "sourceStep": "/api/3/workflow_steps/46829715-d455-4d21-9f45-232090436b11",
              "label": null,
              "isExecuted": false,
              "uuid": "2eb451dd-70b1-4954-b41d-d77f0d392472"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create and Link Splunk Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/180043eb-963c-42b6-9565-17d07c53df4e",
              "sourceStep": "/api/3/workflow_steps/ad5092e1-7db7-430b-947e-9c80472fecb8",
              "label": null,
              "isExecuted": false,
              "uuid": "9b39222b-1514-422e-9b90-0e949cecec6f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic Query for Sysmon CMSTP -> Copy  of Create and Link Alert",
              "targetStep": "/api/3/workflow_steps/0c91c39e-2cf9-4c7e-be80-8367dcdb9f90",
              "sourceStep": "/api/3/workflow_steps/514faa1c-dc2b-4738-aca9-e7c6b67e6b38",
              "label": null,
              "isExecuted": false,
              "uuid": "f72f49a9-03e1-474a-9a21-cc9a5b8d55cd"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Copy  of Splunk query for Sysmon MSHTA",
              "targetStep": "/api/3/workflow_steps/105c3f65-8938-415a-8a14-aa3f7a808fa2",
              "sourceStep": "/api/3/workflow_steps/d1e0ef8c-d8f0-4135-8f08-f3524a623089",
              "label": null,
              "isExecuted": false,
              "uuid": "573b43c5-1dd6-4666-b744-b351db9c1cf5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Splunk query for Sysmon CMSTP -> Get Results for Sysmon CMSTP",
              "targetStep": "/api/3/workflow_steps/3bcb4c0b-9f25-49e4-9c99-0f3b391d3d06",
              "sourceStep": "/api/3/workflow_steps/1efaa5c4-9d0a-4b5f-97d3-fb88c64b9e6d",
              "label": null,
              "isExecuted": false,
              "uuid": "ed5fdd25-44df-49be-9fa6-e39f2c4af17a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> Elastic Query for Sysmon CMSTP",
              "targetStep": "/api/3/workflow_steps/514faa1c-dc2b-4738-aca9-e7c6b67e6b38",
              "sourceStep": "/api/3/workflow_steps/cc991b1d-f41f-484c-a89c-632918ab2dd6",
              "label": null,
              "isExecuted": false,
              "uuid": "1a7c168b-dd4c-4a07-ba82-8a6ab6e05b15"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> Copy  of Elastic Query for Sysmon MSHTA",
              "targetStep": "/api/3/workflow_steps/3ae24add-a6be-46b8-8a4d-3f7f8a039474",
              "sourceStep": "/api/3/workflow_steps/cc991b1d-f41f-484c-a89c-632918ab2dd6",
              "label": null,
              "isExecuted": false,
              "uuid": "4b4e21c9-d161-4cc8-a8b8-35ddbab53e6e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Splunk query for Sysmon MSHTA -> Copy  of Get Results for Sysmon MSHTA",
              "targetStep": "/api/3/workflow_steps/46829715-d455-4d21-9f45-232090436b11",
              "sourceStep": "/api/3/workflow_steps/105c3f65-8938-415a-8a14-aa3f7a808fa2",
              "label": null,
              "isExecuted": false,
              "uuid": "acaa0557-be2c-4cc5-a9b5-98021d45ecdf"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/180043eb-963c-42b6-9565-17d07c53df4e",
              "sourceStep": "/api/3/workflow_steps/cedae91a-fe3c-4a0c-8ff2-235c6b5f07d2",
              "label": null,
              "isExecuted": false,
              "uuid": "69b18284-4cb4-4815-845c-dfc458826f86"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Copy  of Set Elastic hunt times",
              "targetStep": "/api/3/workflow_steps/d1e0ef8c-d8f0-4135-8f08-f3524a623089",
              "sourceStep": "/api/3/workflow_steps/a7b075d7-1e90-4876-b480-793df69bd215",
              "label": "",
              "isExecuted": false,
              "uuid": "c2724e10-526a-4fbc-8ed1-21cc3ae019f7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Splunk query for Sysmon CMSTP",
              "targetStep": "/api/3/workflow_steps/1efaa5c4-9d0a-4b5f-97d3-fb88c64b9e6d",
              "sourceStep": "/api/3/workflow_steps/d1e0ef8c-d8f0-4135-8f08-f3524a623089",
              "label": null,
              "isExecuted": false,
              "uuid": "6cd525d2-d686-4bbd-b496-52b2647c13aa"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Results for Sysmon CMSTP -> Create Splunk Alert",
              "targetStep": "/api/3/workflow_steps/cedae91a-fe3c-4a0c-8ff2-235c6b5f07d2",
              "sourceStep": "/api/3/workflow_steps/3bcb4c0b-9f25-49e4-9c99-0f3b391d3d06",
              "label": null,
              "isExecuted": false,
              "uuid": "350a878d-4a8d-4b97-a43a-1b41aae78202"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create and Link Elastic Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/180043eb-963c-42b6-9565-17d07c53df4e",
              "sourceStep": "/api/3/workflow_steps/cd93ea39-0ce0-426e-9f49-3a2cadba3be6",
              "label": null,
              "isExecuted": false,
              "uuid": "8a622f4d-88aa-4c9f-a921-4b8ffffc61aa"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Elastic Query for Sysmon MSHTA -> Copy  of Create and Link Elastic Alert",
              "targetStep": "/api/3/workflow_steps/cd93ea39-0ce0-426e-9f49-3a2cadba3be6",
              "sourceStep": "/api/3/workflow_steps/3ae24add-a6be-46b8-8a4d-3f7f8a039474",
              "label": null,
              "isExecuted": false,
              "uuid": "f9b0156f-5056-4146-92c9-a8524f3b6a46"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Hunt for CMSTP -> Which SIEM",
              "targetStep": "/api/3/workflow_steps/a7b075d7-1e90-4876-b480-793df69bd215",
              "sourceStep": "/api/3/workflow_steps/f2e8e76d-1762-44a1-bd7c-64bb665ad696",
              "label": null,
              "isExecuted": false,
              "uuid": "adaa0682-5685-4094-b510-1c87f0ffc519"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create and Link Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/180043eb-963c-42b6-9565-17d07c53df4e",
              "sourceStep": "/api/3/workflow_steps/0c91c39e-2cf9-4c7e-be80-8367dcdb9f90",
              "label": null,
              "isExecuted": false,
              "uuid": "bf2c7d4a-8cdb-4c26-b6c2-f379ec243697"
            }
          ],
          "priority": null,
          "uuid": "bdd73958-b4a9-4da2-9d03-b7749d556518",
          "recordTags": [],
          "id": 129,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214964,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215041,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "HUNTS - Control Panel Items (T1218.002)",
          "aliasName": null,
          "tag": "ATT&CK, Defense_Evasion, Execution, Control_Panel_Items",
          "description": "Identifies processes spawned by Control Panel files and execution of non-standard .cpl files",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/c3d3d88b-9ca9-4dfb-aa62-4b8685eec3b8",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/27bc22f5-d669-4b62-a6be-8b5fb0c05dd0",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Elastic Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_Query_for_Control_Panel_Item_Execution.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query identified control.exe spawning potentially non-standard child process {{vars.item._source.image_path.split(\"\\\\\")[-1] }} on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-Control Panel Items-{{vars.item._source.image_path.split(\"\\\\\")[-1]}} spawned by control.exe",
                  "epochTime": "{{arrow.get(vars.item._source.event_data.UtcTime).timestamp}}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "Control Panel Items",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "An attempt to invoke control.exe was observed. Control.exe is used to execute Control Panel Items. Control Panel Items are either executables (.exe files) or Control Panel files (.cpl files, which are just DLLs that use the .cpl extension instead of \".dll\"). In most organizations, it is unusual for these files to be manually executed, so the file executed and this host should be investigated for further suspicious activity.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1]}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1196",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "511",
              "left": "1393",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "b1c031f2-ada2-4cdf-aed0-5757c1b346cc",
              "id": 815
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic Query for Control Panel Item Execution",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:\"1\" AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND (parent_image_path:\"C:\\\\Windows\\\\System32\\\\control.exe\" OR parent_image_path:\"C:\\\\Windows\\\\syswow64\\\\control.exe\") NOT event_data.ParentCommandLine:\\\"C\\:\\\\Windows\\\\System32\\\\control.exe\\\"\\ \\\"C\\:\\\\Windows\\\\system32\\\\*.cpl\\\"* NOT event_data.ParentCommandLine:\\\"C\\:\\\\Windows\\\\syswow64\\\\control.exe\\\"\\ \\\"C\\:\\\\Windows\\\\syswow6432\\\\*.cpl\\\"*",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "511",
              "left": "840",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "703c7fde-9903-45f5-8047-ddbbffb34d91",
              "id": 816
            },
            {
              "@type": "WorkflowStep",
              "name": "Hunt for Control Panel Item Execution",
              "description": null,
              "arguments": {
                "route": "c1bdb17c-33a6-4652-a570-8fb64a3873ba",
                "title": "T1218.002 - Hunt for Control Panel Items",
                "resources": [
                  "hunt"
                ],
                "inputVariables": [
                  {
                    "name": "siem",
                    "type": "picklists",
                    "label": "SIEM",
                    "title": "Picklist",
                    "usable": true,
                    "tooltip": "Choose your SIEM",
                    "dataType": "picklist",
                    "formType": "picklist",
                    "required": true,
                    "_expanded": true,
                    "mmdUpdate": true,
                    "collection": false,
                    "dataSource": {
                      "model": "picklists",
                      "query": {
                        "sort": [
                          {
                            "field": "orderIndex",
                            "direction": "ASC"
                          }
                        ],
                        "logic": "AND",
                        "filters": [
                          {
                            "field": "listName__name",
                            "value": "SIEMs",
                            "operator": "eq"
                          }
                        ]
                      },
                      "displayConditions": {
                        "876c1483-416b-4d2f-8138-15769ae16d5c": {
                          "conditions": null,
                          "visibility": "visible"
                        },
                        "bcebcab1-3f93-468a-9f3f-91e5c511a0b5": {
                          "conditions": null,
                          "visibility": "visible"
                        }
                      }
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "_nameTouched": true,
                    "defaultValue": {
                      "id": 280,
                      "@id": "/api/3/picklists/876c1483-416b-4d2f-8138-15769ae16d5c",
                      "icon": null,
                      "@type": "Picklist",
                      "color": null,
                      "display": "Elastic",
                      "listName": "/api/3/picklist_names/98830189-afff-40e6-bed1-94012551dc67",
                      "itemValue": "Elastic",
                      "orderIndex": 1
                    },
                    "displayTemplate": "{{ itemValue }}",
                    "lengthConstraint": false,
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "siem": "{{vars.request.data[\"siem\"]}}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "hunt": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "360",
              "left": "0",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "27bc22f5-d669-4b62-a6be-8b5fb0c05dd0",
              "id": 817
            },
            {
              "@type": "WorkflowStep",
              "name": "Query for Control Panel Item Execution",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=sysmon EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} (ParentImage=\"C:\\\\Windows\\\\System32\\\\control.exe\" OR ParentImage=\"C:\\\\Windows\\\\syswow64\\\\control.exe\") ParentCommandLine!=\"\\\"C:\\\\Windows\\\\System32\\\\control.exe\\\" \\\"C:\\\\Windows\\\\System32\\\\*.cpl\\\"*\" ParentCommandLine!=\"\\\"C:\\\\Windows\\\\syswow64\\\\control.exe\\\" \\\"C:\\\\Windows\\syswow64\\\\*.cpl\\\"*\" | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid EventChannel UtcTime Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"a\": \"b\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "220",
              "left": "840",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "faf66791-ac7a-437c-8f5a-c266b9c7ed9e",
              "id": 818
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Control Panel Execution Results",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{\"value\": \"{{vars.steps.Query_for_Control_Panel_Item_Execution.data.sid}}\"}",
                  "additional_args": "{\"a\": \"b\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "220",
              "left": "1120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "21fc5c42-9653-4444-b9b7-bff86b017ff7",
              "id": 819
            },
            {
              "@type": "WorkflowStep",
              "name": "Deduplicate Comments",
              "description": null,
              "arguments": {
                "arguments": {
                  "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
              },
              "status": null,
              "top": "360",
              "left": "1694",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "94912d34-f192-45f1-b23a-abd2bb5dcf6b",
              "id": 820
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Splunk hunt times",
              "description": null,
              "arguments": {
                "splunkHuntEnd": "{% if vars.input.records[0].huntEnd %}latest={{vars.input.records[0].huntEnd}}{% endif %}",
                "splunkHuntStart": "earliest={{vars.input.records[0].huntStart}}"
              },
              "status": null,
              "top": "220",
              "left": "570",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "75e81e32-5084-4caa-9f5a-bdb104a02222",
              "id": 821
            },
            {
              "@type": "WorkflowStep",
              "name": "Which SIEM",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Elasticsearch",
                    "step_iri": "/api/3/workflow_steps/fe6d012f-3b3d-41e3-be6e-0cb847b71a2b",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Elastic\" }}"
                  },
                  {
                    "option": "Splunk",
                    "step_iri": "/api/3/workflow_steps/75e81e32-5084-4caa-9f5a-bdb104a02222",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Splunk\" }}"
                  }
                ]
              },
              "status": null,
              "top": "360",
              "left": "280",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "da835a03-0678-44e1-aac9-70b2160be0e7",
              "id": 822
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Elastic hunt times",
              "description": null,
              "arguments": {
                "elasticHuntEnd": "{% if vars.input.records[0].huntEnd %} {{ arrow.get(vars.input.records[0].huntEnd).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }} {% else %} now {% endif %}",
                "elasticHuntStart": "{{ arrow.get(vars.input.records[0].huntStart).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }}"
              },
              "status": null,
              "top": "511",
              "left": "570",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "fe6d012f-3b3d-41e3-be6e-0cb847b71a2b",
              "id": 823
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Control_Panel_Execution_Results.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query identified control.exe spawning potentially non-standard child process {{vars.item.process_exec}} on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-Control Panel Item-{{vars.item.CommandLine | regex_search('[^\\\\\\\\\\\\/:*?\\\"<>|\\\\r\\\\n]+(.cpl)') }}",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "Control Panel Items",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.EventChannel}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "An attempt to invoke control.exe was observed. Control.exe is used to execute Control Panel Items. Control Panel Items are either executables (.exe files) or Control Panel files (.cpl files, which are just DLLs that use the .cpl extension instead of \".dll\"). In most organizations, it is unusual for these files to be manually executed, so the file executed and this host should be investigated for further suspicious activity.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1196",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParendProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "220",
              "left": "1400",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "e2e7f5f4-3d2c-462c-8e0b-d428ce6da90f",
              "id": 824
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Get Control Panel Execution Results -> Create Splunk Alerts",
              "targetStep": "/api/3/workflow_steps/e2e7f5f4-3d2c-462c-8e0b-d428ce6da90f",
              "sourceStep": "/api/3/workflow_steps/21fc5c42-9653-4444-b9b7-bff86b017ff7",
              "label": null,
              "isExecuted": false,
              "uuid": "b7a8ce62-5993-4779-ae0d-c9a996f2cc5f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Elastic Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/94912d34-f192-45f1-b23a-abd2bb5dcf6b",
              "sourceStep": "/api/3/workflow_steps/b1c031f2-ada2-4cdf-aed0-5757c1b346cc",
              "label": null,
              "isExecuted": false,
              "uuid": "b02ab99f-b2b4-45f6-bd21-060e41ece95a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Query for Control Panel Item Execution",
              "targetStep": "/api/3/workflow_steps/faf66791-ac7a-437c-8f5a-c266b9c7ed9e",
              "sourceStep": "/api/3/workflow_steps/75e81e32-5084-4caa-9f5a-bdb104a02222",
              "label": null,
              "isExecuted": false,
              "uuid": "c0997a6a-bcc9-40b1-9d87-2a2674195056"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic Query for Control Panel Item Execution -> Create and Elastic Alert",
              "targetStep": "/api/3/workflow_steps/b1c031f2-ada2-4cdf-aed0-5757c1b346cc",
              "sourceStep": "/api/3/workflow_steps/703c7fde-9903-45f5-8047-ddbbffb34d91",
              "label": null,
              "isExecuted": false,
              "uuid": "17c27481-b089-416f-8bdc-d505c5297cbc"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/94912d34-f192-45f1-b23a-abd2bb5dcf6b",
              "sourceStep": "/api/3/workflow_steps/e2e7f5f4-3d2c-462c-8e0b-d428ce6da90f",
              "label": null,
              "isExecuted": false,
              "uuid": "44acecfc-fb2b-4b5f-bc04-6d7e6a3dd81d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Copy  of Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/fe6d012f-3b3d-41e3-be6e-0cb847b71a2b",
              "sourceStep": "/api/3/workflow_steps/da835a03-0678-44e1-aac9-70b2160be0e7",
              "label": "Elasticsearch",
              "isExecuted": false,
              "uuid": "708f85ff-00d2-4530-acff-98f8c5561dc5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Query for Control Panel Item Execution -> Get Control Panel Execution Results",
              "targetStep": "/api/3/workflow_steps/21fc5c42-9653-4444-b9b7-bff86b017ff7",
              "sourceStep": "/api/3/workflow_steps/faf66791-ac7a-437c-8f5a-c266b9c7ed9e",
              "label": null,
              "isExecuted": false,
              "uuid": "92c153e8-175e-4b85-99b8-95cfbead295a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> Elastic Query for Control Panel Item Execution",
              "targetStep": "/api/3/workflow_steps/703c7fde-9903-45f5-8047-ddbbffb34d91",
              "sourceStep": "/api/3/workflow_steps/fe6d012f-3b3d-41e3-be6e-0cb847b71a2b",
              "label": null,
              "isExecuted": false,
              "uuid": "befb9876-c210-4f3b-89f4-7561a8085b07"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/75e81e32-5084-4caa-9f5a-bdb104a02222",
              "sourceStep": "/api/3/workflow_steps/da835a03-0678-44e1-aac9-70b2160be0e7",
              "label": "Splunk",
              "isExecuted": false,
              "uuid": "3d3c423f-09f4-4662-b58f-da036ed4d023"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Hunt for Control Panel Item Execution -> Which SIEM",
              "targetStep": "/api/3/workflow_steps/da835a03-0678-44e1-aac9-70b2160be0e7",
              "sourceStep": "/api/3/workflow_steps/27bc22f5-d669-4b62-a6be-8b5fb0c05dd0",
              "label": null,
              "isExecuted": false,
              "uuid": "70d373f7-c663-478d-b929-99d2691aa662"
            }
          ],
          "priority": null,
          "uuid": "ea5f9b32-03e3-4ffc-b72f-8732c3888cac",
          "recordTags": [],
          "id": 130,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214964,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215041,
          "owners": [],
          "isPrivate": false
        }
      ]
    },
    {
      "@type": "WorkflowCollection",
      "name": "13 - MITRE ATT&CK™ - Process Execution",
      "description": "Playbooks designed to hunt Process Execution Techniques identified in the MITRE ATT&CK Framework",
      "visible": true,
      "image": null,
      "uuid": "da766756-66b5-47bc-a027-f2f3bac79069",
      "id": 22,
      "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "createDate": 1629214962,
      "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "modifyDate": 1629214962,
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "HUNTS - XSL Script Processing (T1220)",
          "aliasName": null,
          "tag": "ATT&CK, Execution, Defense_Evasion, XSL_Script_Processing",
          "description": "Detects process execution via the use of XSL scripts. XSL scripts can allow a user to bypass application whitelisting by executing code through trusted OS binaries.",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "sourceIP",
            "destinationIP",
            "processname",
            "processID",
            "processGUID",
            "parentprocessname",
            "parentprocessGUID",
            "accountname",
            "computername",
            "commandline",
            "sourcetool"
          ],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/da766756-66b5-47bc-a027-f2f3bac79069",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/082b0067-53cb-40d1-9602-3506e679ed8b",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Elastic query for WMIC XSL Script Processing",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:1 AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND (image_path:\"C:\\\\Windows\\\\System32\\\\wbem\\\\WMIC.exe\" OR image_path:\"C:\\\\Windows\\\\SysWOW64\\\\wbem\\\\WMIC.exe\") AND event_data.CommandLine:*.xsl*",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "334",
              "left": "1000",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "c95fc467-a4cc-48e7-8069-cf9c5f1aec68",
              "id": 399
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Results 3",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Splunk_query_for_Child_Processes_via__XSL_Script_Processing.data.sid}}\"}",
                  "additional_args": "{\"a\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "200",
              "left": "1300",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "151653ac-97e7-4d14-994f-7744f002ce6c",
              "id": 400
            },
            {
              "@type": "WorkflowStep",
              "name": "Copy 1 of Copy  of Create and Link WMIC Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_query_for_Child_Processes_via_XSL_Script_Processing.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query identified an XSL script in the command line, leading to spawning of child process {{vars.item._source.image_path.split(\"\\\\\")[-1]}} on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.parent_image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-XSL Script Processing-Child Process-{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "XSL Script Processing (Process Spawned)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "An attempt to invoke an XSL script from the command line resulting in the spawning of a child process was observed. XSL scripts can be used to execute arbitrary code via trusted binary execution. Use of this technique may bypass application whitelisting and allow an attacker to bypass other defenses. Attention should be paid to the commands passed as well as processes spawned.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1220",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "540",
              "left": "1620",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "8792edf2-9781-460f-805c-dcf9a307c33b",
              "id": 401
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic query for MSXSL XSL Script Processing",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:1 AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND (event_data.CommandLine:*.xsl* OR event_data.Product:\"Command Line XSLT\" OR image_path:\"*msxsl.exe\") NOT (image_path:\"C:\\\\Windows\\\\System32\\\\wbem\\\\WMIC.exe\" OR image_path:\"C:\\\\Windows\\\\SysWOW64\\\\wbem\\\\WMIC.exe\")",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "432",
              "left": "1000",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "bcbd0346-103a-40c5-839a-0d1eb79ff24d",
              "id": 402
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Results",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Splunk_query_for_WMIC_XSL_Script_Processing.data.sid}}\"}",
                  "additional_args": "{\"a\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "33",
              "left": "1300",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "6f6e02cf-e132-4746-b16b-2c2d16655957",
              "id": 403
            },
            {
              "@type": "WorkflowStep",
              "name": "Splunk query for Child Processes via  XSL Script Processing",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=sysmon EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} ParentCommandLine=\"*.xsl*\" | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "200",
              "left": "1000",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "f99a0bc5-28ad-4fda-bba8-5196bf39fa6f",
              "id": 404
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Splunk hunt times",
              "description": null,
              "arguments": {
                "splunkHuntEnd": "{% if vars.input.records[0].huntEnd %}latest={{vars.input.records[0].huntEnd}}{% endif %}",
                "splunkHuntStart": "earliest={{vars.input.records[0].huntStart}}"
              },
              "status": null,
              "top": "114",
              "left": "689",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "3592cc3e-df7e-4470-918c-92136b4f9f11",
              "id": 405
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic query for Child Processes via XSL Script Processing",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:1 AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND event_data.ParentCommandLine:*.xsl*",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "540",
              "left": "1000",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "662c1776-e408-4a9d-b929-4aba2b346aae",
              "id": 406
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link WMIC Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Results.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query identified invocation on an XSL script via WMIC, which spawned child process {{vars.item.process_exec}} on {{vars.item.host}} at {{vars.item.TimeCreated}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-XSL Script Processing-{{vars.item.process_exec}} executed a .XSL file",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "XSL Script Processing (WMIC)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.vendor_product}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "An attempt to invoke an XSL script using WMIC was observed. XSL can be used to execute arbitrary code via trusted binary execution. Use of this technique may bypass application whitelisting and allow an attacker to bypass other defenses. Attention should be paid to the commands passed as well as processes spawned.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1220",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "33",
              "left": "1620",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "cfb677b2-54e5-4bcd-b06a-7ef6f797d892",
              "id": 407
            },
            {
              "@type": "WorkflowStep",
              "name": "Hunt for XSL Script Processing",
              "description": null,
              "arguments": {
                "route": "4a7e396f-e09f-4dee-9ac4-803ac5381837",
                "title": "T1220 - Hunt for XSL Script Processing",
                "resources": [
                  "hunt"
                ],
                "inputVariables": [
                  {
                    "name": "siem",
                    "type": "picklists",
                    "label": "SIEM",
                    "title": "Picklist",
                    "usable": true,
                    "tooltip": "Choose your SIEM",
                    "dataType": "picklist",
                    "formType": "picklist",
                    "required": true,
                    "_expanded": true,
                    "collection": false,
                    "dataSource": {
                      "model": "picklists",
                      "query": {
                        "sort": [
                          {
                            "field": "orderIndex",
                            "direction": "ASC"
                          }
                        ],
                        "logic": "AND",
                        "filters": [
                          {
                            "field": "listName__name",
                            "value": "SIEMs",
                            "operator": "eq"
                          }
                        ]
                      },
                      "displayConditions": {
                        "876c1483-416b-4d2f-8138-15769ae16d5c": {
                          "conditions": null,
                          "visibility": "visible"
                        },
                        "bcebcab1-3f93-468a-9f3f-91e5c511a0b5": {
                          "conditions": null,
                          "visibility": "visible"
                        }
                      }
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "_nameTouched": true,
                    "defaultValue": {
                      "id": 280,
                      "@id": "/api/3/picklists/876c1483-416b-4d2f-8138-15769ae16d5c",
                      "icon": null,
                      "@type": "Picklist",
                      "color": null,
                      "display": "Elastic",
                      "listName": "/api/3/picklist_names/98830189-afff-40e6-bed1-94012551dc67",
                      "itemValue": "Elastic",
                      "orderIndex": 1
                    },
                    "useModuleField": false,
                    "displayTemplate": "{{ itemValue }}",
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "siem": "{{vars.request.data[\"siem\"]}}",
                      "sourceIP": "{{ vars.sourceIP }}",
                      "processID": "{{ vars.processID }}",
                      "sourcetool": "{{ vars.sourcetool }}",
                      "accountname": "{{ vars.accountname }}",
                      "commandline": "{{ vars.commandline }}",
                      "processGUID": "{{ vars.processGUID }}",
                      "processname": "{{ vars.processname }}",
                      "computername": "{{ vars.computername }}",
                      "destinationIP": "{{ vars.destinationIP }}",
                      "parentprocessGUID": "{{ vars.parentprocessGUID }}",
                      "parentprocessname": "{{ vars.parentprocessname }}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "hunt": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "180",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "082b0067-53cb-40d1-9602-3506e679ed8b",
              "id": 408
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Child Process Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Results_3.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query identified an XSL script in the command line, leading to spawning of child process {{vars.item.process_exec}} on {{vars.item.host}} at {{vars.item.TimeCreated}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-XSL Script Processing-{{vars.item.process_exec}} was spawned from execution of a .XSL file",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "XSL Script Processing (Process Spawned)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.vendor_product}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "An attempt to invoke an XSL script from the command line resulting in the spawning of a child process was observed. XSL scripts can be used to execute arbitrary code via trusted binary execution. Use of this technique may bypass application whitelisting and allow an attacker to bypass other defenses. Attention should be paid to the commands passed as well as processes spawned.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1220",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "200",
              "left": "1620",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "5cc0f40e-091f-444e-9d20-d1eebcd2b319",
              "id": 409
            },
            {
              "@type": "WorkflowStep",
              "name": "Deduplicate Comments",
              "description": null,
              "arguments": {
                "arguments": {
                  "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
              },
              "status": null,
              "top": "280",
              "left": "1948",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "3e601b7c-ce79-45fd-a460-dd5cb8799b42",
              "id": 410
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link MSXSL Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Results_2.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query identified XSL script execution via process {{vars.item.process_exec}} on {{vars.item.host}} at {{vars.item.TimeCreated}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-XSL Script Processing-{{vars.item.process_exec}} executed a .XSL file",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "XSL Script Processing (MSXSL or similar)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.vendor_product}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "An attempt to invoke an XSL script from the command line was observed. XSL can be used to execute arbitrary code via trusted binary execution. Use of this technique may bypass application whitelisting and allow an attacker to bypass other defenses. Attention should be paid to the commands passed as well as processes spawned.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1220",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "114",
              "left": "1620",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "c7b58534-0526-41d4-b7cb-cf48b61fa877",
              "id": 411
            },
            {
              "@type": "WorkflowStep",
              "name": "Copy2 of Create and Link MSXSL Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_query_for_MSXSL_XSL_Script_Processing.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query identified XSL script execution via process {{vars.item._source.image_path.split(\"\\\\\")[-1] }} on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.parent_image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-XSL Script Processing-MSXSL",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "XSL Script Processing (MSXSL or similar)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "An attempt to invoke an XSL script from the command line was observed. XSL can be used to execute arbitrary code via trusted binary execution. Use of this technique may bypass application whitelisting and allow an attacker to bypass other defenses. Attention should be paid to the commands passed  as well as processes spawned.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1220",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "432",
              "left": "1620",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "36448b50-37d5-47ba-8880-5fc5aad00ced",
              "id": 412
            },
            {
              "@type": "WorkflowStep",
              "name": "Copy  of Create and Link WMIC Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_query_for_WMIC_XSL_Script_Processing.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query identified invocation on an XSL script via WMIC on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.parent_image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-XSL Script Processing-Child Process-{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "XSL Script Processing (WMIC)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "An attempt to invoke an XSL script using WMIC was observed. XSL can be used to execute arbitrary code via trusted binary execution. Use of this technique may bypass application whitelisting and allow an attacker to bypass other defenses. Attention should be paid to the commands passed as well as processes spawned.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1220",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "333",
              "left": "1620",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "822bfa63-fb35-49d8-8310-a93260431558",
              "id": 413
            },
            {
              "@type": "WorkflowStep",
              "name": "Splunk query for MSXSL XSL Script Processing",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=sysmon EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} CommandLine=\"*.xsl*\" OR Product=\"Command Line XSLT\" OR Image=\"*.msxsl.exe\" Image!=\"C:\\\\Windows\\\\System32\\\\wbem\\\\WMIC.exe\" Image!=\"C:\\\\Windows\\\\SysWOW64\\\\wbem\\\\WMIC.exe\" | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "114",
              "left": "1000",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "e95b7fe2-e0e7-4598-acb2-a2a9ffc090df",
              "id": 414
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Elastic hunt times",
              "description": null,
              "arguments": {
                "elasticHuntEnd": "{% if vars.input.records[0].huntEnd %} {{ arrow.get(vars.input.records[0].huntEnd).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }} {% else %} now {% endif %}",
                "elasticHuntStart": "{{ arrow.get(vars.input.records[0].huntStart).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }}"
              },
              "status": null,
              "top": "432",
              "left": "691",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "2bf442de-3707-467e-99cd-5f847a130323",
              "id": 415
            },
            {
              "@type": "WorkflowStep",
              "name": "Which SIEM",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Splunk",
                    "step_iri": "/api/3/workflow_steps/3592cc3e-df7e-4470-918c-92136b4f9f11",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Splunk\" }}"
                  },
                  {
                    "option": "Elasticsearch",
                    "step_iri": "/api/3/workflow_steps/2bf442de-3707-467e-99cd-5f847a130323",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Elastic\" }}"
                  }
                ]
              },
              "status": null,
              "top": "180",
              "left": "340",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "368b706b-9c2d-4284-8690-7173d285643e",
              "id": 416
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Results 2",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Splunk_query_for_MSXSL_XSL_Script_Processing.data.sid}}\"}",
                  "additional_args": "{\"a\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "114",
              "left": "1300",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "e2c9dac6-d26e-4b70-8c28-6597f6308d8f",
              "id": 417
            },
            {
              "@type": "WorkflowStep",
              "name": "Splunk query for WMIC XSL Script Processing",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=sysmon EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} (Image=\"C:\\\\Windows\\\\System32\\\\wbem\\\\WMIC.exe\" OR Image=\"C:\\\\Windows\\\\SysWOW64\\\\wbem\\\\WMIC.exe\") AND CommandLine=\"*.xsl*\" | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "33",
              "left": "1000",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "98e95f71-7080-4165-a6f8-10a0e6b52b03",
              "id": 418
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/3e601b7c-ce79-45fd-a460-dd5cb8799b42",
              "sourceStep": "/api/3/workflow_steps/cfb677b2-54e5-4bcd-b06a-7ef6f797d892",
              "label": null,
              "isExecuted": false,
              "uuid": "98ebcd46-b844-4c3e-a25a-c3ac60082dc9"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> elastic",
              "targetStep": "/api/3/workflow_steps/c95fc467-a4cc-48e7-8069-cf9c5f1aec68",
              "sourceStep": "/api/3/workflow_steps/2bf442de-3707-467e-99cd-5f847a130323",
              "label": null,
              "isExecuted": false,
              "uuid": "7151596a-c5cc-43d1-94e0-9c1ec40061a7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create and Link WMIC Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/3e601b7c-ce79-45fd-a460-dd5cb8799b42",
              "sourceStep": "/api/3/workflow_steps/822bfa63-fb35-49d8-8310-a93260431558",
              "label": null,
              "isExecuted": false,
              "uuid": "905b02ad-4efc-4b29-947b-78212fd8b912"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Splunk query for MSXSL XSL Script Processing",
              "targetStep": "/api/3/workflow_steps/e95b7fe2-e0e7-4598-acb2-a2a9ffc090df",
              "sourceStep": "/api/3/workflow_steps/3592cc3e-df7e-4470-918c-92136b4f9f11",
              "label": null,
              "isExecuted": false,
              "uuid": "ef64ffe7-7762-446f-a773-670f6c671662"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Splunk query for Child Processes via  XSL Script Processing",
              "targetStep": "/api/3/workflow_steps/f99a0bc5-28ad-4fda-bba8-5196bf39fa6f",
              "sourceStep": "/api/3/workflow_steps/3592cc3e-df7e-4470-918c-92136b4f9f11",
              "label": null,
              "isExecuted": false,
              "uuid": "61e5e826-ca49-4f10-975a-6418c360c7f2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Hunt for XSL Script Processing -> Which SIEM",
              "targetStep": "/api/3/workflow_steps/368b706b-9c2d-4284-8690-7173d285643e",
              "sourceStep": "/api/3/workflow_steps/082b0067-53cb-40d1-9602-3506e679ed8b",
              "label": null,
              "isExecuted": false,
              "uuid": "c53993a8-2bfe-4601-a318-3d76af14155c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy 1 of Copy  of Create and Link WMIC Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/3e601b7c-ce79-45fd-a460-dd5cb8799b42",
              "sourceStep": "/api/3/workflow_steps/8792edf2-9781-460f-805c-dcf9a307c33b",
              "label": null,
              "isExecuted": false,
              "uuid": "edd9291c-2f33-4398-a8d6-707533fe3c3a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> a",
              "targetStep": "/api/3/workflow_steps/662c1776-e408-4a9d-b929-4aba2b346aae",
              "sourceStep": "/api/3/workflow_steps/2bf442de-3707-467e-99cd-5f847a130323",
              "label": null,
              "isExecuted": false,
              "uuid": "e22f8b56-aa6b-4c40-8ee6-3bfbe092f8e7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic query for Child Processes via  XSL Script Processing -> Copy 1 of Copy  of Create and Link WMIC Alert",
              "targetStep": "/api/3/workflow_steps/8792edf2-9781-460f-805c-dcf9a307c33b",
              "sourceStep": "/api/3/workflow_steps/662c1776-e408-4a9d-b929-4aba2b346aae",
              "label": null,
              "isExecuted": false,
              "uuid": "d0c05af5-0c3e-409d-8556-f900c5922159"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Child Process Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/3e601b7c-ce79-45fd-a460-dd5cb8799b42",
              "sourceStep": "/api/3/workflow_steps/5cc0f40e-091f-444e-9d20-d1eebcd2b319",
              "label": null,
              "isExecuted": false,
              "uuid": "57038418-aea3-4621-a7ca-2fa2b31fa368"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/3592cc3e-df7e-4470-918c-92136b4f9f11",
              "sourceStep": "/api/3/workflow_steps/368b706b-9c2d-4284-8690-7173d285643e",
              "label": "Splunk",
              "isExecuted": false,
              "uuid": "900d5922-20ca-42a2-83a7-183983103c87"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Get Results for Sysmon -> Copy  of Create and Link Alert",
              "targetStep": "/api/3/workflow_steps/c7b58534-0526-41d4-b7cb-cf48b61fa877",
              "sourceStep": "/api/3/workflow_steps/e2c9dac6-d26e-4b70-8c28-6597f6308d8f",
              "label": null,
              "isExecuted": false,
              "uuid": "6e5eebce-be2c-4f86-97ab-096e8c78e5c6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic query for WMIC XSL Script Processing -> Copy  of Create and Link WMIC Alert",
              "targetStep": "/api/3/workflow_steps/822bfa63-fb35-49d8-8310-a93260431558",
              "sourceStep": "/api/3/workflow_steps/c95fc467-a4cc-48e7-8069-cf9c5f1aec68",
              "label": null,
              "isExecuted": false,
              "uuid": "506992bc-d116-4a2c-ab44-9e5cef2d4d7a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Splunk query for WMIC XSL Script Processing",
              "targetStep": "/api/3/workflow_steps/98e95f71-7080-4165-a6f8-10a0e6b52b03",
              "sourceStep": "/api/3/workflow_steps/3592cc3e-df7e-4470-918c-92136b4f9f11",
              "label": null,
              "isExecuted": false,
              "uuid": "fe10aea5-4f67-4363-aa44-1b3be7766000"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy2 of Create and Link MSXSL Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/3e601b7c-ce79-45fd-a460-dd5cb8799b42",
              "sourceStep": "/api/3/workflow_steps/36448b50-37d5-47ba-8880-5fc5aad00ced",
              "label": null,
              "isExecuted": false,
              "uuid": "29024991-ac21-441a-80f6-689f14bf4570"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Set Elastic hunt times",
              "targetStep": "/api/3/workflow_steps/2bf442de-3707-467e-99cd-5f847a130323",
              "sourceStep": "/api/3/workflow_steps/368b706b-9c2d-4284-8690-7173d285643e",
              "label": "Elasticsearch",
              "isExecuted": false,
              "uuid": "ab3a8170-375c-4d74-bc71-47be5ab49d24"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Results for Sysmon CMSTP -> Create Splunk Alert",
              "targetStep": "/api/3/workflow_steps/cfb677b2-54e5-4bcd-b06a-7ef6f797d892",
              "sourceStep": "/api/3/workflow_steps/6f6e02cf-e132-4746-b16b-2c2d16655957",
              "label": null,
              "isExecuted": false,
              "uuid": "7ed3b421-60e8-4d4c-a648-c3ebda5a56cd"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Splunk query for Sysmon CMSTP -> Get Results for Sysmon CMSTP",
              "targetStep": "/api/3/workflow_steps/6f6e02cf-e132-4746-b16b-2c2d16655957",
              "sourceStep": "/api/3/workflow_steps/98e95f71-7080-4165-a6f8-10a0e6b52b03",
              "label": null,
              "isExecuted": false,
              "uuid": "75518e16-b05f-41da-8728-b70e4531883c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Splunk query for XSL Script Processing -> Copy  of Get Results for Sysmon",
              "targetStep": "/api/3/workflow_steps/e2c9dac6-d26e-4b70-8c28-6597f6308d8f",
              "sourceStep": "/api/3/workflow_steps/e95b7fe2-e0e7-4598-acb2-a2a9ffc090df",
              "label": null,
              "isExecuted": false,
              "uuid": "8049b812-34c5-4a72-8512-fb9f9f26b553"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create and Link Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/3e601b7c-ce79-45fd-a460-dd5cb8799b42",
              "sourceStep": "/api/3/workflow_steps/c7b58534-0526-41d4-b7cb-cf48b61fa877",
              "label": null,
              "isExecuted": false,
              "uuid": "24d6f3f6-0231-4072-9eac-a81e28fbdb64"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Get Results 3 -> Create and Link Child Process Alert",
              "targetStep": "/api/3/workflow_steps/5cc0f40e-091f-444e-9d20-d1eebcd2b319",
              "sourceStep": "/api/3/workflow_steps/151653ac-97e7-4d14-994f-7744f002ce6c",
              "label": null,
              "isExecuted": false,
              "uuid": "ab39c6b7-c6a6-43df-903d-d60b61e77ea1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Splunk query for Child Processes via  XSL Script Processing -> Copy  of Get Results 3",
              "targetStep": "/api/3/workflow_steps/151653ac-97e7-4d14-994f-7744f002ce6c",
              "sourceStep": "/api/3/workflow_steps/f99a0bc5-28ad-4fda-bba8-5196bf39fa6f",
              "label": null,
              "isExecuted": false,
              "uuid": "5ad08cfd-9535-42aa-9e56-2d98612f749f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> a",
              "targetStep": "/api/3/workflow_steps/bcbd0346-103a-40c5-839a-0d1eb79ff24d",
              "sourceStep": "/api/3/workflow_steps/2bf442de-3707-467e-99cd-5f847a130323",
              "label": null,
              "isExecuted": false,
              "uuid": "67eaa435-0594-4206-b772-4aacdf5475a7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic query for MSXSL XSL Script Processing -> Copy  of Copy  of Create and Link WMIC Alert",
              "targetStep": "/api/3/workflow_steps/36448b50-37d5-47ba-8880-5fc5aad00ced",
              "sourceStep": "/api/3/workflow_steps/bcbd0346-103a-40c5-839a-0d1eb79ff24d",
              "label": null,
              "isExecuted": false,
              "uuid": "5b0c807d-d899-4368-9c24-4eda81edabbf"
            }
          ],
          "priority": null,
          "uuid": "183aee4e-8440-4ce8-bb0b-de7bbd9adccd",
          "recordTags": [],
          "id": 98,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214962,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215033,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "HUNTS - Dynamic Data Exchange (T1559.002)",
          "aliasName": null,
          "tag": "ATT&CK, Dynamic_Data_Exchange, DDE, Execution",
          "description": "Identifies processes spawned by a Microsoft Office product.",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "sourceIP",
            "destinationIP",
            "processname",
            "processID",
            "processGUID",
            "parentprocessname",
            "parentprocessGUID",
            "accountname",
            "computername",
            "commandline",
            "sourcetool"
          ],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/da766756-66b5-47bc-a027-f2f3bac79069",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/7afb1498-b921-4037-a189-ae52f6df9ff7",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Set Elastic hunt times",
              "description": null,
              "arguments": {
                "elasticHuntEnd": "{% if vars.input.records[0].huntEnd %} {{ arrow.get(vars.input.records[0].huntEnd).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }} {% else %} now {% endif %}",
                "elasticHuntStart": "{{ arrow.get(vars.input.records[0].huntStart).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }}"
              },
              "status": null,
              "top": "320",
              "left": "593",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "7cc381b5-a4e2-4bb6-9542-22b3189fc508",
              "id": 419
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Results for Sysmon DDE",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Splunk_query_for_Sysmon_DDE.data.sid}}\"}",
                  "additional_args": "{\"a\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "180",
              "left": "1128",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "c7645c8d-da8b-4416-9e5f-fee1dfa1a6b8",
              "id": 420
            },
            {
              "@type": "WorkflowStep",
              "name": "Copy  of Create and Link Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_Query_for_Sysmon_DDE.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query identified a Microsoft Office product using Dynamic Data Exchange to spawn non-standard process {{vars.item._source.image_path.split(\"\\\\\")[-1] }} on {{vars.item._source.computer_name}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-Dynamic Data Exchange-{{vars.item._source.image_path.split(\"\\\\\")[-1] }} spawned",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "Dynamic Data Exchange",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "A non-standard process was spawned by a Microsoft Office product. Macros, dynamic data exchange, and other techniques may be used to cause Office products to execute other processes. In many networks, an instance of a host's instance of Microsoft Office spawning other processes is uncommon and should investigated for additional signs of compromise.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1173",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "320",
              "left": "1400",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "d5b18763-8de3-4dbb-9cde-820681ffb380",
              "id": 421
            },
            {
              "@type": "WorkflowStep",
              "name": "Splunk query for Sysmon DDE",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=sysmon EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} (ParentImage=\"C:\\\\Program Files\\\\Microsoft Office\\\\*\" OR ParentImage=\"C:\\\\Program Files (x86)\\\\Microsoft Office\\\\*\") Image!=\"C:\\\\Program Files\\\\Microsoft Office\\\\*\" Image!=\"C:\\\\Program Files (x86)\\\\Microsoft Office\\\\*\"  | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "180",
              "left": "860",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "7223550f-2fe6-40cf-a891-eca6d96b88ef",
              "id": 422
            },
            {
              "@type": "WorkflowStep",
              "name": "Deduplicate Comments",
              "description": null,
              "arguments": {
                "arguments": {
                  "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
              },
              "status": null,
              "top": "280",
              "left": "1720",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "6364d3f4-a780-47f2-a0de-f32aae372204",
              "id": 423
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic Query for Sysmon DDE",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "@timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND event_type:\"sysmon\" AND event_id:\"1\" AND (parent_image_path:\"C:\\\\Program Files\\\\Microsoft Office\\\\*\" OR parent_image_path:\"C:\\\\Program Files (x86)\\\\Microsoft Office\\\\*\") AND NOT (image_path:\"C:\\\\Program Files\\\\Microsoft Office\\\\*\" OR image_path:\"C:\\\\Program Files (x86)\\\\Microsoft Office\\\\*\")",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "320",
              "left": "860",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "26db64ab-2e69-4f70-9027-58515d8b2048",
              "id": 424
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Results_for_Sysmon_DDE.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query identified a Microsoft Office product using Dynamic Data Exchange to spawn non-standard process {{vars.item.process_exec}} on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-Dynamic Data Exchange-{{vars.item.process_exec}} spawned",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "Dynamic Data Exchange",
                  "sourceData": "",
                  "sourceTool": "{{vars.item.EventChannel}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "A non-standard process was spawned by a Microsoft Office product. Macros, dynamic data exchange, and other techniques may be used to cause Office products to execute other processes. In many networks, an instance of a host's instance of Microsoft Office spawning other processes is uncommon and should investigated for additional signs of compromise.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1173",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "180",
              "left": "1400",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "038090c0-9056-4549-8af5-e1958a426004",
              "id": 425
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Splunk hunt times",
              "description": null,
              "arguments": {
                "splunkHuntEnd": "{% if vars.input.records[0].huntEnd %}latest={{vars.input.records[0].huntEnd}}{% endif %}",
                "splunkHuntStart": "earliest={{vars.input.records[0].huntStart}}"
              },
              "status": null,
              "top": "180",
              "left": "593",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "857c80f2-3ab3-40b4-8ede-9604a576c4af",
              "id": 426
            },
            {
              "@type": "WorkflowStep",
              "name": "Which SIEM",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "step_iri": "/api/3/workflow_steps/857c80f2-3ab3-40b4-8ede-9604a576c4af",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Splunk\" }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/7cc381b5-a4e2-4bb6-9542-22b3189fc508",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Elastic\" }}"
                  }
                ]
              },
              "status": null,
              "top": "253",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "7f2da764-6916-4b08-8389-09e480a0739f",
              "id": 427
            },
            {
              "@type": "WorkflowStep",
              "name": "Hunt for Dynamic Data Exchange",
              "description": null,
              "arguments": {
                "route": "b8982c16-ef09-4e18-8b4c-f2a77f634ba8",
                "title": "T1559.002 - Hunt for Dynamic Data Exchange",
                "resources": [
                  "hunt"
                ],
                "inputVariables": [
                  {
                    "name": "siem",
                    "type": "picklists",
                    "label": "SIEM",
                    "title": "Picklist",
                    "usable": true,
                    "tooltip": "Choose your SIEM",
                    "dataType": "picklist",
                    "formType": "picklist",
                    "required": true,
                    "_expanded": true,
                    "collection": false,
                    "dataSource": {
                      "model": "picklists",
                      "query": {
                        "sort": [
                          {
                            "field": "orderIndex",
                            "direction": "ASC"
                          }
                        ],
                        "logic": "AND",
                        "filters": [
                          {
                            "field": "listName__name",
                            "value": "SIEMs",
                            "operator": "eq"
                          }
                        ]
                      },
                      "displayConditions": {
                        "876c1483-416b-4d2f-8138-15769ae16d5c": {
                          "conditions": null,
                          "visibility": "visible"
                        },
                        "bcebcab1-3f93-468a-9f3f-91e5c511a0b5": {
                          "conditions": null,
                          "visibility": "visible"
                        }
                      }
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "_nameTouched": true,
                    "defaultValue": {
                      "id": 280,
                      "@id": "/api/3/picklists/876c1483-416b-4d2f-8138-15769ae16d5c",
                      "icon": null,
                      "@type": "Picklist",
                      "color": null,
                      "display": "Elastic",
                      "listName": "/api/3/picklist_names/98830189-afff-40e6-bed1-94012551dc67",
                      "itemValue": "Elastic",
                      "orderIndex": 1
                    },
                    "displayTemplate": "{{ itemValue }}",
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "siem": "{{vars.request.data[\"siem\"]}}",
                      "sourceIP": "{{ vars.sourceIP }}",
                      "processID": "{{ vars.processID }}",
                      "sourcetool": "{{ vars.sourcetool }}",
                      "accountname": "{{ vars.accountname }}",
                      "commandline": "{{ vars.commandline }}",
                      "processGUID": "{{ vars.processGUID }}",
                      "processname": "{{ vars.processname }}",
                      "computername": "{{ vars.computername }}",
                      "destinationIP": "{{ vars.destinationIP }}",
                      "parentprocessGUID": "{{ vars.parentprocessGUID }}",
                      "parentprocessname": "{{ vars.parentprocessname }}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "hunt": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "253",
              "left": "28",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "7afb1498-b921-4037-a189-ae52f6df9ff7",
              "id": 428
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Hunt for Dynamic Data Exchange -> Which SIEM",
              "targetStep": "/api/3/workflow_steps/7f2da764-6916-4b08-8389-09e480a0739f",
              "sourceStep": "/api/3/workflow_steps/7afb1498-b921-4037-a189-ae52f6df9ff7",
              "label": null,
              "isExecuted": false,
              "uuid": "6b255668-0507-4d0f-b1e4-7afde1456872"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Copy  of Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/7cc381b5-a4e2-4bb6-9542-22b3189fc508",
              "sourceStep": "/api/3/workflow_steps/7f2da764-6916-4b08-8389-09e480a0739f",
              "label": "",
              "isExecuted": false,
              "uuid": "045a3902-1418-46a3-bffc-99a243d938fc"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create and Link Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/6364d3f4-a780-47f2-a0de-f32aae372204",
              "sourceStep": "/api/3/workflow_steps/d5b18763-8de3-4dbb-9cde-820681ffb380",
              "label": null,
              "isExecuted": false,
              "uuid": "82f9093a-0e10-4f9a-8b09-e32113d46690"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Splunk query for Sysmon DDE",
              "targetStep": "/api/3/workflow_steps/7223550f-2fe6-40cf-a891-eca6d96b88ef",
              "sourceStep": "/api/3/workflow_steps/857c80f2-3ab3-40b4-8ede-9604a576c4af",
              "label": null,
              "isExecuted": false,
              "uuid": "1f552586-e0eb-4ce1-a728-7a0b1eac791a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Results for Sysmon CMSTP -> Create Splunk Alert",
              "targetStep": "/api/3/workflow_steps/038090c0-9056-4549-8af5-e1958a426004",
              "sourceStep": "/api/3/workflow_steps/c7645c8d-da8b-4416-9e5f-fee1dfa1a6b8",
              "label": null,
              "isExecuted": false,
              "uuid": "c651a7d4-4c72-4dc8-b4fc-f50e76e09f24"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/6364d3f4-a780-47f2-a0de-f32aae372204",
              "sourceStep": "/api/3/workflow_steps/038090c0-9056-4549-8af5-e1958a426004",
              "label": null,
              "isExecuted": false,
              "uuid": "5af8e5cd-f1e6-42e4-8cfd-a3e712529d97"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/857c80f2-3ab3-40b4-8ede-9604a576c4af",
              "sourceStep": "/api/3/workflow_steps/7f2da764-6916-4b08-8389-09e480a0739f",
              "label": "",
              "isExecuted": false,
              "uuid": "5f91fe17-0b6a-4788-aeee-d6becec13130"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Splunk query for Sysmon CMSTP -> Get Results for Sysmon CMSTP",
              "targetStep": "/api/3/workflow_steps/c7645c8d-da8b-4416-9e5f-fee1dfa1a6b8",
              "sourceStep": "/api/3/workflow_steps/7223550f-2fe6-40cf-a891-eca6d96b88ef",
              "label": null,
              "isExecuted": false,
              "uuid": "a7b1c1f9-1abb-4daf-801a-28840450e15f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> Elastic Query for Sysmon DDE",
              "targetStep": "/api/3/workflow_steps/26db64ab-2e69-4f70-9027-58515d8b2048",
              "sourceStep": "/api/3/workflow_steps/7cc381b5-a4e2-4bb6-9542-22b3189fc508",
              "label": null,
              "isExecuted": false,
              "uuid": "6cdbac3a-1236-41df-9d7a-1fea0e9f5ca7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic Query for Sysmon DDE -> Copy  of Create and Link Alert",
              "targetStep": "/api/3/workflow_steps/d5b18763-8de3-4dbb-9cde-820681ffb380",
              "sourceStep": "/api/3/workflow_steps/26db64ab-2e69-4f70-9027-58515d8b2048",
              "label": null,
              "isExecuted": false,
              "uuid": "52c7424c-e2bf-432b-985c-1b0b9d1e8af3"
            }
          ],
          "priority": null,
          "uuid": "45064161-ef1d-4798-bfdf-0206c02e44fe",
          "recordTags": [],
          "id": 99,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214962,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215033,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "HUNTS - LSASS Driver (T1547.008)",
          "aliasName": null,
          "tag": "ATT&CK, LSASS_Driver, Execution, Persistence",
          "description": "Identifies process execution via loading an illegitimate LSASS driver (DLL). This technique can be used to execute a binary whenever LSASS executes.",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "sourceIP",
            "destinationIP",
            "processname",
            "processID",
            "processGUID",
            "parentprocessname",
            "parentprocessGUID",
            "accountname",
            "computername",
            "commandline",
            "sourcetool"
          ],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/da766756-66b5-47bc-a027-f2f3bac79069",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/e85c7629-7b40-4410-b182-bc7278ff4b24",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Deduplicate Comments",
              "description": null,
              "arguments": {
                "arguments": {
                  "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
              },
              "status": null,
              "top": "352",
              "left": "1820",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "dc27d705-e4fe-4ccd-b2d4-7ad3c5fb4079",
              "id": 429
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Results 1",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Splunk_query_for_illegitimate_DLL_load.data.sid}}\"}",
                  "additional_args": "{\"a\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "288",
              "left": "1246",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "9c9e2b9e-041d-4d08-bec1-3d1beba2e496",
              "id": 430
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Results 2",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Splunk_query_for_DLL_load_from_illegitimate_LSASS.data.sid}}\"}",
                  "additional_args": "{\"a\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "212",
              "left": "1247",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "ba71701d-eb8c-465b-add9-4af1aa45df3f",
              "id": 431
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Splunk hunt times",
              "description": null,
              "arguments": {
                "splunkHuntEnd": "{% if vars.input.records[0].huntEnd %}latest={{vars.input.records[0].huntEnd}}{% endif %}",
                "splunkHuntStart": "earliest={{vars.input.records[0].huntStart}}"
              },
              "status": null,
              "top": "170",
              "left": "580",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "e36fe8f7-eba6-4ce3-89a9-521cb2f3527e",
              "id": 432
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Results 3",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Splunk_query_for_illegitimate_LSASS.data.sid}}\"}",
                  "additional_args": "{\"a\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "132",
              "left": "1248",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "ddcffeb5-e23b-4371-9ae7-0191d9268b4f",
              "id": 433
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic query for illegitimate LSASS",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:\"1\" AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND image_path:*lsass.exe NOT image_path:C\\:\\\\Windows\\\\System32\\\\lsass.exe NOT image_path:C\\:\\\\Windows\\\\SysWOW64\\\\lsass.exe",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "420",
              "left": "973",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "fcc11cf0-c944-4110-85cf-d7216e37976f",
              "id": 434
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Elastic Alert 1",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_query_for_illegitimate_DLL_load.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query indicated LSASS.exe attempted to load a DLL from a non-standard directory on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-LSASS Driver-{{vars.item._source.event_data.ImageLoaded}} by LSASS",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "LSASS Driver-Illegitimate DLL Loaded",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "LSASS.exe attempted to execute a DLL file located in a nonstandard directory. This could be an attempt by an adversary in the network to execute their code to gain persistence or further access to the system. The DLL being loaded by LSASS.exe should be evaluated to determine its legitimacy.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "{{vars.item._source.event_data.ImageLoaded}}",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1177",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "580",
              "left": "1520",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "a44dcdd0-8c0a-4f0a-b619-218e6fd96d44",
              "id": 435
            },
            {
              "@type": "WorkflowStep",
              "name": "Which SIEM",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "step_iri": "/api/3/workflow_steps/903a41e7-55c5-4cbf-890f-c70666ff6193",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Elastic\" }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/e36fe8f7-eba6-4ce3-89a9-521cb2f3527e",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Splunk\" }}"
                  }
                ]
              },
              "status": null,
              "top": "320",
              "left": "288",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "0558f681-f15f-4788-a482-c006ffd07c77",
              "id": 436
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic query for illegitimate DLL load",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:\"7\" AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND (image_path:\"C:\\\\Windows\\\\System32\\\\lsass.exe\" OR image_path:\"C:\\\\Windows\\\\SysWOW64\\\\lsass.exe\") NOT event_data.ImageLoaded:C\\:\\\\Windows\\\\System32\\\\*  NOT event_data.ImageLoaded:C\\:\\\\Windows\\\\SysWOW64\\\\* NOT event_data.ImageLoaded:C\\:\\\\Program\\ Files\\\\* NOT event_data.ImageLoaded:C\\:\\\\Program\\ Files\\ \\(x86\\)\\\\*",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "580",
              "left": "973",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "da4ed206-8104-420f-aebc-669e468a45d1",
              "id": 437
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Elastic Alert 3",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_query_for_illegitimate_LSASS.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query indicated that a file named LSASS.exe was executed from a nonstandard directory on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-LSASS Driver-Lsass.exe loaded from {{vars.item._source.image_path | regex_search('[^\\*?\"<>|\\r\\n]+(?=lsass\\.exe)')}}",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "LSASS Driver-Illegitimate LSASS Executed",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "A process named LSASS.exe was invoked from a nonstandard directory. This may be an attempt by an adversary to execute their own code while masquerading as a legitimate process. The suspicious LSASS.exe executable should be investigated for indicators of malicious activity.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1177",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "420",
              "left": "1520",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "6b80fbb7-34f1-4ec3-b290-3ede90003dc1",
              "id": 438
            },
            {
              "@type": "WorkflowStep",
              "name": "Hunt for LSASS Driver",
              "description": null,
              "arguments": {
                "route": "9a7e6d9a-b3ca-4811-a01d-0eb145a70da8",
                "title": "T1547.008 - Hunt for LSASS Driver",
                "resources": [
                  "hunt"
                ],
                "inputVariables": [
                  {
                    "name": "siem",
                    "type": "picklists",
                    "label": "SIEM",
                    "title": "Picklist",
                    "usable": true,
                    "tooltip": "Choose your SIEM",
                    "dataType": "picklist",
                    "formType": "picklist",
                    "required": true,
                    "_expanded": true,
                    "mmdUpdate": true,
                    "collection": false,
                    "dataSource": {
                      "model": "picklists",
                      "query": {
                        "sort": [
                          {
                            "field": "orderIndex",
                            "direction": "ASC"
                          }
                        ],
                        "logic": "AND",
                        "filters": [
                          {
                            "field": "listName__name",
                            "value": "SIEMs",
                            "operator": "eq"
                          }
                        ]
                      },
                      "displayConditions": {
                        "876c1483-416b-4d2f-8138-15769ae16d5c": {
                          "conditions": null,
                          "visibility": "visible"
                        },
                        "bcebcab1-3f93-468a-9f3f-91e5c511a0b5": {
                          "conditions": null,
                          "visibility": "visible"
                        }
                      }
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "_nameTouched": true,
                    "defaultValue": {
                      "id": 280,
                      "@id": "/api/3/picklists/876c1483-416b-4d2f-8138-15769ae16d5c",
                      "icon": null,
                      "@type": "Picklist",
                      "color": null,
                      "display": "Elastic",
                      "listName": "/api/3/picklist_names/98830189-afff-40e6-bed1-94012551dc67",
                      "itemValue": "Elastic",
                      "orderIndex": 1
                    },
                    "displayTemplate": "{{ itemValue }}",
                    "lengthConstraint": false,
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "siem": "{{vars.request.data[\"siem\"]}}",
                      "sourceIP": "{{ vars.sourceIP }}",
                      "processID": "{{ vars.processID }}",
                      "sourcetool": "{{ vars.sourcetool }}",
                      "accountname": "{{ vars.accountname }}",
                      "commandline": "{{ vars.commandline }}",
                      "processGUID": "{{ vars.processGUID }}",
                      "processname": "{{ vars.processname }}",
                      "computername": "{{ vars.computername }}",
                      "destinationIP": "{{ vars.destinationIP }}",
                      "parentprocessGUID": "{{ vars.parentprocessGUID }}",
                      "parentprocessname": "{{ vars.parentprocessname }}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "hunt": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "320",
              "left": "13",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "e85c7629-7b40-4410-b182-bc7278ff4b24",
              "id": 439
            },
            {
              "@type": "WorkflowStep",
              "name": "Splunk query for illegitimate LSASS",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=sysmon EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} Image=\"*lsass.exe\" Image!=\"C:\\\\Windows\\\\System32\\\\lsass.exe\" Image!=\"C:\\\\Windows\\\\SysWOW64\\\\lsass.exe\"   | table  host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"A\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "132",
              "left": "960",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "19b300e6-98c2-4aa0-9d59-8631606b2d46",
              "id": 440
            },
            {
              "@type": "WorkflowStep",
              "name": "Splunk query for DLL load from illegitimate LSASS",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=sysmon EventCode=7 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} Image=\"*lsass.exe\" Image!=\"C:\\\\Windows\\\\System32\\\\*\" Image!=\"C:\\\\Windows\\\\SysWOW64\\\\*\" ImageLoaded!=\"C:\\\\Windows\\\\System32\\\\*\" ImageLoaded!=\"C:\\\\Windows\\\\SysWOW64\\\\*\" ImageLoaded!=\"C:\\\\Program Files\\\\*\" ImageLoaded!=\"C:\\\\Program Files (x86)\\\\*\"  | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine Image_File_Name UtcTime EventChannel ProcessGuid Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "213",
              "left": "960",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "00f251e5-2a52-484f-9ebb-526b1c7ae12f",
              "id": 441
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Elastic Alert 2",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_query_for_DLL_load_from_illegitimate_LSASS.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query indicated that a file named LSASS.exe was executed from a nonstandard directory and attempted to load a DLL from a non-standard directory on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-LSASS Driver-{{vars.item._source.event_data.Image}} loaded as illegitimate Lsass",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "LSASS Driver-DLL Loaded by Illegitimate LSASS",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "A process named LSASS.exe was invoked from a nonstandard directory and attempted to load a DLL file. This may be an attempt by an adversary to execute their own code while masquerading as a legitimate process. The suspicious LSASS.exe process and the DLL file it attempted to execute should be investigated.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "{{vars.item._source.event_data.ImageLoaded}}",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "",
                  "mitre_tech_id": "T1177",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "500",
              "left": "1520",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "7d998ab5-c013-4773-bccf-6cffb2a406af",
              "id": 442
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert 1",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Results_1.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query indicated LSASS.exe attempted to load a DLL from a non-standard directory on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-LSASS Driver-{{vars.item.ImageLoaded}} by LSASS",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "LSASS Driver-Illegitimate DLL Loaded",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.EventChannel}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "LSASS.exe attempted to execute a DLL file located in a nonstandard directory. This could be an attempt by an adversary in the network to execute their code to gain persistence or further access to the system. The DLL being loaded by LSASS.exe should be evaluated to determine its legitimacy.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "{{vars.item.ImageLoaded}}",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1177",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "288",
              "left": "1527",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "2c65f5a8-fea4-4af4-a736-5de56396be70",
              "id": 443
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic query for DLL load from illegitimate LSASS",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_type:sysmon AND event_id:\"7\" AND @timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND image_path.keyword:*lsass.exe NOT image_path.keyword:C\\:\\\\Windows\\\\*ystem32\\\\* NOT image_path.keyword:C\\:\\\\Windows\\\\SysWOW64\\\\* NOT event_data.ImageLoaded.keyword:C\\:\\\\Windows\\\\*ystem32\\\\* NOT event_data.ImageLoaded:.keywordC\\:\\\\Windows\\\\SysWOW64\\\\* NOT event_data.ImageLoaded.keyword:C\\:\\\\Program\\ Files\\\\* NOT event_data.ImageLoaded.keyword:C\\:\\\\Program\\ Files\\ \\(x86\\)\\\\*",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "500",
              "left": "973",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "ac3d8f59-2782-40f5-8c5e-66b458010395",
              "id": 444
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Elastic hunt times",
              "description": null,
              "arguments": {
                "elasticHuntEnd": "{% if vars.input.records[0].huntEnd %} {{ arrow.get(vars.input.records[0].huntEnd).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }} {% else %} now {% endif %}",
                "elasticHuntStart": "{{ arrow.get(vars.input.records[0].huntStart).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }}"
              },
              "status": null,
              "top": "500",
              "left": "580",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "903a41e7-55c5-4cbf-890f-c70666ff6193",
              "id": 445
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert 2",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Results_2.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query indicated that a file named LSASS.exe was executed from a nonstandard directory and attempted to load a DLL from a non-standard directory on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-LSASS Driver-{{vars.item.Image}} loaded by illegitimate Lsass",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "LSASS Driver-DLL Loaded by Illegitimate LSASS",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.EventChannel}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "A process named LSASS.exe was invoked from a nonstandard directory and attempted to load a DLL file. This may be an attempt by an adversary to execute their own code while masquerading as a legitimate process. The suspicious LSASS.exe process and the DLL file it attempted to execute should be investigated.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "{{vars.item.ImageLoaded}}",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1177",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "211",
              "left": "1528",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "89c5cb73-47a0-4b14-bdb7-1c64ed1376f5",
              "id": 446
            },
            {
              "@type": "WorkflowStep",
              "name": "Splunk query for illegitimate DLL load",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=sysmon EventCode=7 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} (Image=\"C:\\\\Windows\\\\System32\\\\lsass.exe\" OR Image=\"C:\\\\Windows\\\\SysWOW64\\\\lsass.exe\") ImageLoaded!=\"C:\\\\Windows\\\\System32\\\\*\" ImageLoaded!=\"C:\\\\Windows\\\\SysWOW64\\\\*\" ImageLoaded!=\"C:\\\\Program Files\\\\*\" ImageLoaded!=\"C:\\\\Program Files (x86)\\\\*\" | table  host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine Image_File_Name UtcTime EventChannel ProcessGuid Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "289",
              "left": "960",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "e1bda9d0-45ec-46e2-a189-86162169d55f",
              "id": 447
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert 3",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Results_3.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query indicated that a file named LSASS.exe was executed from a nonstandard directory on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-LSASS Driver-Lsass.exe loaded from {{vars.item.Image | regex_search('[^\\*?\"<>|\\r\\n]+(?=lsass\\.exe)')}}",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "LSASS Driver-Illegitimate LSASS Executed",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.EventChannel}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "A process named LSASS.exe was invoked from a nonstandard directory. This may be an attempt by an adversary to execute their own code while masquerading as a legitimate process. The suspicious LSASS.exe executable should be investigated for indicators of malicious activity.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1177",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "129",
              "left": "1528",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "fdd119d9-3aa2-4ce9-a8c6-2d1449e3f646",
              "id": 448
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> Copy  of Copy  of a",
              "targetStep": "/api/3/workflow_steps/da4ed206-8104-420f-aebc-669e468a45d1",
              "sourceStep": "/api/3/workflow_steps/903a41e7-55c5-4cbf-890f-c70666ff6193",
              "label": null,
              "isExecuted": false,
              "uuid": "3f79eb0c-6914-4f02-a811-8f55252da884"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Set Elastic hunt times",
              "targetStep": "/api/3/workflow_steps/903a41e7-55c5-4cbf-890f-c70666ff6193",
              "sourceStep": "/api/3/workflow_steps/0558f681-f15f-4788-a482-c006ffd07c77",
              "label": null,
              "isExecuted": false,
              "uuid": "fd80c3a3-4c38-4496-932f-667300802bb5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Splunk query for illegitimate DLL load",
              "targetStep": "/api/3/workflow_steps/e1bda9d0-45ec-46e2-a189-86162169d55f",
              "sourceStep": "/api/3/workflow_steps/e36fe8f7-eba6-4ce3-89a9-521cb2f3527e",
              "label": null,
              "isExecuted": false,
              "uuid": "c8d00b0d-9356-4a59-b8c8-1e66cdec9dd5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic query for illegitimate DLL load -> Copy  of Copy  of Create and Link Elastic Alert 3",
              "targetStep": "/api/3/workflow_steps/a44dcdd0-8c0a-4f0a-b619-218e6fd96d44",
              "sourceStep": "/api/3/workflow_steps/da4ed206-8104-420f-aebc-669e468a45d1",
              "label": null,
              "isExecuted": false,
              "uuid": "f696b511-3612-48b1-836d-d7299fe4cb10"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert 3 -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/dc27d705-e4fe-4ccd-b2d4-7ad3c5fb4079",
              "sourceStep": "/api/3/workflow_steps/fdd119d9-3aa2-4ce9-a8c6-2d1449e3f646",
              "label": null,
              "isExecuted": false,
              "uuid": "fb96dd4a-5e05-4e8a-b2a9-95c024051b05"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic query for DLL load from illegitimate LSASS -> Copy  of Create and Link Elastic Alert 3",
              "targetStep": "/api/3/workflow_steps/7d998ab5-c013-4773-bccf-6cffb2a406af",
              "sourceStep": "/api/3/workflow_steps/ac3d8f59-2782-40f5-8c5e-66b458010395",
              "label": null,
              "isExecuted": false,
              "uuid": "d2e06658-6cae-4bc7-9c47-2fd39dca02ad"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Results for Sysmon Regsvr32 DLL Load -> Copy  of Create Splunk Alert",
              "targetStep": "/api/3/workflow_steps/89c5cb73-47a0-4b14-bdb7-1c64ed1376f5",
              "sourceStep": "/api/3/workflow_steps/ba71701d-eb8c-465b-add9-4af1aa45df3f",
              "label": null,
              "isExecuted": false,
              "uuid": "cccb7f2d-da30-4592-a5ce-6036830941b5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Elastic Alert 3 -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/dc27d705-e4fe-4ccd-b2d4-7ad3c5fb4079",
              "sourceStep": "/api/3/workflow_steps/6b80fbb7-34f1-4ec3-b290-3ede90003dc1",
              "label": null,
              "isExecuted": false,
              "uuid": "63332d8e-ab4a-4696-b1d3-2eb782835e2d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create and Link Elastic Alert 3 -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/dc27d705-e4fe-4ccd-b2d4-7ad3c5fb4079",
              "sourceStep": "/api/3/workflow_steps/7d998ab5-c013-4773-bccf-6cffb2a406af",
              "label": null,
              "isExecuted": false,
              "uuid": "ec4f1e3f-39b7-40d3-aa39-6881637ed814"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Splunk query for Regsvr32 DLL Load -> Copy  of Get Results for Sysmon Regsvr32 Child",
              "targetStep": "/api/3/workflow_steps/ba71701d-eb8c-465b-add9-4af1aa45df3f",
              "sourceStep": "/api/3/workflow_steps/00f251e5-2a52-484f-9ebb-526b1c7ae12f",
              "label": null,
              "isExecuted": false,
              "uuid": "0f76cec9-482c-4703-88b4-c2331b2d8614"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Copy  of Create and Link Elastic Alert 3 -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/dc27d705-e4fe-4ccd-b2d4-7ad3c5fb4079",
              "sourceStep": "/api/3/workflow_steps/a44dcdd0-8c0a-4f0a-b619-218e6fd96d44",
              "label": null,
              "isExecuted": false,
              "uuid": "c3125702-4ec8-4269-8555-91c54d7d02c1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Hunt for LSASS Driver -> Which SIEM",
              "targetStep": "/api/3/workflow_steps/0558f681-f15f-4788-a482-c006ffd07c77",
              "sourceStep": "/api/3/workflow_steps/e85c7629-7b40-4410-b182-bc7278ff4b24",
              "label": null,
              "isExecuted": false,
              "uuid": "670c89df-6ae3-4cf5-9e78-1e58c6b0501f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert 2 -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/dc27d705-e4fe-4ccd-b2d4-7ad3c5fb4079",
              "sourceStep": "/api/3/workflow_steps/89c5cb73-47a0-4b14-bdb7-1c64ed1376f5",
              "label": null,
              "isExecuted": false,
              "uuid": "c7394757-34b8-4a91-9c08-071fb6fa3fb2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> a",
              "targetStep": "/api/3/workflow_steps/fcc11cf0-c944-4110-85cf-d7216e37976f",
              "sourceStep": "/api/3/workflow_steps/903a41e7-55c5-4cbf-890f-c70666ff6193",
              "label": null,
              "isExecuted": false,
              "uuid": "80f85ba2-90af-4955-9376-d672a86cff37"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Splunk query for illegitimate LSASS -> Copy  of Get Results 2",
              "targetStep": "/api/3/workflow_steps/ddcffeb5-e23b-4371-9ae7-0191d9268b4f",
              "sourceStep": "/api/3/workflow_steps/19b300e6-98c2-4aa0-9d59-8631606b2d46",
              "label": null,
              "isExecuted": false,
              "uuid": "747dcded-ee99-4549-bda2-7d10d570cfae"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/e36fe8f7-eba6-4ce3-89a9-521cb2f3527e",
              "sourceStep": "/api/3/workflow_steps/0558f681-f15f-4788-a482-c006ffd07c77",
              "label": null,
              "isExecuted": false,
              "uuid": "b5f4e5e1-0ff6-4407-9d55-d2c0bb9cd6b2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> Copy  of a",
              "targetStep": "/api/3/workflow_steps/ac3d8f59-2782-40f5-8c5e-66b458010395",
              "sourceStep": "/api/3/workflow_steps/903a41e7-55c5-4cbf-890f-c70666ff6193",
              "label": null,
              "isExecuted": false,
              "uuid": "546f3ca5-9a10-4151-b5a8-26df76078340"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Splunk query for Sysmon CMSTP -> Get Results for Sysmon CMSTP",
              "targetStep": "/api/3/workflow_steps/9c9e2b9e-041d-4d08-bec1-3d1beba2e496",
              "sourceStep": "/api/3/workflow_steps/e1bda9d0-45ec-46e2-a189-86162169d55f",
              "label": null,
              "isExecuted": false,
              "uuid": "161f8be6-9fb2-465f-9ce6-f7ef567eda61"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Results for Sysmon Regsvr32 Child -> Create Splunk Alert",
              "targetStep": "/api/3/workflow_steps/2c65f5a8-fea4-4af4-a736-5de56396be70",
              "sourceStep": "/api/3/workflow_steps/9c9e2b9e-041d-4d08-bec1-3d1beba2e496",
              "label": null,
              "isExecuted": false,
              "uuid": "1e87af61-e8d2-4895-bb75-fcc3d41cff41"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic query for illegitimate LSASS -> Copy 1 of Create and Link Alert 3",
              "targetStep": "/api/3/workflow_steps/6b80fbb7-34f1-4ec3-b290-3ede90003dc1",
              "sourceStep": "/api/3/workflow_steps/fcc11cf0-c944-4110-85cf-d7216e37976f",
              "label": null,
              "isExecuted": false,
              "uuid": "ba3a17d8-e829-4030-b0fb-e7ba3ce48b73"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Splunk query for illegitimate LSASS",
              "targetStep": "/api/3/workflow_steps/19b300e6-98c2-4aa0-9d59-8631606b2d46",
              "sourceStep": "/api/3/workflow_steps/e36fe8f7-eba6-4ce3-89a9-521cb2f3527e",
              "label": null,
              "isExecuted": false,
              "uuid": "1df7e4b2-ebab-465b-8b04-62d31a258c8c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Splunk query for DLL load from illegitimate LSASS",
              "targetStep": "/api/3/workflow_steps/00f251e5-2a52-484f-9ebb-526b1c7ae12f",
              "sourceStep": "/api/3/workflow_steps/e36fe8f7-eba6-4ce3-89a9-521cb2f3527e",
              "label": null,
              "isExecuted": false,
              "uuid": "333446aa-de89-46ab-a204-0e1eafe3c37f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Get Results 3 -> Copy  of Copy  of Create Splunk Alert",
              "targetStep": "/api/3/workflow_steps/fdd119d9-3aa2-4ce9-a8c6-2d1449e3f646",
              "sourceStep": "/api/3/workflow_steps/ddcffeb5-e23b-4371-9ae7-0191d9268b4f",
              "label": null,
              "isExecuted": false,
              "uuid": "6a336552-7842-4fd9-b7e5-b05b7958e2bd"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert 1 -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/dc27d705-e4fe-4ccd-b2d4-7ad3c5fb4079",
              "sourceStep": "/api/3/workflow_steps/2c65f5a8-fea4-4af4-a736-5de56396be70",
              "label": null,
              "isExecuted": false,
              "uuid": "aa35307b-e5a7-4c7c-a4d8-e0363aefb9ec"
            }
          ],
          "priority": null,
          "uuid": "583e8a71-535b-4566-a16e-026722755190",
          "recordTags": [],
          "id": 100,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214962,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215033,
          "owners": [],
          "isPrivate": false
        }
      ]
    },
    {
      "@type": "WorkflowCollection",
      "name": "13 - MITRE ATT&CK™ - System Services",
      "description": "Playbooks designed to hunt System Services  Techniques identified in the MITRE ATT&CK Framework",
      "visible": true,
      "image": null,
      "uuid": "f1534cea-3d7d-411a-901c-172bc33b45b6",
      "id": 26,
      "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "createDate": 1629214963,
      "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "modifyDate": 1629214963,
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "ASSETS - Service Execution (T1569.002)",
          "aliasName": null,
          "tag": "ATT&CK, Execution, Service_Execution",
          "description": "Identifies on-OS services on a host and pass information to the next playbook for enrichment.",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/f1534cea-3d7d-411a-901c-172bc33b45b6",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/5d1ad091-ec15-41ac-aec8-a64c9c37eb48",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Check Service",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_service_data.data['op_result']}}",
                  "condition": ""
                },
                "arguments": {
                  "md5": "{{vars.item.MD5}}",
                  "SIEM": "{{vars.siem_selected}}",
                  "name": "{{vars.item.Name}}",
                  "path": "{{vars.item.Path}}",
                  "assetIRI": "{{vars.input.records[0]['@id']}}",
                  "hostname": "{{vars.input.records[0].hostname}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/fa42ac5d-e29c-4654-94f7-40c3a10f3a46"
              },
              "status": null,
              "top": "291",
              "left": "1040",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "4a253b87-91fa-4a37-8f2c-4475f645a1e5",
              "id": 605
            },
            {
              "@type": "WorkflowStep",
              "name": "Get service data",
              "description": null,
              "arguments": {
                "name": "Microsoft WinRM",
                "config": "4e52b7d6-2b18-4d70-a231-8d17eac0fd12",
                "params": {
                  "url": "{{vars.input.records[0].ip}}",
                  "port": 5985,
                  "command": "$services = Get-WmiObject Win32_Service | Select-Object Name, Pathname | Where-Object Pathname -NotLike 'C:\\WINDOWS\\system32\\svchost.exe*' | Sort-Object Pathname -Unique\n$formatted_serv_list = @()\nforeach($service in $services){\n    $serv_path = $service.Pathname -replace \"`\"\", \"\"\n    $serv_path = $serv_path -match \".*\\.exe(?!\\S)\"\n    $serv_path = $Matches[0]\n    if($serv_path){\n        $non_os_service = Get-AuthenticodeSignature -FilePath $serv_path | Select-Object Path, IsOSBinary, Status | Where-Object IsOSBinary -NE \"True\"\n        }\n    else{}\n    if($non_os_service){\n    $hashed_serv = Get-FileHash -Algorithm MD5 -Path $non_os_service.Path\n    $formatted_serv = New-Object System.Object\n    $formatted_serv | Add-Member -MemberType NoteProperty -Name “Name” -Value $service.Name\n    $formatted_serv | Add-Member -MemberType NoteProperty -Name “Path” -Value $serv_path\n    $formatted_serv | Add-Member -MemberType NoteProperty -Name “MD5” -Value $hashed_serv.Hash\n    $formatted_serv | Add-Member -MemberType NoteProperty -Name “Status” -Value $non_os_service.Status\n    $formatted_serv_list += $formatted_serv\n    }\n    else{}\n}\n\n$formatted_serv_list = $formatted_serv_list | Sort-Object Path -Unique | sort-object Name | ConvertTo-Json\n$formatted_serv_list",
                  "protocol": "http"
                },
                "version": "1.0.2",
                "connector": "microsoft-winrm",
                "operation": "execute_ps_script",
                "operationTitle": "Run Inline Powershell Script",
                "step_variables": []
              },
              "status": null,
              "top": "291",
              "left": "711",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "5e7a7396-cec9-4cb4-a500-bf8a1aaf44df",
              "id": 606
            },
            {
              "@type": "WorkflowStep",
              "name": "Set SIEM",
              "description": null,
              "arguments": {
                "siem_selected": "{% if vars.input.params.siem.itemValue == \"Splunk\" %}splunk{% elif vars.input.params.siem.itemValue == \"Elastic\" %}elastic{% endif %}"
              },
              "status": null,
              "top": "291",
              "left": "389",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "a761388b-3aab-4c33-870b-28b405cd2362",
              "id": 607
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "347e7fe0-d6a5-40e5-a61f-fe98a063a3b4",
                "title": "T1569.002 - Hunt for Service Execution",
                "resources": [
                  "assets"
                ],
                "inputVariables": [
                  {
                    "name": "siem",
                    "type": "picklists",
                    "label": "SIEM",
                    "title": "Picklist",
                    "usable": true,
                    "tooltip": "Choose your SIEM",
                    "dataType": "picklist",
                    "formType": "picklist",
                    "required": false,
                    "_expanded": true,
                    "collection": false,
                    "dataSource": {
                      "model": "picklists",
                      "query": {
                        "sort": [
                          {
                            "field": "orderIndex",
                            "direction": "ASC"
                          }
                        ],
                        "logic": "AND",
                        "filters": [
                          {
                            "field": "listName__name",
                            "value": "SIEMs",
                            "operator": "eq"
                          }
                        ]
                      },
                      "displayConditions": {
                        "876c1483-416b-4d2f-8138-15769ae16d5c": {
                          "conditions": null,
                          "visibility": "visible"
                        },
                        "bcebcab1-3f93-468a-9f3f-91e5c511a0b5": {
                          "conditions": null,
                          "visibility": "visible"
                        }
                      }
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "_nameTouched": true,
                    "defaultValue": {
                      "id": 280,
                      "@id": "/api/3/picklists/876c1483-416b-4d2f-8138-15769ae16d5c",
                      "icon": null,
                      "@type": "Picklist",
                      "color": null,
                      "display": "Elastic",
                      "listName": "/api/3/picklist_names/98830189-afff-40e6-bed1-94012551dc67",
                      "itemValue": "Elastic",
                      "orderIndex": 1
                    },
                    "useModuleField": false,
                    "displayTemplate": "{{ itemValue }}",
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "siem": "{{vars.request.data[\"siem\"]}}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "assets": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "291",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "5d1ad091-ec15-41ac-aec8-a64c9c37eb48",
              "id": 608
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Set SIEM",
              "targetStep": "/api/3/workflow_steps/a761388b-3aab-4c33-870b-28b405cd2362",
              "sourceStep": "/api/3/workflow_steps/5d1ad091-ec15-41ac-aec8-a64c9c37eb48",
              "label": null,
              "isExecuted": false,
              "uuid": "bc49fbef-1cfa-4c0c-844d-34397cb68c3f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get service data -> Check Service",
              "targetStep": "/api/3/workflow_steps/4a253b87-91fa-4a37-8f2c-4475f645a1e5",
              "sourceStep": "/api/3/workflow_steps/5e7a7396-cec9-4cb4-a500-bf8a1aaf44df",
              "label": null,
              "isExecuted": false,
              "uuid": "39dc0a88-b480-49fc-912b-ce5cebbf4448"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Get service data",
              "targetStep": "/api/3/workflow_steps/5e7a7396-cec9-4cb4-a500-bf8a1aaf44df",
              "sourceStep": "/api/3/workflow_steps/a761388b-3aab-4c33-870b-28b405cd2362",
              "label": null,
              "isExecuted": false,
              "uuid": "50864692-847b-4975-b8f0-7afc8ef34cc7"
            }
          ],
          "priority": null,
          "uuid": "d403387f-68c7-4c3d-9c81-818cf3c8e1cb",
          "recordTags": [],
          "id": 114,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214963,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215045,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> ASSETS - Service Execution (Enrichment) (T1569.002)",
          "aliasName": null,
          "tag": "ATT&CK, Execution, Service_Execution",
          "description": "Enriches service data and query VirusTotal for reputation. Queries SIEM for all instances of any malicious hash observed.",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "md5",
            "name",
            "path",
            "hostname",
            "assetIRI",
            "SIEM"
          ],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/f1534cea-3d7d-411a-901c-172bc33b45b6",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/568da187-892a-4c58-907d-a184002cc8e3",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "buffer",
              "description": null,
              "arguments": {
                "params": [],
                "version": "2.2.0",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "230",
              "left": "688",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "c3b71a34-31c3-48ba-be6d-49a6b7fed913",
              "id": 620
            },
            {
              "@type": "WorkflowStep",
              "name": "Create unknown MD5 Indicator",
              "description": null,
              "arguments": {
                "resource": {
                  "tags": null,
                  "hunts": null,
                  "notes": null,
                  "value": "{{vars.input.params.md5}}",
                  "alerts": null,
                  "assets": null,
                  "emails": null,
                  "events": null,
                  "owners": null,
                  "persons": null,
                  "sources": "VirusTotal",
                  "comments": null,
                  "__replace": "true",
                  "campaigns": null,
                  "companies": null,
                  "evidences": null,
                  "incidents": null,
                  "recordTags": null,
                  "reputation": {
                    "id": 7814,
                    "@id": "/api/3/picklists/9a611980-1b5e-4ae9-8062-eb2c0c433cff",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#6a9169",
                    "display": "No Reputation Available",
                    "listName": "/api/3/picklist_names/e75ed3c3-9f23-4a43-832b-0daf236209ba",
                    "itemValue": "No Reputation Available",
                    "orderIndex": 4
                  },
                  "attachments": null,
                  "description": null,
                  "indicatorStatus": null,
                  "typeofindicator": {
                    "id": 4169,
                    "@id": "/api/3/picklists/0ca054f2-d923-4992-a4a7-c516e6df281e",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "FileHash-MD5",
                    "listName": "/api/3/picklist_names/50ee5bfa-e18f-49ba-8af9-dcca25b0f9c0",
                    "itemValue": "FileHash-MD5",
                    "orderIndex": 3
                  },
                  "vulnerabilities": null,
                  "correlationGraph": null
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/indicators",
                "tagsOperation": "OverwriteTags",
                "step_variables": []
              },
              "status": null,
              "top": "80",
              "left": "1940",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "e05ec3f0-6c10-475f-8baa-5d3f99e01027",
              "id": 609
            },
            {
              "@type": "WorkflowStep",
              "name": "Do nothing",
              "description": null,
              "arguments": {
                "params": [],
                "version": "2.2.0",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "700",
              "left": "992",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "97c004b0-205f-405d-8454-aa18cfeed757",
              "id": 610
            },
            {
              "@type": "WorkflowStep",
              "name": "Which SIEM",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "step_iri": "/api/3/workflow_steps/ef19e424-4bfc-489a-9188-196d5129797b",
                    "condition": "{{ vars.input.params.SIEM == \"splunk\" }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/cc7395af-59a3-41fc-b562-96671f7de695",
                    "condition": "{{ vars.input.params.SIEM == \"elastic\" }}"
                  }
                ]
              },
              "status": null,
              "top": "591",
              "left": "2550",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "333f0e5c-8f21-4b1a-a4bc-9767253dbd12",
              "id": 630
            },
            {
              "@type": "WorkflowStep",
              "name": "Update MD5 with malicious reputation",
              "description": null,
              "arguments": {
                "resource": {
                  "__link": {
                    "assets": "['{{vars.input.params.assetIRI}}']"
                  },
                  "sources": "VirusTotal",
                  "reputation": {
                    "id": 6433,
                    "@id": "/api/3/picklists/7074e547-7785-4979-be32-c6d0c863e4bd",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#c42323",
                    "display": "Malicious",
                    "listName": "/api/3/picklist_names/e75ed3c3-9f23-4a43-832b-0daf236209ba",
                    "itemValue": "Malicious",
                    "orderIndex": 1
                  },
                  "typeofindicator": {
                    "id": 4169,
                    "@id": "/api/3/picklists/0ca054f2-d923-4992-a4a7-c516e6df281e",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "FileHash-MD5",
                    "listName": "/api/3/picklist_names/50ee5bfa-e18f-49ba-8af9-dcca25b0f9c0",
                    "itemValue": "FileHash-MD5",
                    "orderIndex": 3
                  },
                  "virustotalReputation": "{{vars.steps.Check_MD5_Reputation.data.positives}}"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.indicatorIRI}}",
                "collectionType": "/api/3/indicators",
                "step_variables": []
              },
              "status": null,
              "top": "480",
              "left": "1940",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "0d2ac02b-460b-477c-b53e-d5370f817506",
              "id": 611
            },
            {
              "@type": "WorkflowStep",
              "name": "Update MD5 with unknown reputation",
              "description": null,
              "arguments": {
                "resource": {
                  "value": "{{vars.input.params.md5}}",
                  "sources": "VirusTotal",
                  "reputation": {
                    "id": 7814,
                    "@id": "/api/3/picklists/9a611980-1b5e-4ae9-8062-eb2c0c433cff",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#6a9169",
                    "display": "No Reputation Available",
                    "listName": "/api/3/picklist_names/e75ed3c3-9f23-4a43-832b-0daf236209ba",
                    "itemValue": "No Reputation Available",
                    "orderIndex": 4
                  },
                  "typeofindicator": {
                    "id": 4169,
                    "@id": "/api/3/picklists/0ca054f2-d923-4992-a4a7-c516e6df281e",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "FileHash-MD5",
                    "listName": "/api/3/picklist_names/50ee5bfa-e18f-49ba-8af9-dcca25b0f9c0",
                    "itemValue": "FileHash-MD5",
                    "orderIndex": 3
                  },
                  "virustotalReputation": "No Reputation Data Found"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.indicatorIRI}}",
                "collectionType": "/api/3/indicators",
                "step_variables": []
              },
              "status": null,
              "top": "160",
              "left": "1940",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "bb34b132-ddeb-4ca5-be1a-aa1e220108c7",
              "id": 612
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Indicator IRI",
              "description": null,
              "arguments": {
                "indicatorIRI": "{% if vars.steps.Check_if_MD5_is_already_an_indicator %}{{vars.steps.Check_if_MD5_is_already_an_indicator[0]['@id']}}{% endif %}"
              },
              "status": null,
              "top": "320",
              "left": "320",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "ff0681c9-27d7-4695-97f8-1b483b52b91e",
              "id": 613
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Alert",
              "description": null,
              "arguments": {
                "arguments": {
                  "MD5": "{{vars.input.params.md5}}",
                  "source": "Powershell",
                  "comment": "",
                  "service": "{{vars.input.params.name}}",
                  "assetIRI": "{{vars.input.params.assetIRI}}",
                  "filePath": "{{vars.input.params.path}}",
                  "hostName": "{{vars.input.params.hostname}}",
                  "sourceIP": "",
                  "userName": "",
                  "alertName": "ATT&CK-Service Execution-Malicious service {{vars.input.params.name}} running",
                  "epochTime": "",
                  "eventName": "",
                  "eventTime": "",
                  "processID": "",
                  "technique": "Service Execution",
                  "sourceTool": "Powershell",
                  "commandline": "",
                  "description": "A service whose executable poses a malicious reputation was discovered on the host. Additional linked alerts may be created if logs indicate this service has executed.",
                  "mitreTechId": "T1035",
                  "processGUID": "",
                  "processName": "{{vars.input.params.path | regex_search('[^\\\\\\/:*?\"<>|\\r\\n]+$') }}",
                  "sourceImage": "",
                  "targetImage": "",
                  "destinationIP": "",
                  "parentProcess": "",
                  "scheduledTask": "",
                  "parentProcessID": "",
                  "parentCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/5e4d1f4a-b109-40d3-9d36-4ff6de69b4ca"
              },
              "status": null,
              "top": "591",
              "left": "2260",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "d81b46cd-9154-4f4c-87e4-d16a12e377b6",
              "id": 614
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": {
                      "md5": "{{ vars.md5 }}",
                      "SIEM": "{{ vars.SIEM }}",
                      "name": "{{ vars.name }}",
                      "path": "{{ vars.path }}",
                      "assetIRI": "{{ vars.assetIRI }}",
                      "hostname": "{{ vars.hostname }}"
                    }
                  }
                }
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "568da187-892a-4c58-907d-a184002cc8e3",
              "id": 615
            },
            {
              "@type": "WorkflowStep",
              "name": "Create benign MD5 Indicator",
              "description": null,
              "arguments": {
                "resource": {
                  "tags": null,
                  "hunts": null,
                  "notes": null,
                  "value": "{{vars.input.params.md5}}",
                  "alerts": null,
                  "assets": null,
                  "emails": null,
                  "events": null,
                  "owners": null,
                  "persons": null,
                  "sources": "VirusTotal",
                  "comments": null,
                  "__replace": "true",
                  "campaigns": null,
                  "companies": null,
                  "evidences": null,
                  "incidents": null,
                  "recordTags": null,
                  "reputation": {
                    "id": 6432,
                    "@id": "/api/3/picklists/b19b42aa-aee4-47df-9cda-894537dacb2a",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#52c91a",
                    "display": "Good",
                    "listName": "/api/3/picklist_names/e75ed3c3-9f23-4a43-832b-0daf236209ba",
                    "itemValue": "Good",
                    "orderIndex": 0
                  },
                  "attachments": null,
                  "description": null,
                  "indicatorStatus": null,
                  "typeofindicator": {
                    "id": 4169,
                    "@id": "/api/3/picklists/0ca054f2-d923-4992-a4a7-c516e6df281e",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "FileHash-MD5",
                    "listName": "/api/3/picklist_names/50ee5bfa-e18f-49ba-8af9-dcca25b0f9c0",
                    "itemValue": "FileHash-MD5",
                    "orderIndex": 3
                  },
                  "vulnerabilities": null,
                  "correlationGraph": null
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/indicators",
                "tagsOperation": "OverwriteTags",
                "step_variables": []
              },
              "status": null,
              "top": "240",
              "left": "1940",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "05abf87d-049a-469b-8812-6ea14bf51c0c",
              "id": 616
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic Query for execution of service",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "event_id:1 AND event_data.Hashes:MD5={{vars.input.params.md5}}*",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "646",
              "left": "2840",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "cc7395af-59a3-41fc-b562-96671f7de695",
              "id": 617
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Elastic Alert for Service Execution",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_Query_for_execution_of_service.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query identified known malicious process {{vars.item._source.image_path.split(\"\\\\\")[-1] }} executing on host {{vars.item._source.beat.hostname}} at  {{vars.item._source.event_data.UtcTime}}. This process has also been observed as service {{vars.input.params.name}} on {{vars.input.params.hostname}}.",
                  "service": "",
                  "assetIRI": "{{vars.input.params.assetIRI}}",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-Service Execution-{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "epochTime": "{{ arrow.get(vars.item._source.event_data.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "Service Execution",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "Execution of a potentially malicious process was observed. This process has also been observed as a service. Attackers may utilize services to maintain persistence and execute malicious files at given intervals.",
                  "mitreTechId": "T1035",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1] }}",
                  "sourceImage": "",
                  "targetImage": "",
                  "destinationIP": "",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}"
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/5e4d1f4a-b109-40d3-9d36-4ff6de69b4ca"
              },
              "status": null,
              "top": "646",
              "left": "3414",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "e23de188-9e23-4886-9214-99002b0e0aaa",
              "id": 618
            },
            {
              "@type": "WorkflowStep",
              "name": "Was Indicator found",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Indicator found",
                    "step_iri": "/api/3/workflow_steps/e0f7c03c-1ff4-4b82-a332-0b566c033d05",
                    "condition": "{{ vars.steps.Check_if_MD5_is_already_an_indicator|  length > 0 }}"
                  },
                  {
                    "option": "Indicator was not found",
                    "step_iri": "/api/3/workflow_steps/c3b71a34-31c3-48ba-be6d-49a6b7fed913",
                    "condition": "{{ vars.steps.Check_if_MD5_is_already_an_indicator |  length == 0 }}"
                  }
                ]
              },
              "status": null,
              "top": "453",
              "left": "320",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "b9118ac3-7831-48eb-8985-b884319410d4",
              "id": 619
            },
            {
              "@type": "WorkflowStep",
              "name": "Create malicious MD5 Indicator and link to asset",
              "description": null,
              "arguments": {
                "resource": {
                  "tags": null,
                  "hunts": null,
                  "notes": null,
                  "value": "{{vars.input.params.md5}}",
                  "alerts": null,
                  "assets": "['{{vars.input.params.assetIRI}}']",
                  "emails": null,
                  "events": null,
                  "owners": null,
                  "persons": null,
                  "sources": "VirusTotal",
                  "comments": null,
                  "__replace": "true",
                  "campaigns": null,
                  "companies": null,
                  "evidences": null,
                  "incidents": null,
                  "recordTags": null,
                  "reputation": {
                    "id": 6433,
                    "@id": "/api/3/picklists/7074e547-7785-4979-be32-c6d0c863e4bd",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#c42323",
                    "display": "Malicious",
                    "listName": "/api/3/picklist_names/e75ed3c3-9f23-4a43-832b-0daf236209ba",
                    "itemValue": "Malicious",
                    "orderIndex": 1
                  },
                  "attachments": null,
                  "description": null,
                  "indicatorStatus": null,
                  "typeofindicator": {
                    "id": 4169,
                    "@id": "/api/3/picklists/0ca054f2-d923-4992-a4a7-c516e6df281e",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "FileHash-MD5",
                    "listName": "/api/3/picklist_names/50ee5bfa-e18f-49ba-8af9-dcca25b0f9c0",
                    "itemValue": "FileHash-MD5",
                    "orderIndex": 3
                  },
                  "vulnerabilities": null,
                  "correlationGraph": null
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/indicators",
                "tagsOperation": "OverwriteTags",
                "step_variables": {
                  "indicatorIRI": "{{vars.result['@id']}}"
                }
              },
              "status": null,
              "top": "400",
              "left": "1940",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "c470818e-e94d-421f-a837-6dee4b3e74fb",
              "id": 621
            },
            {
              "@type": "WorkflowStep",
              "name": "Check if MD5 is already an indicator",
              "description": null,
              "arguments": {
                "query": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "object",
                      "field": "typeofindicator",
                      "value": "/api/3/picklists/0ca054f2-d923-4992-a4a7-c516e6df281e",
                      "_value": {
                        "itemValue": "FileHash-MD5"
                      },
                      "operator": "eq"
                    },
                    {
                      "type": "primitive",
                      "field": "value",
                      "value": "{{vars.input.params.md5}}",
                      "operator": "eq"
                    }
                  ]
                },
                "module": "indicators?$limit=30",
                "step_variables": []
              },
              "status": null,
              "top": "200",
              "left": "320",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928770",
              "uuid": "700a3042-d04f-4422-85e6-c127c41ccced",
              "id": 622
            },
            {
              "@type": "WorkflowStep",
              "name": "Query for execution of service",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "9ab494b3-68d1-424f-9f76-0693bd787483",
                "params": {
                  "query": "index=sysmon EventCode=1 MD5={{vars.input.params.md5}} | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"A\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "520",
              "left": "2840",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "ef19e424-4bfc-489a-9188-196d5129797b",
              "id": 623
            },
            {
              "@type": "WorkflowStep",
              "name": "Update MD5 with benign reputation",
              "description": null,
              "arguments": {
                "resource": {
                  "sources": "VirusTotal",
                  "reputation": {
                    "id": 6432,
                    "@id": "/api/3/picklists/b19b42aa-aee4-47df-9cda-894537dacb2a",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#52c91a",
                    "display": "Good",
                    "listName": "/api/3/picklist_names/e75ed3c3-9f23-4a43-832b-0daf236209ba",
                    "itemValue": "Good",
                    "orderIndex": 0
                  },
                  "virustotalReputation": "{{vars.steps.Check_MD5_Reputation.data.positives}}"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.indicatorIRI}}",
                "collectionType": "/api/3/indicators",
                "step_variables": []
              },
              "status": null,
              "top": "326",
              "left": "1940",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "6a18e31a-0520-410c-bd71-3ec9d8ba29ca",
              "id": 624
            },
            {
              "@type": "WorkflowStep",
              "name": "Has indicator been submitted to VirusTotal before",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "step_iri": "/api/3/workflow_steps/1402684f-d204-47b8-b222-f66913dda60b",
                    "condition": "{{ vars.steps.Check_MD5_Reputation.data.response_code != 0 }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/e05ec3f0-6c10-475f-8baa-5d3f99e01027",
                    "condition": "{{ (vars.steps.Check_MD5_Reputation.data.response_code == 0) and  (vars.indicatorIRI == \"\") }}"
                  },
                  {
                    "option": "",
                    "step_iri": "/api/3/workflow_steps/bb34b132-ddeb-4ca5-be1a-aa1e220108c7",
                    "condition": "{{ (vars.steps.Check_MD5_Reputation.data.response_code == 0) and  (vars.indicatorIRI != \"\") }}"
                  }
                ]
              },
              "status": null,
              "top": "240",
              "left": "1272",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "a1a13701-88d6-4fcc-bdf7-2a5ba466fb43",
              "id": 625
            },
            {
              "@type": "WorkflowStep",
              "name": "Return query results",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "9ab494b3-68d1-424f-9f76-0693bd787483",
                "params": {
                  "sid": "{'value': '{{vars.steps.Query_for_execution_of_service.data.sid}}'}",
                  "additional_args": "{\"A\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "1",
                  "retries": "300",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "520",
              "left": "3111",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "9c0c2a0a-52e2-400f-8b7d-603c1b6ef303",
              "id": 626
            },
            {
              "@type": "WorkflowStep",
              "name": "Check MD5 Reputation",
              "description": null,
              "arguments": {
                "name": "VirusTotal",
                "config": "40bc830c-105c-4fb7-bf43-1abb91925144",
                "params": {
                  "file_hash": "{{vars.input.params.md5}}"
                },
                "version": "1.0.1",
                "connector": "virustotal",
                "operation": "file_reputation",
                "operationTitle": "Get File Reputation",
                "step_variables": []
              },
              "status": null,
              "top": "234",
              "left": "980",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "e1b69bec-5422-49fa-a1b8-38810ad42557",
              "id": 627
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Additional Analysis Task",
              "description": null,
              "arguments": {
                "resource": {
                  "name": "Service Identified With Unknown Reputation",
                  "type": {
                    "id": 5268,
                    "@id": "/api/3/picklists/826ad76d-e418-4928-9bc9-ea552ebcc5f9",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Incident Response",
                    "listName": "/api/3/picklist_names/b837e375-76af-4ba5-b6a1-bd1c3cd27292",
                    "itemValue": "Incident Response",
                    "orderIndex": 12
                  },
                  "dueBy": null,
                  "hunts": null,
                  "notes": null,
                  "alerts": null,
                  "assets": "['{{vars.input.params.assetIRI}}']",
                  "owners": null,
                  "status": null,
                  "persons": null,
                  "comments": null,
                  "priority": {
                    "id": 109,
                    "@id": "/api/3/picklists/539083a6-01f6-4ff9-a588-778cfdad4671",
                    "icon": null,
                    "@type": "Picklist",
                    "color": "#d1b524",
                    "display": "Medium",
                    "listName": "/api/3/picklist_names/bea9a490-50d1-4597-8ad9-24422e10676e",
                    "itemValue": "Medium",
                    "orderIndex": 3
                  },
                  "taskdata": null,
                  "tasktype": null,
                  "companies": null,
                  "incidents": null,
                  "startDate": null,
                  "workflowid": null,
                  "attachments": null,
                  "description": "<p>A&nbsp;Windows Service was identified with a hash whose reputation is unknown.&nbsp;</p>\n<p>Task Details:<br />Name:&nbsp;{{vars.input.params.name}}<br />Path:&nbsp;{{vars.input.params.path}}<br />MD5:&nbsp;{{vars.input.params.md5}}<br />Host:&nbsp;{{vars.input.params.hostname}}</p>\n<p>It is recommended that the file and hash associated with this service be investigated to determine whether the service is legitimate.</p>",
                  "approvalhost": null,
                  "actualMinutes": null,
                  "assignedOnDate": null,
                  "completedOnDate": null,
                  "vulnerabilities": null,
                  "assignedToPerson": null,
                  "systemAssignedQueue": null
                },
                "_showJson": false,
                "collection": "/api/3/tasks",
                "step_variables": []
              },
              "status": null,
              "top": "120",
              "left": "2230",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "abea7868-de8b-480c-abcb-44754815e8db",
              "id": 628
            },
            {
              "@type": "WorkflowStep",
              "name": "What is existing indicator reputation",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "step_iri": "/api/3/workflow_steps/97c004b0-205f-405d-8454-aa18cfeed757",
                    "condition": "{{ (vars.steps.Check_if_MD5_is_already_an_indicator[0].reputation.itemValue == \"Good\")  or (vars.steps.Check_if_MD5_is_already_an_indicator[0].reputation.itemValue == \"Neutral\") }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/d81b46cd-9154-4f4c-87e4-d16a12e377b6",
                    "condition": "{{ (vars.steps.Check_if_MD5_is_already_an_indicator[0].reputation.itemValue == \"Malicious\")  or (vars.steps.Check_if_MD5_is_already_an_indicator[0].reputation.itemValue == \"Suspicious\") }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/e1b69bec-5422-49fa-a1b8-38810ad42557",
                    "condition": "{{ true }}"
                  }
                ]
              },
              "status": null,
              "top": "606",
              "left": "660",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "e0f7c03c-1ff4-4b82-a332-0b566c033d05",
              "id": 629
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Alert for Service Execution",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Return_query_results.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query identified known malicious process {{vars.item.process_exec}} executing on host {{vars.item.host}} at {{vars.item.UtcTime}}. This process has also been observed as service {{vars.input.params.name}} on {{vars.input.params.hostname}}.",
                  "service": "",
                  "assetIRI": "{{vars.input.params.assetIRI}}",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-Service Execution-Malicious service {{vars.input.params.name}} executed",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "Service Execution",
                  "sourceTool": "{{vars.item.EventChannel}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "Execution of a potentially malicious process was observed. This process has also been observed as a service. Attackers may utilize services to maintain persistence and execute malicious files at given intervals.",
                  "mitreTechId": "T1035",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "sourceImage": "",
                  "targetImage": "",
                  "destinationIP": "null",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}"
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/5e4d1f4a-b109-40d3-9d36-4ff6de69b4ca"
              },
              "status": null,
              "top": "520",
              "left": "3410",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "e2b7ba71-4d7b-4de8-9e86-e06537ceb999",
              "id": 631
            },
            {
              "@type": "WorkflowStep",
              "name": "Is indicator malicious",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "step_iri": "/api/3/workflow_steps/6a18e31a-0520-410c-bd71-3ec9d8ba29ca",
                    "condition": "{{ (vars.steps.Check_MD5_Reputation.data.positives == 0) and (vars.indicatorIRI != \"\") }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/0d2ac02b-460b-477c-b53e-d5370f817506",
                    "condition": "{{ (vars.steps.Check_MD5_Reputation.data.positives > 0) and  (vars.indicatorIRI != \"\") }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/05abf87d-049a-469b-8812-6ea14bf51c0c",
                    "condition": "{{ (vars.steps.Check_MD5_Reputation.data.positives == 0) and (vars.indicatorIRI == \"\") }}"
                  },
                  {
                    "step_iri": "/api/3/workflow_steps/c470818e-e94d-421f-a837-6dee4b3e74fb",
                    "condition": "{{ (vars.steps.Check_MD5_Reputation.data.positives > 0) and  (vars.indicatorIRI == \"\") }}"
                  }
                ]
              },
              "status": null,
              "top": "329",
              "left": "1580",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "1402684f-d204-47b8-b222-f66913dda60b",
              "id": 632
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Has indicator been submitted to VirusTotal before -> Create unknown MD5 Indicator",
              "targetStep": "/api/3/workflow_steps/e05ec3f0-6c10-475f-8baa-5d3f99e01027",
              "sourceStep": "/api/3/workflow_steps/a1a13701-88d6-4fcc-bdf7-2a5ba466fb43",
              "label": null,
              "isExecuted": false,
              "uuid": "5ca283a7-0be8-401c-a6e6-5cc5389f5591"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Update MD5 with unknown reputation -> Create Additional Analysis Task",
              "targetStep": "/api/3/workflow_steps/abea7868-de8b-480c-abcb-44754815e8db",
              "sourceStep": "/api/3/workflow_steps/bb34b132-ddeb-4ca5-be1a-aa1e220108c7",
              "label": null,
              "isExecuted": false,
              "uuid": "a49392ae-f426-40bc-a884-aec1f6a9f68a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is indicator malicious -> Create malicious MD5 Indicator and link to asset",
              "targetStep": "/api/3/workflow_steps/c470818e-e94d-421f-a837-6dee4b3e74fb",
              "sourceStep": "/api/3/workflow_steps/1402684f-d204-47b8-b222-f66913dda60b",
              "label": "",
              "isExecuted": false,
              "uuid": "883eeb3f-bab7-47bc-be8a-5ec33b6763a7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic Query for execution of service -> Copy  of Create Alert for Service Execution",
              "targetStep": "/api/3/workflow_steps/e23de188-9e23-4886-9214-99002b0e0aaa",
              "sourceStep": "/api/3/workflow_steps/cc7395af-59a3-41fc-b562-96671f7de695",
              "label": null,
              "isExecuted": false,
              "uuid": "d92ee023-a1a7-421a-ae68-e5425d977177"
            },
            {
              "@type": "WorkflowRoute",
              "name": "What is existing indicator reputation -> Create Alert",
              "targetStep": "/api/3/workflow_steps/d81b46cd-9154-4f4c-87e4-d16a12e377b6",
              "sourceStep": "/api/3/workflow_steps/e0f7c03c-1ff4-4b82-a332-0b566c033d05",
              "label": null,
              "isExecuted": false,
              "uuid": "8b9eed0c-29a8-4ec3-a8ae-fdfc760bf74d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create unknown MD5 Indicator -> Create Additional Analysis Task",
              "targetStep": "/api/3/workflow_steps/abea7868-de8b-480c-abcb-44754815e8db",
              "sourceStep": "/api/3/workflow_steps/e05ec3f0-6c10-475f-8baa-5d3f99e01027",
              "label": null,
              "isExecuted": false,
              "uuid": "4b997fe3-4ee6-4163-b822-ae592d610a1d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create malicious MD5 Indicator and link to asset -> Create Alert",
              "targetStep": "/api/3/workflow_steps/d81b46cd-9154-4f4c-87e4-d16a12e377b6",
              "sourceStep": "/api/3/workflow_steps/c470818e-e94d-421f-a837-6dee4b3e74fb",
              "label": null,
              "isExecuted": false,
              "uuid": "7a8f8def-66f7-453c-b9b4-cf0dc16d4f23"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Check if MD5 is already an indicator",
              "targetStep": "/api/3/workflow_steps/700a3042-d04f-4422-85e6-c127c41ccced",
              "sourceStep": "/api/3/workflow_steps/568da187-892a-4c58-907d-a184002cc8e3",
              "label": null,
              "isExecuted": false,
              "uuid": "944d6583-bfa9-4582-aa0d-f9326bc22751"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Return query results -> Copy  of Create Alert",
              "targetStep": "/api/3/workflow_steps/e2b7ba71-4d7b-4de8-9e86-e06537ceb999",
              "sourceStep": "/api/3/workflow_steps/9c0c2a0a-52e2-400f-8b7d-603c1b6ef303",
              "label": null,
              "isExecuted": false,
              "uuid": "36ef236a-9904-47cc-8e7f-fae60694e2aa"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Has indicator been submitted to VirusTotal before -> Update MD5 with unknown reputation",
              "targetStep": "/api/3/workflow_steps/bb34b132-ddeb-4ca5-be1a-aa1e220108c7",
              "sourceStep": "/api/3/workflow_steps/a1a13701-88d6-4fcc-bdf7-2a5ba466fb43",
              "label": "",
              "isExecuted": false,
              "uuid": "96565fa8-b0e6-49fa-98ed-a20e197b009b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Was Indicator found -> Do Nothing2",
              "targetStep": "/api/3/workflow_steps/c3b71a34-31c3-48ba-be6d-49a6b7fed913",
              "sourceStep": "/api/3/workflow_steps/b9118ac3-7831-48eb-8985-b884319410d4",
              "label": "Indicator was not found",
              "isExecuted": false,
              "uuid": "b8257d98-aed1-4fb1-b28b-e7fe1f92b725"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Do Nothing2 -> Check MD5 Reputation",
              "targetStep": "/api/3/workflow_steps/e1b69bec-5422-49fa-a1b8-38810ad42557",
              "sourceStep": "/api/3/workflow_steps/c3b71a34-31c3-48ba-be6d-49a6b7fed913",
              "label": null,
              "isExecuted": false,
              "uuid": "d48b6811-e78d-45fc-a8d4-80064dd59ef6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Was Indicator found -> Is existing indicator malicious",
              "targetStep": "/api/3/workflow_steps/e0f7c03c-1ff4-4b82-a332-0b566c033d05",
              "sourceStep": "/api/3/workflow_steps/b9118ac3-7831-48eb-8985-b884319410d4",
              "label": "Indicator found",
              "isExecuted": false,
              "uuid": "892e57bd-35b1-421c-9c89-c190692b9c2f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Elastic Query for execution of service",
              "targetStep": "/api/3/workflow_steps/cc7395af-59a3-41fc-b562-96671f7de695",
              "sourceStep": "/api/3/workflow_steps/333f0e5c-8f21-4b1a-a4bc-9767253dbd12",
              "label": null,
              "isExecuted": false,
              "uuid": "f0c92f53-b1b3-498c-886e-8440f6e24dcf"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is indicator malicious -> Copy  of Update MD5 with malicious reputation",
              "targetStep": "/api/3/workflow_steps/6a18e31a-0520-410c-bd71-3ec9d8ba29ca",
              "sourceStep": "/api/3/workflow_steps/1402684f-d204-47b8-b222-f66913dda60b",
              "label": "",
              "isExecuted": false,
              "uuid": "55c4c9e8-0246-4e8b-ad1e-bec1f6111236"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is indicator malicious -> Update MD5 with malicious reputation",
              "targetStep": "/api/3/workflow_steps/0d2ac02b-460b-477c-b53e-d5370f817506",
              "sourceStep": "/api/3/workflow_steps/1402684f-d204-47b8-b222-f66913dda60b",
              "label": "",
              "isExecuted": false,
              "uuid": "391b9316-9284-4ee5-9054-a16f68d07b5b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Indicator IRI -> Was Indicator found",
              "targetStep": "/api/3/workflow_steps/b9118ac3-7831-48eb-8985-b884319410d4",
              "sourceStep": "/api/3/workflow_steps/ff0681c9-27d7-4695-97f8-1b483b52b91e",
              "label": null,
              "isExecuted": false,
              "uuid": "3cb738e3-390f-4db9-8a34-34b41f69d56e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Alert -> Which SIEM",
              "targetStep": "/api/3/workflow_steps/333f0e5c-8f21-4b1a-a4bc-9767253dbd12",
              "sourceStep": "/api/3/workflow_steps/d81b46cd-9154-4f4c-87e4-d16a12e377b6",
              "label": null,
              "isExecuted": false,
              "uuid": "32dc7153-d93f-4774-8749-ebf8d09da4a6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Has indicator been submitted to VirusTotal before -> Is indicator malicious",
              "targetStep": "/api/3/workflow_steps/1402684f-d204-47b8-b222-f66913dda60b",
              "sourceStep": "/api/3/workflow_steps/a1a13701-88d6-4fcc-bdf7-2a5ba466fb43",
              "label": null,
              "isExecuted": false,
              "uuid": "0ec16589-ccc8-41d9-9f1d-390737fe63b3"
            },
            {
              "@type": "WorkflowRoute",
              "name": "What is existing indicator reputation -> Do nothing",
              "targetStep": "/api/3/workflow_steps/97c004b0-205f-405d-8454-aa18cfeed757",
              "sourceStep": "/api/3/workflow_steps/e0f7c03c-1ff4-4b82-a332-0b566c033d05",
              "label": null,
              "isExecuted": false,
              "uuid": "9d1a1c7b-1bae-4ac1-8f50-a975e45ba2c2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Check if MD5 is already an indicator -> Set Indicator IRI",
              "targetStep": "/api/3/workflow_steps/ff0681c9-27d7-4695-97f8-1b483b52b91e",
              "sourceStep": "/api/3/workflow_steps/700a3042-d04f-4422-85e6-c127c41ccced",
              "label": null,
              "isExecuted": false,
              "uuid": "ce2dfe53-0e63-4f82-9078-ed47534b0c42"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Query for execution of service -> Return query results",
              "targetStep": "/api/3/workflow_steps/9c0c2a0a-52e2-400f-8b7d-603c1b6ef303",
              "sourceStep": "/api/3/workflow_steps/ef19e424-4bfc-489a-9188-196d5129797b",
              "label": null,
              "isExecuted": false,
              "uuid": "192c5444-628d-4cec-8847-a8b5d630c475"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Check MD5 Reputation -> Has indicator been submitted to VirusTotal before",
              "targetStep": "/api/3/workflow_steps/a1a13701-88d6-4fcc-bdf7-2a5ba466fb43",
              "sourceStep": "/api/3/workflow_steps/e1b69bec-5422-49fa-a1b8-38810ad42557",
              "label": null,
              "isExecuted": false,
              "uuid": "94904a7a-4ba6-4ca0-a13e-f9988a40019e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "What is existing indicator reputation -> Check MD5 Reputation",
              "targetStep": "/api/3/workflow_steps/e1b69bec-5422-49fa-a1b8-38810ad42557",
              "sourceStep": "/api/3/workflow_steps/e0f7c03c-1ff4-4b82-a332-0b566c033d05",
              "label": null,
              "isExecuted": false,
              "uuid": "ebe9cfb1-4c29-496a-983f-6fb0ed25d1fb"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Update MD5 with malicious reputation -> Create Alert",
              "targetStep": "/api/3/workflow_steps/d81b46cd-9154-4f4c-87e4-d16a12e377b6",
              "sourceStep": "/api/3/workflow_steps/0d2ac02b-460b-477c-b53e-d5370f817506",
              "label": null,
              "isExecuted": false,
              "uuid": "b1053cc8-0b66-46db-9fd2-9729ecd58856"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is indicator malicious -> Create benign MD5 Indicator",
              "targetStep": "/api/3/workflow_steps/05abf87d-049a-469b-8812-6ea14bf51c0c",
              "sourceStep": "/api/3/workflow_steps/1402684f-d204-47b8-b222-f66913dda60b",
              "label": "",
              "isExecuted": false,
              "uuid": "6f31fa7d-29ee-4034-9c40-167ce65402e0"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Which SIEM -> Query for execution of service",
              "targetStep": "/api/3/workflow_steps/ef19e424-4bfc-489a-9188-196d5129797b",
              "sourceStep": "/api/3/workflow_steps/333f0e5c-8f21-4b1a-a4bc-9767253dbd12",
              "label": "",
              "isExecuted": false,
              "uuid": "873785f6-4fdb-42a9-92b9-35ef915487e0"
            }
          ],
          "priority": null,
          "uuid": "fa42ac5d-e29c-4654-94f7-40c3a10f3a46",
          "recordTags": [],
          "id": 115,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214963,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215046,
          "owners": [],
          "isPrivate": false
        }
      ]
    },
    {
      "@type": "WorkflowCollection",
      "name": "13 - MITRE ATT&CK™ - Access Token Manipulation",
      "description": "Playbooks designed to hunt Access Token Manipulation Techniques identified in the MITRE ATT&CK Framework",
      "visible": true,
      "image": null,
      "uuid": "f48bbd38-2909-40b9-b865-ca8599d3cc55",
      "id": 28,
      "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "createDate": 1629214963,
      "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "modifyDate": 1629214963,
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "HUNTS - SID-History Injection (T1134.005)",
          "aliasName": null,
          "tag": "ATT&CK, SID-History_Injection, Privilege_Escalation",
          "description": "Hunts for SID-History injection via mimikatz and other tools. Also hunts for SID-History added to accounts (success and failure). Adding SID-History may allow for escalated privileges if SID filtering is not enabled.",
          "isActive": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "sourceIP",
            "destinationIP",
            "processname",
            "processID",
            "processGUID",
            "parentprocessname",
            "parentprocessGUID",
            "accountname",
            "computername",
            "commandline",
            "sourcetool"
          ],
          "synchronous": false,
          "lastModifyDate": 1629214961,
          "collection": "/api/3/workflow_collections/f48bbd38-2909-40b9-b865-ca8599d3cc55",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/a1126fb0-0b79-467a-8c4b-55602878fa5e",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Set Splunk hunt times",
              "description": null,
              "arguments": {
                "splunkHuntEnd": "{% if vars.input.records[0].huntEnd %}latest={{vars.input.records[0].huntEnd}}{% endif %}",
                "splunkHuntStart": "earliest={{vars.input.records[0].huntStart}}"
              },
              "status": null,
              "top": "60",
              "left": "600",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "1ff66351-2f33-4a2a-8875-51e993121353",
              "id": 703
            },
            {
              "@type": "WorkflowStep",
              "name": "Deduplicate Comments",
              "description": null,
              "arguments": {
                "arguments": {
                  "hunt_iri": "{{vars.input.records[0]['@id']}}"
                },
                "step_variables": [],
                "workflowReference": "/api/3/workflows/3fd311be-a1c6-41c7-99a3-8794b33d8f8a"
              },
              "status": null,
              "top": "205",
              "left": "1760",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "17c210c9-16ec-472f-8a23-a4b9bc5429d6",
              "id": 689
            },
            {
              "@type": "WorkflowStep",
              "name": "Splunk query for sid history addition",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=wineventlog (EventCode=4765 OR EventCode=4766) {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} | table host Account_Name Account_Domain ComputerName source _time",
                  "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.4.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "20",
              "left": "912",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "8cd2d9c4-cb51-428c-a20b-085e51981fe9",
              "id": 690
            },
            {
              "@type": "WorkflowStep",
              "name": "Select SIEM",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Elasticsearch",
                    "step_iri": "/api/3/workflow_steps/495cffd5-03d8-4eeb-9805-dd4b59cfef74",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Elastic\" }}"
                  },
                  {
                    "option": "Splunk",
                    "step_iri": "/api/3/workflow_steps/1ff66351-2f33-4a2a-8875-51e993121353",
                    "condition": "{{ vars.input.params.siem.itemValue == \"Splunk\" }}"
                  }
                ]
              },
              "status": null,
              "top": "191",
              "left": "280",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "8f5a1f80-b922-4169-80b2-15bb0f45e971",
              "id": 691
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Elastic hunt times",
              "description": null,
              "arguments": {
                "elasticHuntEnd": "{% if vars.input.records[0].huntEnd %} {{ arrow.get(vars.input.records[0].huntEnd).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }} {% else %} now {% endif %}",
                "elasticHuntStart": "{{ arrow.get(vars.input.records[0].huntStart).format('YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ') }}"
              },
              "status": null,
              "top": "330",
              "left": "600",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "495cffd5-03d8-4eeb-9805-dd4b59cfef74",
              "id": 692
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic query for sid history addition",
              "description": "{{data.hits.hits[0]._source.event_id}}",
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "wineventlog*",
                  "query": "@timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND (event_id:\"4765\" OR event_id: \"4766\")",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "260",
              "left": "913",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "7129deb6-80e1-42ec-b7f7-2780d4d1add6",
              "id": 693
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert1",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Results_1.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.EventChannel}}",
                  "comment": "SIEM query identified potential SID-History Injection (Mimikatz) originating from {{vars.item.process}} on {{vars.item.host}} at {{vars.item.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.User}}",
                  "alertName": "ATT&CK-SID-History Injection-{{vars.item.process}} attempted to inject a new SID into a user's permissions settings",
                  "epochTime": "{{ arrow.get(vars.item.UtcTime).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{vars.item.UtcTime}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "SID-History Injection (Mimikatz)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.vendor_product}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "An attempt to execute Mimikatz with command line arguments indicative of Mimikatz's AddSid module was observed. SID-History manipulation allows an adversary to escalate their privileges and impersonate privileged user groups. The host where this command was executed should be investigated. Additionally, the command line arguments associated with this alert should be analyzed to determine the intent of the attacker.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process_exec}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1178",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "100",
              "left": "1454",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "536b4e2f-b65d-404e-9e58-1353061bdddc",
              "id": 694
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Results 1",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Splunk_query_for_Sysmon_mimikatz_commands.data.sid}}\"}",
                  "additional_args": "{\"a\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "20",
                  "retries": "30",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "100",
              "left": "1180",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "94ada319-9a85-49c0-b78c-dd5ec3c7154b",
              "id": 695
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Results 2",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "sid": "{'value': \"{{vars.steps.Splunk_query_for_sid_history_addition.data.sid}}\"}",
                  "additional_args": "{\"a\":\"B\"}"
                },
                "version": "1.4.0",
                "do_until": {
                  "delay": "20",
                  "retries": "30",
                  "condition": "{{\"results\" in vars.result.data}}"
                },
                "connector": "splunk",
                "operation": "get_results",
                "operationTitle": "Get Results for a Search",
                "step_variables": []
              },
              "status": null,
              "top": "20",
              "left": "1180",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "dbf71b71-f931-4a46-b2bf-40da43337e9d",
              "id": 696
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Elastic Alert",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_query_for_sid_history_addition.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "",
                  "url": "",
                  "source": "{{ vars.item._source.source_name}}",
                  "comment": "SIEM query identified potential SID-History Injection via Active Directory originating from {{ vars.item._source.event_data.Account_Name[0] }}, targeting {{ vars.item._source.event_data.Account_Name[1] }} on {{ vars.item._source.computer_name}} at {{vars.item._source['@timestamp']}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "",
                  "hostName": "{{ vars.item._source.computer_name}}",
                  "sourceIP": "null",
                  "userName": "{{ vars.item._source.event_data.Account_Name[0] }}",
                  "alertName": "",
                  "epochTime": "{{arrow.get(vars.item._source['@timestamp']).timestamp}}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source['@timestamp']}}",
                  "processID": "",
                  "technique": "SID-History Injection (SID-History Added)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{ vars.item._source.source_name}}",
                  "commandline": "",
                  "description": "Windows Event Logs have detected an attempt to modify SID-History within Active Directory. SID-History manipulation allows an adversary to escalate their privileges and impersonate privileged user groups. The host where this log was generated should be investigated.",
                  "processGUID": "",
                  "processName": "",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{ vars.item._source.computer_name}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1178",
                  "parentProcess": "",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "260",
              "left": "1460",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "08fc8c29-de27-4429-8848-a50355c5f9e9",
              "id": 697
            },
            {
              "@type": "WorkflowStep",
              "name": "Hunt for SID History",
              "description": null,
              "arguments": {
                "route": "a75c88b7-4b0d-46ae-a9cd-999dc7bfad08",
                "title": "T1134.005 - Hunt for SID-History Injection",
                "resources": [
                  "hunt"
                ],
                "inputVariables": [
                  {
                    "name": "siem",
                    "type": "picklists",
                    "label": "SIEM",
                    "title": "Picklist",
                    "usable": true,
                    "_ignore": false,
                    "tooltip": "Choose your SIEM",
                    "dataType": "picklist",
                    "formType": "picklist",
                    "required": true,
                    "_expanded": true,
                    "collection": false,
                    "dataSource": {
                      "model": "picklists",
                      "query": {
                        "sort": [
                          {
                            "field": "orderIndex",
                            "direction": "ASC"
                          }
                        ],
                        "logic": "AND",
                        "filters": [
                          {
                            "field": "listName__name",
                            "value": "SIEMs",
                            "operator": "eq"
                          }
                        ]
                      },
                      "displayConditions": {
                        "876c1483-416b-4d2f-8138-15769ae16d5c": {
                          "conditions": null,
                          "visibility": "visible"
                        },
                        "bcebcab1-3f93-468a-9f3f-91e5c511a0b5": {
                          "conditions": null,
                          "visibility": "visible"
                        }
                      }
                    },
                    "searchable": false,
                    "templateUrl": "app/components/form/fields/typeahead.html",
                    "_nameTouched": true,
                    "defaultValue": {
                      "id": 280,
                      "@id": "/api/3/picklists/876c1483-416b-4d2f-8138-15769ae16d5c",
                      "icon": null,
                      "@type": "Picklist",
                      "color": null,
                      "display": "Elastic",
                      "listName": "/api/3/picklist_names/98830189-afff-40e6-bed1-94012551dc67",
                      "itemValue": "Elastic",
                      "orderIndex": 1
                    },
                    "useModuleField": false,
                    "displayTemplate": "{{ itemValue }}",
                    "allowedEncryption": false,
                    "allowedGridColumn": true,
                    "useRecordFieldDefault": false
                  }
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "siem": "{{vars.request.data[\"siem\"]}}",
                      "sourceIP": "{{ vars.sourceIP }}",
                      "processID": "{{ vars.processID }}",
                      "sourcetool": "{{ vars.sourcetool }}",
                      "accountname": "{{ vars.accountname }}",
                      "commandline": "{{ vars.commandline }}",
                      "processGUID": "{{ vars.processGUID }}",
                      "processname": "{{ vars.processname }}",
                      "computername": "{{ vars.computername }}",
                      "destinationIP": "{{ vars.destinationIP }}",
                      "parentprocessGUID": "{{ vars.parentprocessGUID }}",
                      "parentprocessname": "{{ vars.parentprocessname }}"
                    },
                    "records": "{{vars.input.records}}"
                  }
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "hunt": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "190",
              "left": "11",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "a1126fb0-0b79-467a-8c4b-55602878fa5e",
              "id": 698
            },
            {
              "@type": "WorkflowStep",
              "name": "Splunk query for Sysmon mimikatz commands",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "55bf97af-75c2-45ca-ae75-f4d27220cc52",
                "params": {
                  "query": "index=sysmon EventCode=1 {{vars.splunkHuntStart}} {{vars.splunkHuntEnd}} (CommandLine=\"*misc::addsid*\" OR CommandLine=\"*sid::*\") | table host Image MD5 ParentImage User CommandLine process_exec vendor_product TimeCreated ParentProcessId ProcessId ParentCommandLine ProcessGuid UtcTime EventChannel Computer",
                  "exec_mode": "",
                  "auto_cancel": "",
                  "latest_time": "",
                  "earliest_time": "",
                  "additional_search_args": "{\"a\":\"B\"}"
                },
                "version": "1.5.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "operationTitle": "Invoke Search",
                "step_variables": []
              },
              "status": null,
              "top": "100",
              "left": "910",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "5867f8d7-ae21-422d-9c94-0707ef894ab2",
              "id": 699
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Elastic Alert 2",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Elastic_query_for_Sysmon_mimikatz_commands.data.hits.hits}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item._source.event_data.Hashes.split(\"MD5=\")[1].split(',')[0]}}",
                  "url": "",
                  "source": "{{vars.item._source.source_name}}",
                  "comment": "SIEM query identified potential SID-History Injection (Mimikatz) originating from {{vars.item._source.image_path.split(\"\\\\\")[-1]}} on {{vars.item._source.beat.hostname}} at {{vars.item._source.event_data.UtcTime}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item._source.image_path}}",
                  "hostName": "{{vars.item._source.beat.hostname}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item._source.username}}",
                  "alertName": "ATT&CK-SID-History Injection-Mimikatz command line arguments observed",
                  "epochTime": "{{arrow.get(vars.item._source.event_data.UtcTime).timestamp}}",
                  "eventName": "",
                  "eventTime": "{{vars.item._source.event_data.UtcTime}}",
                  "processID": "{{vars.item._source.event_data.ProcessId}}",
                  "technique": "SID-History Injection (Mimikatz)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item._source.source_name}}",
                  "commandline": "{{vars.item._source.event_data.CommandLine}}",
                  "description": "An attempt to execute Mimikatz with command line arguments indicative of Mimikatz's AddSid module was observed. SID-History manipulation allows an adversary to escalate their privileges and impersonate privileged user groups. The host where this command was executed should be investigated. Additionally, the command line arguments associated with this alert should be analyzed to determine the intent of the attacker.",
                  "processGUID": "{{vars.item._source.event_data.ProcessGuid}}",
                  "processName": "{{vars.item._source.image_path.split(\"\\\\\")[-1]}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item._source.computer_name}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1178",
                  "parentProcess": "{{vars.item._source.parent_image_path}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item._source.event_data.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item._source.event_data.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "340",
              "left": "1460",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "ee515400-85e3-4856-961f-9d2ebba0ee92",
              "id": 700
            },
            {
              "@type": "WorkflowStep",
              "name": "Create and Link Alert2",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.steps.Get_Results_2.data.results}}",
                  "condition": ""
                },
                "arguments": {
                  "MD5": "{{vars.item.MD5}}",
                  "url": "",
                  "source": "{{vars.item.source}}",
                  "comment": "SIEM query identified potential SID-History Injection via Active Directory originating from {{vars.item.Account_Name[0]}}, targeting {{vars.item.Account_Name[1]}} on {{vars.item.host}} at {{arrow.get(vars.item._time).to('utc')}}.",
                  "huntIRI": "{{vars.input.records[0]['@id']}}",
                  "service": "",
                  "filePath": "{{vars.item.Image}}",
                  "hostName": "{{vars.item.host}}",
                  "sourceIP": "null",
                  "userName": "{{vars.item.Account_Name[0]}}",
                  "alertName": "ATT&CK-SID-History Injection-{{vars.item.Account_Name[1]}}'s SID was injected into {{vars.item.Account_Name[0]}}",
                  "epochTime": "{{ arrow.get(vars.item._time).timestamp }}",
                  "eventName": "",
                  "eventTime": "{{arrow.get(vars.item._time).to('utc')}}",
                  "processID": "{{vars.item.ProcessId}}",
                  "technique": "SID-History Injection (SID-History Added)",
                  "sourceData": "{{vars.item}}",
                  "sourceTool": "{{vars.item.source}}",
                  "commandline": "{{vars.item.CommandLine}}",
                  "description": "Windows Event Logs have detected an attempt to modify SID-History within Active Directory. SID-History manipulation allows an adversary to escalate their privileges and impersonate privileged user groups. The host where this log was generated should be investigated.",
                  "processGUID": "{{vars.item.ProcessGuid}}",
                  "processName": "{{vars.item.process}}",
                  "registryKey": "",
                  "sourceImage": "",
                  "targetImage": "",
                  "computerName": "{{vars.item.Computer}}",
                  "destinationIP": "null",
                  "mitre_tech_id": "T1178",
                  "parentProcess": "{{vars.item.ParentImage}}",
                  "scheduledTask": "",
                  "bitstransferid": "",
                  "parentProcessID": "{{vars.item.ParentProcessId}}",
                  "bytestransferred": "",
                  "registryKeyValue": "",
                  "parentCommandLine": "{{vars.item.ParentCommandLine}}",
                  "decodedCommandLine": ""
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/bf7d418b-7ff3-44c1-b473-90d0a03c4641"
              },
              "status": null,
              "top": "20",
              "left": "1453",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "b9d4800f-8e01-4ce0-8bed-6033560b7e1c",
              "id": 701
            },
            {
              "@type": "WorkflowStep",
              "name": "Elastic query for Sysmon mimikatz commands",
              "description": null,
              "arguments": {
                "name": "ElasticSearch",
                "config": "8d03a01d-1cef-40a8-992a-63d8de2b339f",
                "params": {
                  "index": "logstash-beats-*",
                  "query": "@timestamp:{ {{vars.elasticHuntStart}} TO {{vars.elasticHuntEnd}} } AND event_id:1 AND (event_data.CommandLine:\"*misc\\:\\:addsid*\" OR event_data.CommandLine:\"*sid\\:\\:*\")",
                  "run_as_user": ""
                },
                "version": "2.2.0",
                "connector": "elasticsearch",
                "operation": "execute_lucene_query",
                "operationTitle": "Execute Lucene Query",
                "step_variables": []
              },
              "status": null,
              "top": "340",
              "left": "912",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "4238e3a0-af5e-4558-b910-e09965905a17",
              "id": 702
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Get Results for Sysmon Regsvr32 DLL Load -> Copy  of Create Splunk Alert",
              "targetStep": "/api/3/workflow_steps/b9d4800f-8e01-4ce0-8bed-6033560b7e1c",
              "sourceStep": "/api/3/workflow_steps/dbf71b71-f931-4a46-b2bf-40da43337e9d",
              "label": null,
              "isExecuted": false,
              "uuid": "4f9576dd-b238-4efe-8577-c673142a9350"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Splunk query for Sysmon mimikatz commands",
              "targetStep": "/api/3/workflow_steps/5867f8d7-ae21-422d-9c94-0707ef894ab2",
              "sourceStep": "/api/3/workflow_steps/1ff66351-2f33-4a2a-8875-51e993121353",
              "label": null,
              "isExecuted": false,
              "uuid": "ba6ac878-f698-4b3b-92b6-b2a11ad217f4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> Elastic query for Sysmon mimikatz commands",
              "targetStep": "/api/3/workflow_steps/4238e3a0-af5e-4558-b910-e09965905a17",
              "sourceStep": "/api/3/workflow_steps/495cffd5-03d8-4eeb-9805-dd4b59cfef74",
              "label": null,
              "isExecuted": false,
              "uuid": "41388f6a-ed78-4267-a724-989d3c89d2bd"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Select SIEM -> Set Elastic hunt times",
              "targetStep": "/api/3/workflow_steps/495cffd5-03d8-4eeb-9805-dd4b59cfef74",
              "sourceStep": "/api/3/workflow_steps/8f5a1f80-b922-4169-80b2-15bb0f45e971",
              "label": "Elasticsearch",
              "isExecuted": false,
              "uuid": "8b09376c-2190-444a-a769-42a7f1759d8e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Elastic Alert -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/17c210c9-16ec-472f-8a23-a4b9bc5429d6",
              "sourceStep": "/api/3/workflow_steps/08fc8c29-de27-4429-8848-a50355c5f9e9",
              "label": null,
              "isExecuted": false,
              "uuid": "fd21b714-7ef4-4c9d-b19f-ae858387dda3"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic query for Sysmon mimikatz commands -> Copy  of Create and Link Alert1",
              "targetStep": "/api/3/workflow_steps/ee515400-85e3-4856-961f-9d2ebba0ee92",
              "sourceStep": "/api/3/workflow_steps/4238e3a0-af5e-4558-b910-e09965905a17",
              "label": null,
              "isExecuted": false,
              "uuid": "e76492d7-ae9d-42f2-86b9-1c861b27bdeb"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy  of Create and Link Alert1 -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/17c210c9-16ec-472f-8a23-a4b9bc5429d6",
              "sourceStep": "/api/3/workflow_steps/ee515400-85e3-4856-961f-9d2ebba0ee92",
              "label": null,
              "isExecuted": false,
              "uuid": "ca5493bb-db70-423a-b20a-dc12d5182446"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Elastic hunt times -> a",
              "targetStep": "/api/3/workflow_steps/7129deb6-80e1-42ec-b7f7-2780d4d1add6",
              "sourceStep": "/api/3/workflow_steps/495cffd5-03d8-4eeb-9805-dd4b59cfef74",
              "label": null,
              "isExecuted": false,
              "uuid": "93e0eb29-130f-4d48-b032-f56449346ea8"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Splunk query for Sysmon CMSTP -> Get Results for Sysmon CMSTP",
              "targetStep": "/api/3/workflow_steps/94ada319-9a85-49c0-b78c-dd5ec3c7154b",
              "sourceStep": "/api/3/workflow_steps/5867f8d7-ae21-422d-9c94-0707ef894ab2",
              "label": null,
              "isExecuted": false,
              "uuid": "3ac9231d-0e51-4198-8fc7-591f06785706"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert2 -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/17c210c9-16ec-472f-8a23-a4b9bc5429d6",
              "sourceStep": "/api/3/workflow_steps/b9d4800f-8e01-4ce0-8bed-6033560b7e1c",
              "label": null,
              "isExecuted": false,
              "uuid": "8726f259-aca4-4f54-86bf-4ac151ddf292"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Select SIEM -> Set Splunk hunt times",
              "targetStep": "/api/3/workflow_steps/1ff66351-2f33-4a2a-8875-51e993121353",
              "sourceStep": "/api/3/workflow_steps/8f5a1f80-b922-4169-80b2-15bb0f45e971",
              "label": "Splunk",
              "isExecuted": false,
              "uuid": "4cdfe107-076b-46bd-97d6-8016f9a9fdd4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Splunk query for Regsvr32 DLL Load -> Copy  of Get Results for Sysmon Regsvr32 Child",
              "targetStep": "/api/3/workflow_steps/dbf71b71-f931-4a46-b2bf-40da43337e9d",
              "sourceStep": "/api/3/workflow_steps/8cd2d9c4-cb51-428c-a20b-085e51981fe9",
              "label": null,
              "isExecuted": false,
              "uuid": "33347120-65d5-4344-8026-fef879518502"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create and Link Alert1 -> Deduplicate Comments",
              "targetStep": "/api/3/workflow_steps/17c210c9-16ec-472f-8a23-a4b9bc5429d6",
              "sourceStep": "/api/3/workflow_steps/536b4e2f-b65d-404e-9e58-1353061bdddc",
              "label": null,
              "isExecuted": false,
              "uuid": "ae5c83c8-21d1-4f89-aeca-0a77ef2dac78"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Results for Sysmon Regsvr32 Child -> Create Splunk Alert",
              "targetStep": "/api/3/workflow_steps/536b4e2f-b65d-404e-9e58-1353061bdddc",
              "sourceStep": "/api/3/workflow_steps/94ada319-9a85-49c0-b78c-dd5ec3c7154b",
              "label": null,
              "isExecuted": false,
              "uuid": "9c6cdbc8-3ee0-4456-b2b8-26dc1e3bef24"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Elastic query for sid history addition -> Copy 1 of Create and Link Alert3",
              "targetStep": "/api/3/workflow_steps/08fc8c29-de27-4429-8848-a50355c5f9e9",
              "sourceStep": "/api/3/workflow_steps/7129deb6-80e1-42ec-b7f7-2780d4d1add6",
              "label": null,
              "isExecuted": false,
              "uuid": "b5844571-5631-4c61-8eea-9a59fdeeed1f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Splunk hunt times -> Splunk query for sid history addition",
              "targetStep": "/api/3/workflow_steps/8cd2d9c4-cb51-428c-a20b-085e51981fe9",
              "sourceStep": "/api/3/workflow_steps/1ff66351-2f33-4a2a-8875-51e993121353",
              "label": null,
              "isExecuted": false,
              "uuid": "19debd23-32f0-467f-add0-eb4f7825f9d8"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Hunt for SID History -> Select SIEM",
              "targetStep": "/api/3/workflow_steps/8f5a1f80-b922-4169-80b2-15bb0f45e971",
              "sourceStep": "/api/3/workflow_steps/a1126fb0-0b79-467a-8c4b-55602878fa5e",
              "label": null,
              "isExecuted": false,
              "uuid": "9862f0b4-d082-4199-8898-414806e2b716"
            }
          ],
          "priority": null,
          "uuid": "dd57649d-15ed-4e75-a1b5-96789161fec4",
          "recordTags": [],
          "id": 120,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1629214963,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1629215004,
          "owners": [],
          "isPrivate": false
        }
      ]
    }
  ],
  "exported_tags": []
}